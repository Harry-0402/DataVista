export function generateWorkbookHTML(t,n,e,a){const o=(new Date).toLocaleString(),r=e.workbookName||"Workbook",i=`\n    <style>\n        :root {\n            --bs-body-bg: #ffffff;\n            --bs-body-color: #212529;\n            --bs-primary: #0d6efd;\n            --bs-border-color: #dee2e6;\n            --dv-header-bg: #f8f9fa;\n        }\n        [data-bs-theme="dark"] {\n            --bs-body-bg: #212529;\n            --bs-body-color: #f8f9fa;\n            --bs-border-color: #495057;\n            --dv-header-bg: #2c3034;\n        }\n        body { \n            font-family: 'Segoe UI', sans-serif; \n            margin: 0; padding: 0; \n            background-color: var(--bs-body-bg); color: var(--bs-body-color);\n            overflow-x: hidden; \n            width: 100vw;\n        }\n        \n        /* Dashboard Styles */\n        .dashboard-container { max-width: 1200px; margin: 50px auto; text-align: center; }\n        .dashboard-title { font-size: 2.5rem; font-weight: 300; margin-bottom: 10px; }\n        .dashboard-meta { color: gray; }\n        \n        .sheet-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px; }\n        .sheet-card {\n            background: var(--bs-body-bg);\n            border: 1px solid var(--bs-border-color);\n            border-radius: 8px;\n            padding: 30px;\n            cursor: pointer;\n            transition: transform 0.2s;\n            width: 280px;\n        }\n        .sheet-card:hover { transform: translateY(-5px); border-color: var(--bs-primary); }\n        .sheet-name { font-size: 1.2rem; font-weight: 500; margin-top: 15px; }\n\n        /* Sheet View Styles */\n        .view-section { display: none; padding-top: 0; }\n        .view-section.active { display: block; }\n\n        .sheet-header {\n            display: flex; align-items: center; justify-content: space-between;\n            background: var(--dv-header-bg); padding: 10px 20px;\n            border-bottom: 1px solid var(--bs-border-color); margin-bottom: 20px;\n        }\n        .btn-back { cursor: pointer; font-weight: 600; text-decoration: none; color: inherit; display: flex; align-items: center; gap: 5px; }\n\n        /* === VISUAL PRECISION & FIXED CONTROLS (v6.0) === */\n        .dv-table-wrapper { width: 100%; margin-bottom: 2rem; position: relative; }\n        .dv-controls-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 10px; }\n        \n        .btn-advanced-filters { background-color: #00bcd4 !important; color: white !important; border: none !important; font-weight: 600 !important; padding: 6px 16px !important; border-radius: 4px !important; transition: opacity 0.2s; }\n        .btn-advanced-filters:hover { opacity: 0.9; }\n\n        .dt-button { background-color: #6c757d !important; color: white !important; border: none !important; border-radius: 4px !important; padding: 5px 12px !important; font-size: 0.8rem !important; margin-right: 4px !important; }\n        .dt-button:hover { background-color: #5a6268 !important; }\n\n        .dataTables_scrollBody { border: 1px solid var(--bs-border-color); border-radius: 0 0 8px 8px; }\n        .dataTables_scrollHead { border: 1px solid var(--bs-border-color); border-bottom: none; border-radius: 8px 8px 0 0; background: var(--dv-header-bg); }\n\n        table.dataTable { width: 100% !important; margin: 0 !important; table-layout: auto !important; border-collapse: collapse !important; }\n        table.dataTable th, table.dataTable td { white-space: nowrap !important; vertical-align: middle; padding: 12px 15px !important; border: 1px solid var(--bs-border-color); min-width: 120px; }\n\n        .filter-input { width: 100%; border: 1px solid var(--bs-border-color); padding: 2px; font-size: 0.75rem; border-radius: 3px; }\n        .dataTables_paginate { display: flex; justify-content: flex-end; margin-top: 10px; font-size: 0.8rem; }\n    </style>\n    <style>${a.css||""}</style>\n    `,d=[];return d.push(`<!DOCTYPE html><html lang="en" data-bs-theme="light"><head><meta charset="UTF-8"><title>${r}</title>${i}</head><body>`),d.push(`\n    <div id="dashboard-view" class="view-section active">\n        <div class="dashboard-container">\n            <div class="dashboard-header">\n                <div style="font-size: 1.5rem; font-weight: bold; margin-bottom: 20px;">\n                    <img src="https://Harry-0402.github.io/DataVista/assets/icon-32.png" width="32" height="32" style="margin-right: 10px;">\n                    DataVista Report\n                </div>\n                <h1 class="dashboard-title">${r}</h1>\n                <p class="dashboard-meta">Generated on ${o} &bull; ${n.length} Sheets &bull; v7.0 (Precision Layout)</p>\n            </div>\n            <div class="sheet-grid">\n    `),n.forEach((t,n)=>{d.push(`\n        <div class="sheet-card" onclick="showSheet('${n}')">\n            <svg width="40" height="40" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>\n            <div class="sheet-name">${t}</div>\n        </div>\n        `)}),d.push("</div></div></div>"),n.forEach((n,e)=>{const a=t[n],o=a.length>0?a[0]:[],r=a.length>0?a.slice(1):[],i=o.length;let s=.9;i>6&&(s=Math.max(.5,.9-.05*(i-6)));const l=s.toFixed(2)+"rem";d.push(`\n        <div id="sheet-view-${e}" class="view-section">\n            <div class="sheet-header">\n                <a class="btn-back" onclick="showDashboard()">\n                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M10 19l-7-7m0 0l7-7m-7 7h18"/></svg>\n                    Back to Dashboard\n                </a>\n                <div style="font-weight: bold;">${n}</div>\n                <div onclick="document.documentElement.setAttribute('data-bs-theme', document.documentElement.getAttribute('data-bs-theme')==='dark'?'light':'dark')" style="cursor: pointer;">Theme</div>\n            </div>\n            <div class="container-fluid" style="padding: 0 20px;">\n                <div class="dv-table-wrapper">\n                    <table class="table table-striped table-hover display table-bordered" style="width:100% !important; font-size:${l};">\n                        <thead><tr>${o.map(t=>`<th>${t||""}</th>`).join("")}</tr></thead>\n                        <tbody>\n                            ${r.map(t=>`<tr>${t.map(t=>`<td>${t||""}</td>`).join("")}</tr>`).join("")}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n        `)}),d.push('\n    <div class="modal fade" id="searchBuilderModal" tabindex="-1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-body" id="sb-modal-body"></div></div></div></div>\n    '),d.push(`<script>${a.js||""}<\/script>`),d.push("<script>\n    function showDashboard() { $('.view-section').removeClass('active'); $('#dashboard-view').addClass('active'); }\n    function showSheet(index) { \n        $('.view-section').removeClass('active'); \n        $('#sheet-view-' + index).addClass('active'); \n        $.fn.dataTable.tables({ visible: true, api: true }).columns.adjust();\n    }\n\n    $(document).ready(function() {\n        $('table.display').each(function() {\n            var table = $(this);\n            table.DataTable({\n                dom: '<\"dv-controls-row\"Bf>t<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\n                autoWidth: false,\n                scrollX: true,\n                scrollCollapse: true,\n                pageLength: 20,\n                buttons: [\n                    {\n                        text: 'Advanced Filters',\n                        className: 'btn-advanced-filters',\n                        action: function (e, dt) {\n                            $('#sb-modal-body').empty();\n                            var sb = new $.fn.dataTable.SearchBuilder(dt, {});\n                            $('#sb-modal-body').append(sb.getNode());\n                            $('#searchBuilderModal').modal('show');\n                        }\n                    },\n                    'copy', 'csv', 'excel', 'pdf', 'print', 'colvis'\n                ],\n                initComplete: function() {\n                    var api = this.api();\n                    $(api.table().header()).find('th').each(function (colIdx) {\n                        var title = $(this).text();\n                        $(this).empty().append('<div style=\"margin-bottom:5px;font-weight:600;font-size:0.75rem;\">'+title+'</div>');\n                        $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" style=\"width:100%; border:1px solid #ddd; padding:2px; font-size:0.75rem;\" />')\n                            .appendTo(this)\n                            .on('keyup change', function (e) { \n                                e.stopPropagation();\n                                api.column(colIdx).search(this.value).draw(); \n                            });\n                    });\n                    setTimeout(function() { api.columns.adjust(); }, 100);\n                }\n            });\n        });\n    });\n    <\/script></body></html>"),new Blob([d.join("")],{type:"text/html"})}