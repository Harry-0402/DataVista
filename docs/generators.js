window.LIB_URLS={bootstrap_css:"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css",datatables_css:"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css",buttons_css:"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css",searchbuilder_css:"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css",dateTime_css:"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css",searchpanes_css:"https://cdn.datatables.net/searchpanes/2.2.0/css/searchPanes.bootstrap5.min.css",select_css:"https://cdn.datatables.net/select/1.7.0/css/select.bootstrap5.min.css",jquery:"https://code.jquery.com/jquery-3.7.0.min.js",bootstrap_js:"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js",datatables_js:"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js",datatables_bs5_js:"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js",jszip:"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js",pdfmake:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js",vfs_fonts:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js",buttons_js:"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js",buttons_bs5_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js",buttons_colvis_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js",buttons_html5_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js",buttons_print_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js",dateTime_js:"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js",searchbuilder_js:"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js",searchbuilder_bs5_js:"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js",searchpanes_js:"https://cdn.datatables.net/searchpanes/2.2.0/js/dataTables.searchPanes.min.js",searchpanes_bs5_js:"https://cdn.datatables.net/searchpanes/2.2.0/js/searchPanes.bootstrap5.min.js",select_js:"https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js"};export function generateHTML(t,n,a,e){const s=[];s.push("<!DOCTYPE html><html lang='en' data-bs-theme='light'>"),s.push("<head><meta charset='UTF-8'><title>DataVista Report</title>"),s.push(`<style>${e.css||""}</style>`),s.push('<style>\n        :root { --header-bg: #3c6ea9; --header-text: white; }\n        [data-bs-theme="dark"] { --header-bg: #1f2937; }\n\n        html { scroll-behavior: smooth; }\n        body { \n            background-color: var(--bs-body-bg); \n            color: var(--bs-body-color); \n            font-family: \'Segoe UI\', sans-serif; \n            overflow-x: hidden; /* Prevent body scroll */\n            width: 100vw;\n        }\n        \n        /* Header Container */\n        .dv-header {\n            background-color: var(--header-bg); color: var(--header-text);\n            padding: 12px 2rem; display: flex; justify-content: space-between; align-items: center;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 1.5rem; gap: 2rem;\n        }\n        [data-bs-theme="dark"] .dv-header { background-color: var(--header-bg-dark); }\n\n        .dv-brand { font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; gap: 8px; }\n        .dv-meta { font-size: 0.75rem; opacity: 0.7; margin-top: 2px; }\n        \n        /* Navigation */\n        .dv-header-tabs .nav-link { \n            border: none; color: rgba(255,255,255,0.7); background: transparent;\n            padding: 8px 16px; font-weight: 500; border-radius: 20px; transition: all 0.2s; font-size: 0.85rem;\n        }\n        .dv-header-tabs .nav-link.active { color: white; background: rgba(255,255,255,0.2); }\n        .theme-toggler { cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 0.8rem; border: 1px solid rgba(255,255,255,0.3); padding: 4px 10px; border-radius: 16px; }\n\n        .dv-container { padding: 0 20px 3rem 20px; max-width: 100vw; overflow-x: hidden; }\n\n        /* Card */\n        .dv-card { background: var(--bs-card-bg); border: 1px solid var(--bs-border-color); border-radius: 12px; padding: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.02); margin-bottom: 2rem; }\n\n        /* === PRECISION HEADER & FILTERS (v9.0) === */\n        .dv-table-wrapper { width: 100%; margin-bottom: 2rem; position: relative; }\n        \n        /* Header Styling */\n        table.dataTable thead tr:first-child th {\n            background: var(--bs-secondary-bg) !important;\n            padding: 12px 18px !important;\n            font-weight: 700 !important;\n            border-bottom: 2px solid var(--bs-border-color) !important;\n            vertical-align: middle !important;\n        }\n        \n        /* Filter Row Styling */\n        .filter-row th {\n            padding: 4px 10px !important;\n            background: var(--bs-body-bg) !important;\n            border-bottom: 1px solid var(--bs-border-color) !important;\n            line-height: 1 !important;\n        }\n        .filter-input {\n            width: 100%;\n            border: 1px solid var(--bs-border-color);\n            padding: 5px 10px;\n            font-size: 0.75rem;\n            border-radius: 6px;\n            outline: none;\n            transition: border-color 0.2s;\n        }\n        .filter-input:focus { border-color: #00bcd4; box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.1); }\n\n        /* SearchPanes Styling */\n        .dtsp-searchPanes { margin-bottom: 1.5rem; border: 1px solid var(--bs-border-color); border-radius: 8px; padding: 15px; background: var(--bs-body-bg); }\n        .dtsp-pane { border: none !important; }\n\n        /* Controls Row */\n        .dv-controls-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 12px; }\n        .dv-search-group { display: flex; align-items: center; gap: 15px; }\n        .dv-summary-stats { display: flex; gap: 10px; font-size: 0.85rem; color: var(--bs-secondary-color); border-right: 1px solid var(--bs-border-color); padding-right: 15px; }\n        .dv-stat-badge { background: var(--bs-secondary-bg); padding: 2px 8px; border-radius: 4px; font-weight: 600; color: var(--bs-primary); }\n\n        /* Navigator Bar Refinement */\n        .dv-header-tabs {\n            border-bottom: none !important;\n            justify-content: center;\n            gap: 5px;\n        }\n        .dv-header-tabs .nav-link {\n            border: none !important;\n            color: rgba(255,255,255,0.7) !important;\n            padding: 8px 20px !important;\n            border-radius: 20px !important;\n            font-weight: 500;\n            transition: all 0.3s;\n        }\n        .dv-header-tabs .nav-link:hover {\n            color: white !important;\n            background: rgba(255,255,255,0.1) !important;\n        }\n        .dv-header-tabs .nav-link.active {\n            color: white !important;\n            background: rgba(255,255,255,0.2) !important;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n\n        /* Unified Button Group Styling (v11.0) */\n        .dt-buttons {\n            display: inline-flex !important;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n            border-radius: 8px;\n            overflow: hidden;\n            border: 1px solid var(--bs-border-color);\n        }\n        .btn-advanced-filters, .dt-button {\n            margin: 0 !important;\n            border: none !important;\n            border-radius: 0 !important;\n            padding: 8px 18px !important;\n            font-size: 0.85rem !important;\n            height: 38px;\n            display: flex;\n            align-items: center;\n            font-weight: 500 !important;\n            transition: all 0.2s !important;\n        }\n        .btn-advanced-filters {\n            background-color: #00bcd4 !important;\n            color: white !important;\n            border-right: 1px solid rgba(0,0,0,0.1) !important;\n        }\n        .dt-button {\n            background-color: #6c757d !important;\n            color: white !important;\n            border-right: 1px solid rgba(255,255,255,0.1) !important;\n        }\n        .dt-button:last-child { border-right: none !important; }\n        .dt-button:hover { background-color: #5a6268 !important; transform: none !important; }\n        .btn-advanced-filters:hover { background-color: #00acc1 !important; transform: none !important; }\n\n        .dataTables_scrollBody { border: 1px solid var(--bs-border-color); border-radius: 0 0 8px 8px; }\n        .dataTables_scrollHead { border: 1px solid var(--bs-border-color); border-bottom: none; border-radius: 8px 8px 0 0; background: var(--bs-secondary-bg); }\n\n        table.dataTable { width: 100% !important; margin: 0 !important; table-layout: auto !important; border-collapse: collapse !important; }\n        table.dataTable th, table.dataTable td { \n            white-space: nowrap !important; \n            vertical-align: middle; \n            padding: 12px 18px !important; \n            font-size: inherit; \n            min-width: 120px; \n        }\n\n        /* RICH FORMATTING */\n        .dv-pos { color: #28a745 !important; font-weight: 600; }\n        .dv-neg { color: #dc3545 !important; font-weight: 600; }\n        .dv-bar-cell { position: relative; z-index: 1; }\n        .dv-bar { position: absolute; top: 2px; bottom: 2px; left: 0; background: rgba(0, 188, 212, 0.15); z-index: -1; }\n    </style>'),s.push("</head><body>");const r=(new Date).toLocaleString(),o=n.length>0?n[0]:"Report";if(s.push(`\n    <div class="dv-header">\n        <div>\n            <div class="dv-brand">\n                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>\n                DataVista <span style="opacity: 0.6; margin: 0 8px;">|</span> ${o}\n            </div>\n            <div class="dv-meta">Generated: ${r} &bull; v1.2.0 (Analytics Edition)</div>\n        </div>\n        <ul class="nav nav-tabs dv-header-tabs" role="tablist">\n            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#page-data">Data</a></li>\n            ${a.info?'<li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#page-info">Info</a></li>':""}\n            ${a.stats?'<li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#page-stats">Stats</a></li>':""}\n        </ul>\n        <div class="theme-toggler" onclick="document.documentElement.setAttribute('data-bs-theme', document.documentElement.getAttribute('data-bs-theme')==='dark'?'light':'dark')">\n            <span>Theme</span>\n        </div>\n    </div>\n    `),s.push('<div class="container-fluid dv-container">'),s.push('<div class="tab-content dv-tab-content">'),s.push('<div id="page-data" class="tab-pane fade show active">'),n.forEach((n,a)=>{const e=t[n],r=e.length>0,o=r?e[0]:[],d=r?e.slice(1).filter(t=>t.some(t=>null!=t&&""!==t.toString().trim())):[],i=o.length;let l=1;i>6&&(l=Math.max(.75,1-.04*(i-6)));const c=l.toFixed(2)+"rem";s.push('<div class="dv-sheet-section"><div class="dv-card">'),s.push('<div class="dv-table-wrapper">'),s.push(`<table class="table table-hover display table-bordered" style="width:100% !important; font-size:${c};">`),s.push("<thead>"),s.push("<tr>"),o.forEach(t=>s.push(`<th>${t}</th>`)),s.push("</tr>"),s.push('<tr class="filter-row">'),o.forEach(()=>s.push("<th></th>")),s.push("</tr>"),s.push("</thead><tbody>"),d.forEach(t=>{s.push("<tr>"),t.forEach(t=>{s.push(`<td>${t||""}</td>`)}),s.push("</tr>")}),s.push("</tbody></table></div></div></div>")}),s.push("</div>"),a.info||a.stats){const e=n[0],d=t[e]||[],i=d.length>0?d[0]:[],l=d.length>0?d.slice(1).filter(t=>t.some(t=>null!=t&&""!==t.toString().trim())):[],c=i.map((t,n)=>{const a=l.map(t=>{const a=t[n];if(null==a||""===a)return null;const e=parseFloat(a.toString().replace(/[^0-9.-]+/g,""));return isNaN(e)?null:e}).filter(t=>null!==t);if(0===a.length)return null;const e=a.reduce((t,n)=>t+n,0);return{label:t||`Column ${n+1}`,count:a.length,sum:e,avg:e/a.length,min:Math.min(...a),max:Math.max(...a)}}).filter(t=>null!==t);a.info&&s.push(`\n            <div id="page-info" class="tab-pane fade">\n                <div class="dv-card">\n                    <h5 class="mb-3">Dataset Metadata</h5>\n                    <div class="table-responsive">\n                        <table class="table table-bordered">\n                            <thead class="table-light"><tr><th>Property</th><th>Value</th></tr></thead>\n                            <tbody>\n                                <tr><td><strong>Source Sheet</strong></td><td>${o}</td></tr>\n                                <tr><td><strong>Total Rows</strong></td><td>${l.length}</td></tr>\n                                <tr><td><strong>Total Columns</strong></td><td>${i.length}</td></tr>\n                                <tr><td><strong>Numeric Columns</strong></td><td>${c.length}</td></tr>\n                                <tr><td><strong>Export Quality</strong></td><td><span class="badge bg-success">Verified</span></td></tr>\n                                <tr><td><strong>Engine Node</strong></td><td>DataVista v1.2.0</td></tr>\n                                <tr><td><strong>Export Date</strong></td><td>${r}</td></tr>\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>`),a.stats&&s.push(`\n            <div id="page-stats" class="tab-pane fade">\n                <div class="dv-card">\n                    <h5 class="mb-3">Summary Statistics</h5>\n                    <div class="table-responsive">\n                        <table class="table table-hover table-bordered">\n                            <thead class="table-light">\n                                <tr>\n                                    <th>Column</th>\n                                    <th>Count</th>\n                                    <th>Sum</th>\n                                    <th>Average</th>\n                                    <th>Min</th>\n                                    <th>Max</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${c.map(t=>`\n                                    <tr>\n                                        <td><strong>${t.label}</strong></td>\n                                        <td>${t.count}</td>\n                                        <td>${t.sum.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}</td>\n                                        <td>${t.avg.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}</td>\n                                        <td>${t.min.toLocaleString()}</td>\n                                        <td>${t.max.toLocaleString()}</td>\n                                    </tr>\n                                `).join("")}\n                                ${0===c.length?'<tr><td colspan="6" class="text-center text-muted">No numeric data found for calculation.</td></tr>':""}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>`)}return s.push("</div></div>"),s.push('\n    <div class="modal fade" id="searchBuilderModal" tabindex="-1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-body" id="sb-modal-body"></div></div></div></div>\n    '),s.push(`<script>${e.js||""}<\/script>`),s.push("<script>\n    $(document).ready(function() {\n        $('table.display').each(function() {\n            var table = $(this);\n            // Initialize DataTable with STRICT options\n            table.DataTable({\n                dom: 'P<\"dv-controls-row\"B<\"dv-search-group\"f>>t<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\n                orderCellsTop: true, // Use first row for sorting\n                searchPanes: {\n                    cascadePanes: true,\n                    viewTotal: true,\n                    layout: 'columns-3'\n                },\n                autoWidth: false,\n                scrollX: true,\n                scrollCollapse: true,\n                paging: true,\n                pageLength: 20,\n                rowCallback: function(row, data) {\n                    // v10.0: Numeric Conditional Coloring\n                    $('td', row).each(function() {\n                        var text = $(this).text().trim();\n                        var val = parseFloat(text.replace(/[^0-9.-]+/g, \"\"));\n                        if (!isNaN(val) && !text.includes('/') && !text.includes('-20') && text.length < 15) {\n                            if (val > 0) $(this).addClass('dv-pos');\n                            else if (val < 0) $(this).addClass('dv-neg');\n                        }\n                    });\n                },\n                buttons: [\n                    {\n                        text: 'Advanced Filters',\n                        className: 'btn-advanced-filters',\n                        action: function (e, dt) {\n                            $('#sb-modal-body').empty();\n                            var sb = new $.fn.dataTable.SearchBuilder(dt, {});\n                            $('#sb-modal-body').append(sb.getNode());\n                            $('#searchBuilderModal').modal('show');\n                        }\n                    },\n                    'copy', 'csv', 'excel', 'pdf', 'print', 'colvis'\n                ],\n                initComplete: function () {\n                    var api = this.api();\n                    \n                    // Add Row/Col Counts\n                    var rowCount = api.rows().count();\n                    var colCount = api.columns().count();\n                    var statsHtml = '<div class=\"dv-summary-stats\">' +\n                        '<span>Total Rows: <span class=\"dv-stat-badge\">' + rowCount + '</span></span>' +\n                        '<span>Total Columns: <span class=\"dv-stat-badge\">' + colCount + '</span></span>' +\n                        '</div>';\n                    $('.dv-search-group').prepend(statsHtml);\n\n                    // Inject filters into the SECOND header row\n                    $(api.table().header()).find('tr.filter-row th').each(function (colIdx) {\n                        $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" />')\n                            .appendTo(this)\n                            .on('keyup change', function (e) { \n                                e.stopPropagation();\n                                api.column(colIdx).search(this.value).draw(); \n                            });\n                    });\n                    \n                    setTimeout(function() { api.columns.adjust(); }, 150);\n                }\n            });\n        });\n    });\n    <\/script>"),s.push("</body></html>"),new Blob(s,{type:"text/html"})}