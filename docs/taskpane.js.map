{"version":3,"file":"taskpane.js","mappings":";gqBACA,IAAAA,EAAAC,EAAAC,EAAA,mBAAAC,OAAAA,OAAA,GAAAC,EAAAF,EAAAG,UAAA,aAAAC,EAAAJ,EAAAK,aAAA,yBAAAC,EAAAN,EAAAE,EAAAE,EAAAE,GAAA,IAAAC,EAAAL,GAAAA,EAAAM,qBAAAC,EAAAP,EAAAO,EAAAC,EAAAC,OAAAC,OAAAL,EAAAC,WAAA,OAAAK,EAAAH,EAAA,mBAAAV,EAAAE,EAAAE,GAAA,IAAAE,EAAAC,EAAAG,EAAAI,EAAA,EAAAC,EAAAX,GAAA,GAAAY,GAAA,EAAAC,EAAA,CAAAF,EAAA,EAAAb,EAAA,EAAAgB,EAAApB,EAAAqB,EAAAC,EAAAN,EAAAM,EAAAC,KAAAvB,EAAA,GAAAsB,EAAA,SAAArB,EAAAC,GAAA,OAAAM,EAAAP,EAAAQ,EAAA,EAAAG,EAAAZ,EAAAmB,EAAAf,EAAAF,EAAAmB,CAAA,YAAAC,EAAApB,EAAAE,GAAA,IAAAK,EAAAP,EAAAU,EAAAR,EAAAH,EAAA,GAAAiB,GAAAF,IAAAV,GAAAL,EAAAgB,EAAAO,OAAAvB,IAAA,KAAAK,EAAAE,EAAAS,EAAAhB,GAAAqB,EAAAH,EAAAF,EAAAQ,EAAAjB,EAAA,GAAAN,EAAA,GAAAI,EAAAmB,IAAArB,KAAAQ,EAAAJ,GAAAC,EAAAD,EAAA,OAAAC,EAAA,MAAAD,EAAA,GAAAA,EAAA,GAAAR,GAAAQ,EAAA,IAAAc,KAAAhB,EAAAJ,EAAA,GAAAoB,EAAAd,EAAA,KAAAC,EAAA,EAAAU,EAAAC,EAAAhB,EAAAe,EAAAf,EAAAI,EAAA,IAAAc,EAAAG,IAAAnB,EAAAJ,EAAA,GAAAM,EAAA,GAAAJ,GAAAA,EAAAqB,KAAAjB,EAAA,GAAAN,EAAAM,EAAA,GAAAJ,EAAAe,EAAAf,EAAAqB,EAAAhB,EAAA,OAAAH,GAAAJ,EAAA,SAAAmB,EAAA,MAAAH,GAAA,EAAAd,CAAA,iBAAAE,EAAAW,EAAAQ,GAAA,GAAAT,EAAA,QAAAU,UAAA,oCAAAR,GAAA,IAAAD,GAAAK,EAAAL,EAAAQ,GAAAhB,EAAAQ,EAAAL,EAAAa,GAAAxB,EAAAQ,EAAA,EAAAT,EAAAY,KAAAM,GAAA,CAAAV,IAAAC,EAAAA,EAAA,GAAAA,EAAA,IAAAU,EAAAf,GAAA,GAAAkB,EAAAb,EAAAG,IAAAO,EAAAf,EAAAQ,EAAAO,EAAAC,EAAAR,GAAA,OAAAI,EAAA,EAAAR,EAAA,IAAAC,IAAAH,EAAA,QAAAL,EAAAO,EAAAF,GAAA,MAAAL,EAAAA,EAAA0B,KAAAnB,EAAAI,IAAA,MAAAc,UAAA,wCAAAzB,EAAA2B,KAAA,OAAA3B,EAAAW,EAAAX,EAAA4B,MAAApB,EAAA,IAAAA,EAAA,YAAAA,IAAAR,EAAAO,EAAA,SAAAP,EAAA0B,KAAAnB,GAAAC,EAAA,IAAAG,EAAAc,UAAA,oCAAApB,EAAA,YAAAG,EAAA,GAAAD,EAAAR,CAAA,UAAAC,GAAAiB,EAAAC,EAAAf,EAAA,GAAAQ,EAAAV,EAAAyB,KAAAvB,EAAAe,MAAAE,EAAA,YAAApB,GAAAO,EAAAR,EAAAS,EAAA,EAAAG,EAAAX,CAAA,SAAAe,EAAA,UAAAa,MAAA5B,EAAA2B,KAAAV,EAAA,GAAAhB,EAAAI,EAAAE,IAAA,GAAAI,CAAA,KAAAS,EAAA,YAAAV,IAAA,UAAAmB,IAAA,UAAAC,IAAA,CAAA9B,EAAAY,OAAAmB,eAAA,IAAAvB,EAAA,GAAAL,GAAAH,EAAAA,EAAA,GAAAG,QAAAW,EAAAd,EAAA,GAAAG,EAAA,yBAAAH,GAAAW,EAAAmB,EAAArB,UAAAC,EAAAD,UAAAG,OAAAC,OAAAL,GAAA,SAAAO,EAAAhB,GAAA,OAAAa,OAAAoB,eAAApB,OAAAoB,eAAAjC,EAAA+B,IAAA/B,EAAAkC,UAAAH,EAAAhB,EAAAf,EAAAM,EAAA,sBAAAN,EAAAU,UAAAG,OAAAC,OAAAF,GAAAZ,CAAA,QAAA8B,EAAApB,UAAAqB,EAAAhB,EAAAH,EAAA,cAAAmB,GAAAhB,EAAAgB,EAAA,cAAAD,GAAAA,EAAAK,YAAA,oBAAApB,EAAAgB,EAAAzB,EAAA,qBAAAS,EAAAH,GAAAG,EAAAH,EAAAN,EAAA,aAAAS,EAAAH,EAAAR,EAAA,yBAAAW,EAAAH,EAAA,oDAAAwB,EAAA,kBAAAC,EAAA7B,EAAA8B,EAAAtB,EAAA,cAAAD,EAAAf,EAAAE,EAAAE,EAAAH,GAAA,IAAAO,EAAAK,OAAA0B,eAAA,IAAA/B,EAAA,gBAAAR,GAAAQ,EAAA,EAAAO,EAAA,SAAAf,EAAAE,EAAAE,EAAAH,GAAA,SAAAK,EAAAJ,EAAAE,GAAAW,EAAAf,EAAAE,EAAA,SAAAF,GAAA,YAAAwC,QAAAtC,EAAAE,EAAAJ,EAAA,GAAAE,EAAAM,EAAAA,EAAAR,EAAAE,EAAA,CAAA2B,MAAAzB,EAAAqC,YAAAxC,EAAAyC,cAAAzC,EAAA0C,UAAA1C,IAAAD,EAAAE,GAAAE,GAAAE,EAAA,UAAAA,EAAA,WAAAA,EAAA,cAAAS,EAAAf,EAAAE,EAAAE,EAAAH,EAAA,UAAA2C,EAAA1C,EAAAF,GAAA,IAAAC,EAAA,oBAAAE,QAAAD,EAAAC,OAAAE,WAAAH,EAAA,kBAAAD,EAAA,IAAA4C,MAAAC,QAAA5C,KAAAD,EAAA8C,EAAA7C,KAAAF,GAAAE,GAAA,iBAAAA,EAAAsB,OAAA,CAAAvB,IAAAC,EAAAD,GAAA,IAAA+C,EAAA,EAAAC,EAAA,oBAAAC,EAAAD,EAAA7C,EAAA,kBAAA4C,GAAA9C,EAAAsB,OAAA,CAAAI,MAAA,IAAAA,MAAA,EAAAC,MAAA3B,EAAA8C,KAAA,EAAAhD,EAAA,SAAAE,GAAA,MAAAA,CAAA,EAAAc,EAAAiC,EAAA,WAAAvB,UAAA,6IAAApB,EAAAe,GAAA,EAAAT,GAAA,SAAAsC,EAAA,WAAAjD,EAAAA,EAAA0B,KAAAzB,EAAA,EAAAE,EAAA,eAAAF,EAAAD,EAAAkD,OAAA,OAAA9B,EAAAnB,EAAA0B,KAAA1B,CAAA,EAAAF,EAAA,SAAAE,GAAAU,GAAA,EAAAN,EAAAJ,CAAA,EAAAc,EAAA,eAAAK,GAAA,MAAApB,EAAA,QAAAA,EAAA,oBAAAW,EAAA,MAAAN,CAAA,aAAAyC,EAAA7C,EAAAmB,GAAA,GAAAnB,EAAA,qBAAAA,EAAA,OAAAkD,EAAAlD,EAAAmB,GAAA,IAAApB,EAAA,GAAAoD,SAAA1B,KAAAzB,GAAAoD,MAAA,uBAAArD,GAAAC,EAAAqD,cAAAtD,EAAAC,EAAAqD,YAAAC,MAAA,QAAAvD,GAAA,QAAAA,EAAA4C,MAAAY,KAAAvD,GAAA,cAAAD,GAAA,2CAAAyD,KAAAzD,GAAAmD,EAAAlD,EAAAmB,QAAA,YAAA+B,EAAAlD,EAAAmB,IAAA,MAAAA,GAAAA,EAAAnB,EAAAsB,UAAAH,EAAAnB,EAAAsB,QAAA,QAAAxB,EAAA,EAAAI,EAAAyC,MAAAxB,GAAArB,EAAAqB,EAAArB,IAAAI,EAAAJ,GAAAE,EAAAF,GAAA,OAAAI,CAAA,UAAAuD,EAAAvD,EAAAH,EAAAD,EAAAE,EAAAI,EAAAe,EAAAZ,GAAA,QAAAD,EAAAJ,EAAAiB,GAAAZ,GAAAG,EAAAJ,EAAAqB,KAAA,OAAAzB,GAAA,YAAAJ,EAAAI,EAAA,CAAAI,EAAAoB,KAAA3B,EAAAW,GAAAgD,QAAAC,QAAAjD,GAAAkD,KAAA5D,EAAAI,EAAA,UAAAyD,EAAA3D,GAAA,sBAAAH,EAAA,KAAAD,EAAAgE,UAAA,WAAAJ,QAAA,SAAA1D,EAAAI,GAAA,IAAAe,EAAAjB,EAAA6D,MAAAhE,EAAAD,GAAA,SAAAkE,EAAA9D,GAAAuD,EAAAtC,EAAAnB,EAAAI,EAAA4D,EAAAC,EAAA,OAAA/D,EAAA,UAAA+D,EAAA/D,GAAAuD,EAAAtC,EAAAnB,EAAAI,EAAA4D,EAAAC,EAAA,QAAA/D,EAAA,CAAA8D,OAAA,MA2BG,SAEYE,IAAW,OAAAC,EAAAJ,MAAC,KAADD,UAAA,UAAAK,IA+FzB,OA/FyBA,EAAAN,EAAA3B,IAAAE,EAA1B,SAAAgC,IAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAzD,EAAA0D,EAAA,OAAA3C,IAAAC,EAAA,SAAA2C,GAAA,cAAAA,EAAA/D,EAAA+D,EAAA5E,GAAA,OAemC,OAfnC4E,EAAA/D,EAAA,EAEQgE,EAAa,wBAAyB,aAEhCV,EAASW,SAASC,cAAc,gCAAgCtD,MAChE2C,EAAU,CACZY,MAAOF,SAASG,eAAe,aAAaC,QAC5CC,KAAML,SAASG,eAAe,YAAYC,QAC1CE,KAAMN,SAASG,eAAe,YAAYC,QAC1CG,KAAMP,SAASG,eAAe,kBAAkBC,SAErCJ,SAASC,cAAc,gCAAgCtD,MAElE4C,EAAO,CAAC,EACRC,EAAa,GACbC,EAAe,SAAQK,EAAA5E,EAAA,EAErBsF,MAAMC,IAAG,eAAAC,EAAA7B,EAAA3B,IAAAE,EAAC,SAAAuD,EAAOC,GAAO,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAjE,IAAAC,EAAA,SAAAiE,GAAA,cAAAA,EAAAlG,GAAA,OAGJ,OADhB2F,EAAWD,EAAQC,UAChBQ,KAAK,QAAQD,EAAAlG,EAAA,EAChB0F,EAAQU,OAAM,OACqB,GAAzC7B,EAAeoB,EAASvC,MAAQ,SAEjB,cAAXe,EAAsB,CAAA+B,EAAAlG,EAAA,QAED,OADf4F,EAAQF,EAAQC,SAASU,oBACzBF,KAAK,UAAUD,EAAAlG,EAAA,EACf0F,EAAQU,OAAM,UAGfR,EAAMU,QAAkC,IAAxBV,EAAMU,OAAOlF,OAAY,CAAA8E,EAAAlG,EAAA,cAAQ,IAAIuG,MAAM,sBAAqB,OAErFlC,EAAgB,UAAIuB,EAAMU,OAC1BhC,EAAWkC,KAAK,aAAaN,EAAAlG,EAAA,eAGH,OADpB6F,EAASH,EAAQC,SAASc,YACzBN,KAAK,cAAcD,EAAAlG,EAAA,EACpB0F,EAAQU,OAAM,OASpB,OANMN,EAAcD,EAAOa,MAAMC,IAAI,SAAAC,GACjC,IAAMC,EAAMD,EAAME,2BAElB,OADAD,EAAIV,KAAK,oBACF,CAAE/C,KAAMwD,EAAMxD,KAAMyD,IAAKA,EACpC,GAEAX,EAAAlG,EAAA,EACM0F,EAAQU,OAAM,OAEpBL,EAAAvD,EACiBsD,GAAW,IAA5B,IAAAC,EAAAjD,MAAAkD,EAAAD,EAAA/F,KAAAwB,QAASyE,EAAID,EAAAvE,OACCoF,IAAIE,cAAgBd,EAAKY,IAAIG,SAAW,IAC9C3C,EAAK4B,EAAK7C,MAAQ6C,EAAKY,IAAIP,OAC3BhC,EAAWkC,KAAKP,EAAK7C,MAE5B,OAAA6D,GAAAlB,EAAAnG,EAAAqH,EAAA,SAAAlB,EAAAnF,GAAA,eAAAsF,EAAAjF,EAAA,KAAAwE,EAAA,IAER,gBAAAyB,GAAA,OAAA1B,EAAA3B,MAAA,KAAAD,UAAA,EAxCc,IAwCb,UAEwB,IAAtBU,EAAWlD,OAAY,CAAAwD,EAAA5E,EAAA,cAAQ,IAAIuG,MAAM,4BAA2B,OAMK,OAH7EnC,EAAQG,aAAeA,EAGvBM,EAAa,+CAAgD,gBAAgBD,EAAA5E,EAAA,EAE1DmH,IAAkB,OAA/B3C,EAAII,EAAA5D,EAEV6D,EAAa,uBAAwB,gBAKjCJ,EAFW,aAAXN,EAEOiD,qBAAqB/C,EAAMC,EAAYF,EAASI,GAGhD6C,aAAahD,EAAMC,EAAYF,EAASI,GAG7CE,EAAM4C,IAAIC,gBAAgB9C,IAE1BxD,EAAI6D,SAAS0C,cAAc,MAC/BC,KAAO/C,EACTzD,EAAEyG,SAAW,oBAAHC,QAAuB,IAAIC,MAAOC,UAAS,SACrD/C,SAASgD,KAAKC,YAAY9G,GAC1BA,EAAE+G,QACFlD,SAASgD,KAAKG,YAAYhH,GAE1B4D,EAAa,yBAA0B,gBAAgBD,EAAA5E,EAAA,eAAA4E,EAAA/D,EAAA,EAAA8D,EAAAC,EAAA5D,EAGvDkH,QAAQC,MAAKxD,GACbE,EAAa,UAAYF,EAAMyD,QAAS,eAAe,cAAAxD,EAAA3D,EAAA,KAAAiD,EAAA,iBAE9DD,EAAAJ,MAAA,KAAAD,UAAA,UAEcuD,IAAgB,OAAAkB,EAAAxE,MAAC,KAADD,UAAA,UAAAyE,IAmC9B,OAnC8BA,EAAA1E,EAAA3B,IAAAE,EAA/B,SAAAoG,IAAA,IAAAC,EAAApC,EAAAqC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAA7G,IAAAC,EAAA,SAAA6G,GAAA,cAAAA,EAAA9I,GAAA,OAwBK,OAtBKuI,EAAOQ,OAAOC,SAGd7C,EAAI,eAAA8C,EAAAtF,EAAA3B,IAAAE,EAAG,SAAAgH,EAAOxE,GAAG,IAAA5E,EAAA,OAAAkC,IAAAC,EAAA,SAAAkH,GAAA,cAAAA,EAAAtI,EAAAsI,EAAAnJ,GAAA,cAAAmJ,EAAAtI,EAAA,EAAAsI,EAAAnJ,EAAA,EAECoJ,MAAM1E,GAAI,OAAnB,IAAD5E,EAACqJ,EAAAnI,GACAqI,GAAI,CAAFF,EAAAnJ,EAAA,cAAQ,IAAIuG,MAAM7B,GAAI,cAAAyE,EAAAnJ,EAAA,EAClBF,EAAEwJ,OAAM,cAAAH,EAAAlI,EAAA,EAAAkI,EAAAnI,GAAA,OAEsB,OAFtBmI,EAAAtI,EAAA,EAAAsI,EAAAnI,EAErBkH,QAAQqB,KAAK,uBAAyB7E,GAAKyE,EAAAlI,EAAA,gBAAA0G,OACtBjD,EAAG,UAAAwE,EAAA,iBAE/B,gBATSM,GAAA,OAAAP,EAAApF,MAAA,KAAAD,UAAA,KAaJ4E,EAAU,CAAC,gBAAiB,iBAAkB,cAAe,oBAAqB,gBAClFC,EAAS,CACX,SAAU,eAAgB,gBAAiB,oBAC3C,QAAS,UAAW,YACpB,aAAc,iBAAkB,oBAAqB,mBAAoB,mBACzE,cAAe,mBAAoB,wBACtCK,EAAA9I,EAAA,EAE6BwD,QAAQiG,IAAI,CACtCjG,QAAQiG,IAAIjB,EAAQ7B,IAAI,SAAA+C,GAAC,OAAIvD,EAAKoC,EAAKmB,GAAG,IAC1ClG,QAAQiG,IAAIhB,EAAO9B,IAAI,SAAA+C,GAAC,OAAIvD,EAAKoC,EAAKmB,GAAG,MAC3C,OAHkB,OAGlBhB,EAAAI,EAAA9H,EAAA2H,EAAAgB,EAAAjB,EAAA,GAHKE,EAAMD,EAAA,GAAEE,EAAKF,EAAA,GAAAG,EAAA7H,EAAA,EAKb,CACH2I,IAAKhB,EAAOiB,KAAK,MACjBC,GAAIjB,EAAMgB,KAAK,QAClB,EAAAvB,EAAA,IACJD,EAAAxE,MAAA,KAAAD,UAAA,CAED,SAASiB,EAAakF,EAAKC,GACvB,IAAMC,EAAKnF,SAASG,eAAe,UACnCgF,EAAGC,YAAcH,EACjBE,EAAGE,UAAY,kBAAoBH,GAAO,aAC9C,CAvKAjB,OAAOC,SAAW,CACdoB,OAAQ,8CACRC,cAAe,uFACfC,aAAc,4FACdC,eAAgB,sEAChBC,cAAe,gEACfC,kBAAmB,oEACnBC,YAAa,0EACbC,WAAY,wEACZC,eAAgB,wEAChBC,MAAO,mEACPC,QAAS,uEACTC,UAAW,qEACXC,iBAAkB,mEAClBC,iBAAkB,mEAClBC,kBAAmB,oEACnBC,kBAAmB,sFACnBC,iBAAkB,oFAClBC,qBAAsB,oFACtBC,aAAc,4EACdC,YAAa,2EAGjBC,OAAOC,QAAQ,SAACtG,GACRA,EAAKuG,OAASF,OAAOG,SAASrG,QAC9BR,SAASG,eAAe,WAAW2G,QAAU5H,EAErD,E","sources":["webpack://datavista-excel-addin/./src/taskpane/taskpane.js"],"sourcesContent":["\r\nwindow.LIB_URLS = {\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\"\r\n};\r\n\r\nOffice.onReady((info) => {\r\n    if (info.host === Office.HostType.Excel) {\r\n        document.getElementById(\"run-btn\").onclick = runAnalysis;\r\n    }\r\n});\r\n\r\nasync function runAnalysis() {\r\n    try {\r\n        updateStatus(\"Reading Excel Data...\", \"text-info\");\r\n\r\n        const source = document.querySelector('input[name=\"source\"]:checked').value;\r\n        const options = {\r\n            stats: document.getElementById(\"opt-stats\").checked,\r\n            info: document.getElementById(\"opt-info\").checked,\r\n            desc: document.getElementById(\"opt-desc\").checked,\r\n            rich: document.getElementById(\"opt-formatting\").checked\r\n        };\r\n        const format = document.querySelector('input[name=\"format\"]:checked').value; // html only for now\r\n\r\n        let data = {};\r\n        let sheetNames = [];\r\n        let workbookName = \"Report\";\r\n\r\n        await Excel.run(async (context) => {\r\n            // Get workbook name\r\n            const workbook = context.workbook;\r\n            workbook.load(\"name\");\r\n            await context.sync();\r\n            workbookName = workbook.name || \"Report\";\r\n\r\n            if (source === \"selection\") {\r\n                const range = context.workbook.getSelectedRange();\r\n                range.load(\"values\");\r\n                await context.sync();\r\n\r\n                // Simple check for data\r\n                if (!range.values || range.values.length === 0) throw new Error(\"Selection is empty\");\r\n\r\n                data[\"Selection\"] = range.values;\r\n                sheetNames.push(\"Selection\");\r\n            } else {\r\n                const sheets = context.workbook.worksheets;\r\n                sheets.load(\"items/name\");\r\n                await context.sync();\r\n\r\n                // 1. Queue all Range logic\r\n                const sheetRanges = sheets.items.map(sheet => {\r\n                    const rng = sheet.getUsedRangeOrNullObject();\r\n                    rng.load(\"values, rowCount\");\r\n                    return { name: sheet.name, rng: rng };\r\n                });\r\n\r\n                // 2. Single Sync to fetch all data\r\n                await context.sync();\r\n\r\n                // 3. Process Data\r\n                for (let item of sheetRanges) {\r\n                    if (!item.rng.isNullObject && item.rng.rowCount > 0) {\r\n                        data[item.name] = item.rng.values;\r\n                        sheetNames.push(item.name);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        if (sheetNames.length === 0) throw new Error(\"No data found to export.\");\r\n\r\n        // Add workbook name to options\r\n        options.workbookName = workbookName;\r\n\r\n        // OFFLINE LIBRARY FETCHING\r\n        updateStatus(\"Bundling Premium Libraries (Offline Mode)...\", \"text-warning\");\r\n\r\n        const libs = await fetchOfflineLibs();\r\n\r\n        updateStatus(\"Generating Report...\", \"text-primary\");\r\n\r\n        let blob;\r\n        if (source === \"workbook\") {\r\n            // Use the new Dashboard Generator\r\n            blob = generateWorkbookHTML(data, sheetNames, options, libs);\r\n        } else {\r\n            // Use the standard single-page Generator\r\n            blob = generateHTML(data, sheetNames, options, libs);\r\n        }\r\n\r\n        const url = URL.createObjectURL(blob);\r\n\r\n        const a = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = `DataVista_Report_${new Date().getTime()}.html`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n\r\n        updateStatus(\"Done! File downloaded.\", \"text-success\");\r\n\r\n    } catch (error) {\r\n        console.error(error);\r\n        updateStatus(\"Error: \" + error.message, \"text-danger\");\r\n    }\r\n}\r\n\r\nasync function fetchOfflineLibs() {\r\n    // 1. Get List from generators.js\r\n    const urls = window.LIB_URLS;\r\n\r\n    // 2. Fetch Helper\r\n    const load = async (url) => {\r\n        try {\r\n            const r = await fetch(url);\r\n            if (!r.ok) throw new Error(url);\r\n            return await r.text();\r\n        } catch (e) {\r\n            console.warn(\"Failed to load lib: \" + url);\r\n            return `/* Failed: ${url} */`;\r\n        }\r\n    };\r\n\r\n    // 3. Parallel Fetching for Speed\r\n    // We strictly order the output concatenation\r\n    const cssKeys = ['bootstrap_css', 'datatables_css', 'buttons_css', 'searchbuilder_css', 'dateTime_css'];\r\n    const jsKeys = [\r\n        'jquery', 'bootstrap_js', 'datatables_js', 'datatables_bs5_js',\r\n        'jszip', 'pdfmake', 'vfs_fonts',\r\n        'buttons_js', 'buttons_bs5_js', 'buttons_colvis_js', 'buttons_html5_js', 'buttons_print_js',\r\n        'dateTime_js', 'searchbuilder_js', 'searchbuilder_bs5_js'\r\n    ];\r\n\r\n    const [cssArr, jsArr] = await Promise.all([\r\n        Promise.all(cssKeys.map(k => load(urls[k]))),\r\n        Promise.all(jsKeys.map(k => load(urls[k])))\r\n    ]);\r\n\r\n    return {\r\n        css: cssArr.join(\"\\n\"),\r\n        js: jsArr.join(\"\\n\")\r\n    };\r\n}\r\n\r\nfunction updateStatus(msg, cls) {\r\n    const el = document.getElementById(\"status\");\r\n    el.textContent = msg;\r\n    el.className = \"footer-status \" + (cls || \"text-muted\");\r\n}\r\n"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","_createForOfIteratorHelper","Array","isArray","_unsupportedIterableToArray","_n","F","s","next","_arrayLikeToArray","toString","slice","constructor","name","from","test","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","runAnalysis","_runAnalysis","_callee2","source","options","data","sheetNames","workbookName","libs","blob","url","_t","_context2","updateStatus","document","querySelector","stats","getElementById","checked","info","desc","rich","Excel","run","_ref","_callee","context","workbook","range","sheets","sheetRanges","_iterator","_step","item","_context","load","sync","getSelectedRange","values","Error","push","worksheets","items","map","sheet","rng","getUsedRangeOrNullObject","isNullObject","rowCount","err","_x","fetchOfflineLibs","generateWorkbookHTML","generateHTML","URL","createObjectURL","createElement","href","download","concat","Date","getTime","body","appendChild","click","removeChild","console","error","message","_fetchOfflineLibs","_callee4","urls","cssKeys","jsKeys","_yield$Promise$all","_yield$Promise$all2","cssArr","jsArr","_context4","window","LIB_URLS","_ref2","_callee3","_context3","fetch","ok","text","warn","_x2","all","k","_slicedToArray","css","join","js","msg","cls","el","textContent","className","jquery","bootstrap_css","bootstrap_js","datatables_css","datatables_js","datatables_bs5_js","buttons_css","buttons_js","buttons_bs5_js","jszip","pdfmake","vfs_fonts","buttons_html5_js","buttons_print_js","buttons_colvis_js","searchbuilder_css","searchbuilder_js","searchbuilder_bs5_js","dateTime_css","dateTime_js","Office","onReady","host","HostType","onclick"],"ignoreList":[],"sourceRoot":""}