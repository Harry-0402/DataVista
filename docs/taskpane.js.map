{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://datavista-excel-addin/./src/utils/grid.js","webpack://datavista-excel-addin/./src/taskpane/taskpane.js"],"sourcesContent":["\r\n/**\r\n * Trims empty rows and columns from a 2D array.\r\n * @param {any[][]} data \r\n * @returns {any[][] | null} Trimmed data or null if empty\r\n */\r\nexport function trimEmptyGrid(data) {\r\n    if (!data || data.length === 0) return null;\r\n\r\n    let minRow = data.length;\r\n    let maxRow = -1;\r\n    let minCol = data[0].length;\r\n    let maxCol = -1;\r\n\r\n    // 1. Find Bounds\r\n    for (let r = 0; r < data.length; r++) {\r\n        for (let c = 0; c < data[r].length; c++) {\r\n            const val = data[r][c];\r\n            if (val !== \"\" && val !== null && val !== undefined) {\r\n                if (r < minRow) minRow = r;\r\n                if (r > maxRow) maxRow = r;\r\n                if (c < minCol) minCol = c;\r\n                if (c > maxCol) maxCol = c;\r\n            }\r\n        }\r\n    }\r\n\r\n    // 2. Check if empty\r\n    if (maxRow === -1) return null;\r\n\r\n    // 3. Slice\r\n    const trimmed = [];\r\n    for (let r = minRow; r <= maxRow; r++) {\r\n        trimmed.push(data[r].slice(minCol, maxCol + 1));\r\n    }\r\n\r\n    return trimmed;\r\n}\r\n","\r\nimport { trimEmptyGrid } from \"../utils/grid\";\r\n\r\nwindow.LIB_URLS = {\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\"\r\n};\r\n\r\nOffice.onReady((info) => {\r\n    if (info.host === Office.HostType.Excel) {\r\n        document.getElementById(\"run-btn\").onclick = runAnalysis;\r\n    }\r\n});\r\n\r\nasync function runAnalysis() {\r\n    try {\r\n        updateStatus(\"Reading Excel Data...\", \"text-info\");\r\n\r\n        const source = document.querySelector('input[name=\"source\"]:checked').value;\r\n        const options = {\r\n            stats: document.getElementById(\"opt-stats\").checked,\r\n            info: document.getElementById(\"opt-info\").checked,\r\n            desc: document.getElementById(\"opt-desc\").checked,\r\n            rich: document.getElementById(\"opt-formatting\").checked\r\n        };\r\n        const format = document.querySelector('input[name=\"format\"]:checked').value; // html only for now\r\n\r\n        let data = {};\r\n        let sheetNames = [];\r\n        let workbookName = \"Report\";\r\n\r\n        await Excel.run(async (context) => {\r\n            // Get workbook name\r\n            const workbook = context.workbook;\r\n            workbook.load(\"name\");\r\n            await context.sync();\r\n            workbookName = workbook.name || \"Report\";\r\n\r\n            if (source === \"selection\") {\r\n                const range = context.workbook.getSelectedRange();\r\n                range.load(\"values\");\r\n                await context.sync();\r\n\r\n                // Trim empty rows/cols\r\n                const trimmed = trimEmptyGrid(range.values);\r\n\r\n                if (!trimmed) throw new Error(\"Selection is empty\");\r\n\r\n                data[\"Selection\"] = trimmed;\r\n                sheetNames.push(\"Selection\");\r\n            } else {\r\n                const sheets = context.workbook.worksheets;\r\n                sheets.load(\"items/name\");\r\n                await context.sync();\r\n\r\n                // 1. Queue all Range logic\r\n                const sheetRanges = sheets.items.map(sheet => {\r\n                    const rng = sheet.getUsedRangeOrNullObject();\r\n                    rng.load(\"values, rowCount\");\r\n                    return { name: sheet.name, rng: rng };\r\n                });\r\n\r\n                // 2. Single Sync to fetch all data\r\n                await context.sync();\r\n\r\n                // 3. Process Data\r\n                for (let item of sheetRanges) {\r\n                    if (!item.rng.isNullObject && item.rng.rowCount > 0) {\r\n                        const trimmed = trimEmptyGrid(item.rng.values);\r\n                        if (trimmed) {\r\n                            data[item.name] = trimmed;\r\n                            sheetNames.push(item.name);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        if (sheetNames.length === 0) throw new Error(\"No data found to export.\");\r\n\r\n        // Add workbook name to options\r\n        options.workbookName = workbookName;\r\n\r\n        // OFFLINE LIBRARY FETCHING\r\n        updateStatus(\"Bundling Premium Libraries (Offline Mode)...\", \"text-warning\");\r\n\r\n        const libs = await fetchOfflineLibs();\r\n\r\n        updateStatus(\"Generating Report...\", \"text-primary\");\r\n\r\n        let blob;\r\n        if (source === \"workbook\") {\r\n            // Use the new Dashboard Generator\r\n            blob = generateWorkbookHTML(data, sheetNames, options, libs);\r\n        } else {\r\n            // Use the standard single-page Generator\r\n            blob = generateHTML(data, sheetNames, options, libs);\r\n        }\r\n\r\n        const url = URL.createObjectURL(blob);\r\n\r\n        const a = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = `DataVista_Report_${new Date().getTime()}.html`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n\r\n        updateStatus(\"Done! File downloaded.\", \"text-success\");\r\n\r\n    } catch (error) {\r\n        console.error(error);\r\n        updateStatus(\"Error: \" + error.message, \"text-danger\");\r\n    }\r\n}\r\n\r\nasync function fetchOfflineLibs() {\r\n    // 1. Get List from generators.js\r\n    const urls = window.LIB_URLS;\r\n\r\n    // 2. Fetch Helper\r\n    const load = async (url) => {\r\n        try {\r\n            const r = await fetch(url);\r\n            if (!r.ok) throw new Error(url);\r\n            return await r.text();\r\n        } catch (e) {\r\n            console.warn(\"Failed to load lib: \" + url);\r\n            return `/* Failed: ${url} */`;\r\n        }\r\n    };\r\n\r\n    // 3. Parallel Fetching for Speed\r\n    // We strictly order the output concatenation\r\n    const cssKeys = ['bootstrap_css', 'datatables_css', 'buttons_css', 'searchbuilder_css', 'dateTime_css'];\r\n    const jsKeys = [\r\n        'jquery', 'bootstrap_js', 'datatables_js', 'datatables_bs5_js',\r\n        'jszip', 'pdfmake', 'vfs_fonts',\r\n        'buttons_js', 'buttons_bs5_js', 'buttons_colvis_js', 'buttons_html5_js', 'buttons_print_js',\r\n        'dateTime_js', 'searchbuilder_js', 'searchbuilder_bs5_js'\r\n    ];\r\n\r\n    const [cssArr, jsArr] = await Promise.all([\r\n        Promise.all(cssKeys.map(k => load(urls[k]))),\r\n        Promise.all(jsKeys.map(k => load(urls[k])))\r\n    ]);\r\n\r\n    return {\r\n        css: cssArr.join(\"\\n\"),\r\n        js: jsArr.join(\"\\n\")\r\n    };\r\n}\r\n\r\nfunction updateStatus(msg, cls) {\r\n    const el = document.getElementById(\"status\");\r\n    el.textContent = msg;\r\n    el.className = \"footer-status \" + (cls || \"text-muted\");\r\n}\r\n"],"names":["trimEmptyGrid","data","length","minRow","maxRow","minCol","maxCol","r","c","val","trimmed","push","slice","e","t","Symbol","n","iterator","o","toStringTag","i","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","_createForOfIteratorHelper","Array","isArray","_unsupportedIterableToArray","_n","F","s","next","_arrayLikeToArray","toString","constructor","name","from","test","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","runAnalysis","_runAnalysis","_callee2","source","options","sheetNames","workbookName","libs","blob","url","_t","_context2","updateStatus","document","querySelector","stats","getElementById","checked","info","desc","rich","Excel","run","_ref","_callee","context","workbook","range","sheets","sheetRanges","_iterator","_step","item","_trimmed","_context","load","sync","getSelectedRange","values","Error","worksheets","items","map","sheet","rng","getUsedRangeOrNullObject","isNullObject","rowCount","err","_x","fetchOfflineLibs","generateWorkbookHTML","generateHTML","URL","createObjectURL","createElement","href","download","concat","Date","getTime","body","appendChild","click","removeChild","console","error","message","_fetchOfflineLibs","_callee4","urls","cssKeys","jsKeys","_yield$Promise$all","_yield$Promise$all2","cssArr","jsArr","_context4","window","LIB_URLS","_ref2","_callee3","_context3","fetch","ok","text","warn","_x2","all","k","_slicedToArray","css","join","js","msg","cls","el","textContent","className","jquery","bootstrap_css","bootstrap_js","datatables_css","datatables_js","datatables_bs5_js","buttons_css","buttons_js","buttons_bs5_js","jszip","pdfmake","vfs_fonts","buttons_html5_js","buttons_print_js","buttons_colvis_js","searchbuilder_css","searchbuilder_js","searchbuilder_bs5_js","dateTime_css","dateTime_js","Office","onReady","host","HostType","onclick"],"ignoreList":[],"sourceRoot":""}