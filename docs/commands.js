/*! For license information please see commands.js.LICENSE.txt */
(()=>{"use strict";var t={};function n(t){if(!t||0===t.length)return null;for(var n=t.length,e=-1,a=t[0].length,o=-1,r=0;r<t.length;r++)for(var s=0;s<t[r].length;s++){var i=t[r][s];""!==i&&null!=i&&(r<n&&(n=r),r>e&&(e=r),s<a&&(a=s),s>o&&(o=s))}if(-1===e)return null;for(var d=[],l=n;l<=e;l++)d.push(t[l].slice(a,o+1));return d}function e(t,n,e,a){var o=[];o.push("<!DOCTYPE html><html lang='en' data-bs-theme='light'>"),o.push("<head><meta charset='UTF-8'><title>DataVista Report</title>"),o.push("<style>".concat(a.css||"","</style>")),o.push('<style>\n        :root { --header-bg: #3c6ea9; --header-text: white; }\n        [data-bs-theme="dark"] { --header-bg: #1f2937; }\n\n        html { scroll-behavior: smooth; }\n        body { background-color: var(--bs-body-bg); color: var(--bs-body-color); font-family: \'Segoe UI\', sans-serif; zoom: 0.9; }\n        \n        .dv-header {\n            background-color: var(--header-bg); color: var(--header-text);\n            padding: 12px 2rem; display: flex; justify-content: space-between; align-items: center;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 1.5rem; gap: 2rem;\n        }\n        [data-bs-theme="dark"] .dv-header { background-color: var(--header-bg-dark); }\n\n        .header-content { display: flex; flex-direction: column; }\n        .dv-brand { font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; gap: 8px; }\n        .dv-meta { font-size: 0.75rem; opacity: 0.7; margin-top: 2px; }\n        \n        /* Header Tabs */\n        .dv-header-tabs { \n            border: none; margin: 0; display: flex; gap: 4px; flex: 1; justify-content: center;\n        }\n        .dv-header-tabs .nav-link { \n            border: none; color: rgba(255,255,255,0.7); background: transparent;\n            padding: 8px 16px; font-weight: 500; border-radius: 20px;\n            transition: all 0.2s; font-size: 0.85rem;\n        }\n        .dv-header-tabs .nav-link:hover { \n            color: white; background: rgba(255,255,255,0.1);\n        }\n        .dv-header-tabs .nav-link.active { \n            color: white; background: rgba(255,255,255,0.2);\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n        \n        .theme-toggler { cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 0.8rem; border: 1px solid rgba(255,255,255,0.3); padding: 4px 10px; border-radius: 16px; transition: all 0.2s; }\n        .theme-toggler:hover { background-color: rgba(255,255,255,0.1); }\n\n        .dv-container { padding: 0 2rem 3rem 2rem; }\n        .dv-tab-content { padding-top: 0; }\n        .nav-link { \n            border: none; color: var(--bs-body-color); opacity: 0.6; padding: 10px 20px; font-weight: 500; border-radius: 30px !important; transition: all 0.2s; \n        }\n        .nav-link:hover { background: rgba(0,0,0,0.05); opacity: 1; }\n        .nav-link.active { background-color: var(--header-bg) !important; color: white !important; opacity: 1; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }\n\n        /* Card */\n        .dv-card { background: var(--bs-card-bg); border: 1px solid var(--bs-border-color); border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.02); margin-bottom: 2rem; }\n\n        /* Sheet Sections */\n        .dv-sheet-section { margin-bottom: 3rem; }\n\n        /* DataTable Overrides */\n        table.dataTable { border-collapse: collapse !important; border: 1px solid var(--bs-border-color) !important; font-size: 0.8rem; }\n        table.dataTable thead th { \n            border: 1px solid var(--bs-border-color) !important; \n            border-bottom: 2px solid var(--bs-border-color) !important; \n            font-weight: 600; \n            vertical-align: middle; \n            padding: 6px 8px !important;\n        table.dataTable tbody td { \n            vertical-align: middle; \n            padding: 4px 8px !important; \n            border: 1px solid var(--bs-border-color) !important;\n        table.dataTable tfoot th {\n            border: 1px solid var(--bs-border-color) !important;\n            padding: 6px 8px !important;\n            font-size: 0.8rem;\n        }\n        \n        /* Filter Inputs */\n        .filter-input { width: 100%; border: 1px solid var(--bs-border-color); background: var(--bs-body-bg); color: var(--bs-body-color); padding: 4px 8px; border-radius: 4px; font-size: 0.85rem; margin-top: 5px; }\n        \n        /* Pagination & Info Alignment */\n        .dataTables_info { padding-top: 0.85em !important; }\n        .dataTables_paginate { display: flex; justify-content: flex-end; }\n        \n        /* Stats Footer */\n        tfoot th { font-size: 0.9rem; background: var(--bs-tertiary-bg); }\n\n        /* RICH FORMATTING */\n        .dv-neg { color: #dc3545 !important; font-weight: 500; }\n        .dv-bar-cell { position: relative; z-index: 1; }\n        .dv-bar {\n            position: absolute; top: 2px; bottom: 2px; left: 0; \n            background: linear-gradient(90deg, rgba(60, 110, 169, 0.15), rgba(60, 110, 169, 0.05));\n            z-index: -1; border-radius: 0 4px 4px 0; transition: width 0.3s;\n        }\n        [data-bs-theme="dark"] .dv-bar { background: linear-gradient(90deg, rgba(60, 110, 169, 0.4), rgba(60, 110, 169, 0.1)); }\n        \n        /* Modal Tweaks */\n        .modal-backdrop.show { opacity: 0; position: fixed; width: 100vw; height: 100vh; top: 0; left: 0; } /* Transparent backdrop */\n        .modal-content { box-shadow: none; border: 1px solid var(--bs-border-color); }\n    </style>'),o.push("</head><body>");var r=(new Date).toLocaleString(),s=n.length>0?n[0]:"Report";return o.push('\n    <div class="dv-header">\n        <div>\n            <div class="dv-brand">\n                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>\n                DataVista <span style="opacity: 0.6; margin: 0 8px;">|</span> '.concat(s,'\n            </div>\n            <div class="dv-meta">Generated: ').concat(r,'</div>\n        </div>\n        <ul class="nav nav-tabs dv-header-tabs" role="tablist">\n            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#page-data">Data</a></li>\n            ').concat(e.info?'<li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#page-info">Dataset Info</a></li>':"","\n            ").concat(e.stats?'<li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#page-stats">Summary Statistics</a></li>':"",'\n        </ul>\n        <div class="theme-toggler" onclick="document.documentElement.setAttribute(\'data-bs-theme\', document.documentElement.getAttribute(\'data-bs-theme\')===\'dark\'?\'light\':\'dark\')">\n            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/></svg>\n            <span>Theme</span>\n        </div>\n    </div>\n    ')),o.push('<div class="container-fluid dv-container mt-3 mb-5">'),o.push('<div class="tab-content dv-tab-content">'),o.push('<div id="page-data" class="tab-pane fade show active">'),n.forEach(function(n,a){for(var r=t[n],s=r.length>0,i=s?r[0]:[],d=s?r.slice(1):[],l=[],c=[],b=0;b<i.length;b++){for(var u=0,h=!0,p=0;p<d.length;p++){var m=Number(d[p][b]);if(isNaN(m)){h=!1;break}Math.abs(m)>u&&(u=Math.abs(m))}l[b]=h?"num":"str",c[b]=h&&u>0?u:0}o.push('<div class="dv-sheet-section" id="data-section">'),o.push('<div class="dv-card">'),o.push('<table class="table table-hover display nowrap" style="width:100%">'),o.push("<thead><tr>"),i.forEach(function(t,n){var e="num"===l[n]?"text-end":"text-start";o.push('<th class="'.concat(e,'">').concat(t,"</th>"))}),o.push("</tr></thead>"),o.push("<tbody>"),d.forEach(function(t){o.push("<tr>"),t.forEach(function(t,n){var a=t,r="num"===l[n]?"text-end":"text-start",s="";if(e.rich){var i=Number(t);if(!isNaN(i)&&(i<0&&(r+=" dv-neg"),c[n]>0)){r+=" dv-bar-cell";var d=Math.min(100,Math.abs(i)/c[n]*100);s='<div class="dv-bar" style="width:'.concat(d,'%"></div>')}}o.push('<td class="'.concat(r,'">').concat(a).concat(s,"</td>"))}),o.push("</tr>")}),o.push("</tbody>"),o.push("</table></div>"),o.push("</div>")}),o.push("</div>"),e.info&&(o.push('<div id="page-info" class="tab-pane fade">'),n.forEach(function(n,e){var a=t[n],r=a.length>0?a[0]:[],s=a.length>0?a.slice(1):[];o.push('<div class="dv-card"><h5>Dataset Info: '.concat(n,"</h5>").concat(function(t,n){var e="<table class='table table-sm'><thead><tr><th>Col</th><th>Type</th><th>Non-Null</th></tr></thead><tbody>";return t.forEach(function(t,a){var o=0,r=0;n.forEach(function(t){""!==t[a]&&null!==t[a]&&o++,isNaN(Number(t[a]))||r++});var s=r===o&&o>0?"Numeric":"Object";e+="<tr><td>".concat(t,"</td><td>").concat(s,"</td><td>").concat(o,"</td></tr>")}),e+"</tbody></table>"}(r,s),"</div>"))}),o.push("</div>")),e.stats&&(o.push('<div id="page-stats" class="tab-pane fade">'),n.forEach(function(n,e){var a=t[n],r=a.length>0?a[0]:[],s=a.length>0?a.slice(1):[];o.push('<div class="dv-card"><h5>Statistics: '.concat(n,"</h5>").concat(function(t,n){if(0===n.length)return"<p class='small text-muted'>No data available.</p>";var e=[];t.forEach(function(t,a){var o=0,r=[];if(n.forEach(function(t){var n=t[a];""!==n&&null!=n&&o++;var e=Number(n);isNaN(e)||""===n||r.push(e)}),0!==r.length){r.sort(function(t,n){return t-n});var s=r.length,i=r.reduce(function(t,n){return t+n},0)/s,d=r.reduce(function(t,n){return t+Math.pow(n-i,2)},0)/s,l=Math.sqrt(d),c=function(t){var n=t/100*(s-1),e=Math.floor(n),a=Math.ceil(n),o=n%1;return r[e]*(1-o)+r[a]*o},b=function(t){return t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})};e.push({col:t,count:o,mean:b(i),std:b(l),min:b(r[0]),q25:b(c(25)),q50:b(c(50)),q75:b(c(75)),max:b(r[s-1])})}else e.push({col:t,count:o,mean:"-",std:"-",min:"-",q25:"-",q50:"-",q75:"-",max:"-"})});var a="<table class='table table-sm table-bordered'><thead><tr><th>Statistic</th>";return e.forEach(function(t){return a+="<th>".concat(t.col,"</th>")}),a+="</tr></thead><tbody>",["count","mean","std","min","25%","50%","75%","max"].forEach(function(t){a+="<tr><th>".concat(t,"</th>"),e.forEach(function(n){var e=n["25%"===t?"q25":"50%"===t?"q50":"75%"===t?"q75":t];a+="<td>".concat(e,"</td>")}),a+="</tr>"}),a+="</tbody></table>"}(r,s),"</div>"))}),o.push("</div>")),o.push("</div>"),o.push('\n    <div class="modal fade" id="searchBuilderModal" tabindex="-1" aria-hidden="true">\n        <div class="modal-dialog modal-xl">\n            <div class="modal-content" style="background-color: var(--bs-body-bg); color: var(--bs-body-color);">\n                <div class="modal-header">\n                    <h5 class="modal-title">Advanced Filters</h5>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body" id="sb-modal-body">\n                    \x3c!-- SearchBuilder will be appended here --\x3e\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>\n                </div>\n            </div>\n        </div>\n    </div>\n    '),o.push("</div>"),o.push("<script>".concat(a.js||"","<\/script>")),o.push("<script>\n    $(document).ready(function() {\n        $('table.display').each(function() {\n            var table = $(this);\n            \n            var dt = table.DataTable({\n                dom: '<\"row mb-3\"<\"col-md-6\"B><\"col-md-6\"f>>rt<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\n                initComplete: function () {\n                    var api = this.api();\n                    \n                    // 1. Move SearchBuilder to Modal\n                    // We manually create the SearchBuilder instance and append to modal\n                    var sb = new $.fn.dataTable.SearchBuilder(api, {});\n                    $('#sb-modal-body').append(sb.getNode());\n\n                    // 2. Add Filter Inputs to Header\n                    api.columns().eq(0).each(function (colIdx) {\n                        var header = $(api.column(colIdx).header());\n                        var title = header.text();\n                        var input = $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" />')\n                            .appendTo(header.empty())\n                            .on('keyup change', function () {\n                                api.column(colIdx).search(this.value).draw();\n                            });\n                        header.prepend('<div style=\"margin-bottom: 5px; font-weight: 600;\">' + title + '</div>');\n                    });\n                },\n                buttons: [\n                    {\n                        text: 'Advanced Filters',\n                        className: 'btn-info me-3', // Added margin-end for spacing\n                        action: function (e, dt, node, config) {\n                            $('#searchBuilderModal').modal('show');\n                        }\n                    },\n                    'copy', \n                    'csv', \n                    'excel', \n                    {\n                        extend: 'pdfHtml5',\n                        orientation: 'landscape',\n                        pageSize: 'A4',\n                        customize: function(doc) {\n                            // 1. Optimize Margins\n                            doc.pageMargins = [10, 10, 10, 10];\n                            \n                            // 2. robust column count\n                            var table = doc.content[1].table;\n                            var colCount = table.body[0].length;\n                            \n                            // 3. Dynamic Font Scaling (More granular)\n                            // Base 9, reduced by 0.2 for every column over 5, min 4\n                            var fontSize = 9;\n                            if(colCount > 5) {\n                                fontSize = Math.max(4, 9 - ((colCount - 5) * 0.3)); \n                            }\n                            \n                            doc.defaultStyle.fontSize = fontSize;\n                            doc.styles.tableHeader.fontSize = fontSize + 1;\n                            doc.styles.title.fontSize = 12;\n\n                            // 4. Force Fit Page Width (Star Widths)\n                            // Using Array.fill is cleaner/safer than join/split\n                            table.widths = new Array(colCount).fill('*');\n\n                            // 5. Right-align numbers & condensed margins\n                            var rowCount = table.body.length;\n                            for (var i = 1; i < rowCount; i++) {\n                                table.body[i].forEach(function(cell) {\n                                    if(!isNaN(Number(cell.text)) && cell.text !== \"\") {\n                                        cell.alignment = 'right';\n                                    }\n                                    cell.margin = [1, 2, 1, 2]; // Tighter cell padding\n                                });\n                            }\n                        }\n                    },\n                    'print', \n                    'colvis'\n                ],\n                pageLength: 15\n            });\n        });\n    });\n    <\/script>"),o.push("</body></html>"),new Blob(o,{type:"text/html"})}function a(t,n,e,a){var o=(new Date).toLocaleString(),r=e.workbookName||"Workbook",s='\n    <style>\n        :root {\n            --bs-body-bg: #ffffff;\n            --bs-body-color: #212529;\n            --bs-primary: #0d6efd;\n            --bs-secondary: #6c757d;\n            --bs-light: #f8f9fa;\n            --bs-dark: #212529;\n            --bs-border-color: #dee2e6;\n            --dv-header-bg: #f8f9fa;\n            --dv-header-color: #333;\n        }\n        [data-bs-theme="dark"] {\n            --bs-body-bg: #212529;\n            --bs-body-color: #f8f9fa;\n            --bs-border-color: #495057;\n            --dv-header-bg: #2c3034;\n            --dv-header-color: #fff;\n        }\n        body { font-family: \'Segoe UI\', Roboto, Helvetica, Arial, sans-serif; font-size: 0.9rem; margin: 0; padding: 0; background-color: var(--bs-body-bg); color: var(--bs-body-color); zoom: 0.9; }\n        \n        /* Dashboard / Index Styles */\n        .dashboard-container { max-width: 1200px; margin: 50px auto; text-align: center; }\n        .dashboard-header { margin-bottom: 50px; }\n        .dashboard-title { font-size: 2.5rem; font-weight: 300; margin-bottom: 10px; }\n        .dashboard-meta { color: var(--bs-secondary); }\n        \n        .sheet-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px; }\n        .sheet-card {\n            background: var(--bs-body-bg);\n            border: 1px solid var(--bs-border-color);\n            border-radius: 8px;\n            padding: 30px;\n            cursor: pointer;\n            transition: transform 0.2s, box-shadow 0.2s;\n            text-decoration: none;\n            color: inherit;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            height: 150px;\n            width: 280px;\n        }\n        .sheet-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); border-color: var(--bs-primary); }\n        .sheet-icon { width: 40px; height: 40px; margin-bottom: 15px; color: var(--bs-primary); }\n        .sheet-name { font-size: 1.2rem; font-weight: 500; }\n\n        /* Sheet View Styles (Initially Hidden) */\n        .view-section { display: none; padding-top: 20px; }\n        .view-section.active { display: block; }\n\n        /* Back Button Header */\n        .sheet-header {\n            display: flex; align-items: center; justify-content: space-between;\n            background: var(--dv-header-bg); color: var(--dv-header-color);\n            padding: 10px 20px;\n            border-bottom: 1px solid var(--bs-border-color);\n            margin-bottom: 20px;\n        }\n        .btn-back { display: flex; align-items: center; gap: 5px; cursor: pointer; font-weight: 600; text-decoration: none; color: inherit; }\n        .btn-back:hover { text-decoration: underline; }\n\n        /* Table Styles (Compact) */\n        table.dataTable { border-collapse: collapse !important; border: 1px solid var(--bs-border-color) !important; font-size: 0.8rem; width: 100% !important; }\n        table.dataTable thead th { border: 1px solid var(--bs-border-color); padding: 6px 8px; background: var(--bs-light); color: var(--bs-dark); }\n        [data-bs-theme="dark"] table.dataTable thead th { background: #343a40; color: #fff; }\n        table.dataTable tbody td { border: 1px solid var(--bs-border-color); padding: 4px 8px; }\n\n        /* Modal Tweaks */\n        .modal-backdrop.show { opacity: 0 !important; position: fixed; width: 100vw; height: 100vh; top: 0; left: 0; }\n        .modal-content { box-shadow: none !important; border: 1px solid var(--bs-border-color); }\n    </style>\n    <style>'.concat(a.css||"","</style>\n    "),i=[];return i.push('<!DOCTYPE html><html lang="en" data-bs-theme="light"><head><meta charset="UTF-8"><title>'.concat(r,"</title>").concat(s,"</head><body>")),i.push('\n    <div id="dashboard-view" class="view-section active">\n        <div class="dashboard-container">\n            <div class="dashboard-header">\n                <div class="dv-brand" style="display: flex; align-items: center; justify-content: center; margin-bottom: 20px; font-size: 1.5rem; font-weight: bold;">\n                    <img src="https://Harry-0402.github.io/DataVista/assets/icon-32.png" width="32" height="32" style="margin-right: 10px;" alt="Logo">\n                    DataVista Report\n                </div>\n                <h1 class="dashboard-title">'.concat(r,'</h1>\n                <p class="dashboard-meta">Generated on ').concat(o," &bull; ").concat(n.length,' Sheets</p>\n            </div>\n            \n            <div class="sheet-grid">\n    ')),n.forEach(function(t,n){i.push('\n        <div class="sheet-card" onclick="showSheet(\''.concat(n,'\')">\n            <svg class="sheet-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>\n            <div class="sheet-name">').concat(t,"</div>\n        </div>\n        "))}),i.push("    </div></div></div>"),n.forEach(function(n,e){var a=t[n],o=a.length>0?a[0]:[],r=a.length>0?a.slice(1):[];i.push('\n        <div id="sheet-view-'.concat(e,'" class="view-section">\n            \x3c!-- Sheet Header --\x3e\n            <div class="sheet-header">\n                <a class="btn-back" onclick="showDashboard()">\n                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M10 19l-7-7m0 0l7-7m-7 7h18"/></svg>\n                    Back to Dashboard\n                </a>\n                <div style="font-size: 1.2rem; font-weight: bold;">').concat(n,'</div>\n                <div class="theme-toggler" style="cursor: pointer;" onclick="toggleTheme()">\n                     <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/></svg>\n                </div>\n            </div>\n\n            <div class="container-fluid">\n        ')),i.push('<table class="table table-striped table-hover display nowrap" style="width:100%">'),i.push("<thead><tr>"),o.forEach(function(t){return i.push("<th>".concat(t||"","</th>"))}),i.push("</tr></thead>"),i.push("<tbody>"),r.forEach(function(t){i.push("<tr>"),t.forEach(function(t){var n=null==t?"":t;i.push("<td>".concat(n,"</td>"))}),i.push("</tr>")}),i.push("</tbody>"),i.push("</table>"),i.push("</div></div>")}),i.push('\n    <div class="modal fade" id="searchBuilderModal" tabindex="-1" aria-hidden="true">\n        <div class="modal-dialog modal-xl">\n            <div class="modal-content" style="background-color: var(--bs-body-bg); color: var(--bs-body-color);">\n                <div class="modal-header">\n                    <h5 class="modal-title">Advanced Filters</h5>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body" id="sb-modal-body"></div>\n                <div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button></div>\n            </div>\n        </div>\n    </div>\n    '),i.push("<script>".concat(a.js||"","<\/script>")),i.push("<script>\n    // Navigation Logic\n    function showDashboard() {\n        $('.view-section').removeClass('active');\n        $('#dashboard-view').addClass('active');\n        document.title = \"".concat(r,"\";\n    }\n\n    function showSheet(index) {\n        $('.view-section').removeClass('active');\n        $('#sheet-view-' + index).addClass('active');\n        // We might want to trigger a redraw of DataTable if it was hidden\n        $.fn.dataTable.tables({ visible: true, api: true }).columns.adjust();\n    }\n\n    function toggleTheme() {\n        const html = document.documentElement;\n        const current = html.getAttribute('data-bs-theme');\n        html.setAttribute('data-bs-theme', current === 'dark' ? 'light' : 'dark');\n    }\n\n    $(document).ready(function() {\n        // Initialize ALL tables\n        $('table.display').each(function() {\n            var table = $(this);\n            var dt = table.DataTable({\n                dom: '<\"row mb-3\"<\"col-md-6\"B><\"col-md-6\"f>>rt<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\n                pageLength: 15,\n                scrollX: true,\n                buttons: [\n                    {\n                         text: 'Advanced Filters',\n                         className: 'btn-info me-3',\n                         action: function (e, dt, node, config) {\n                             // Clear previous SB\n                             $('#sb-modal-body').empty();\n                             var sb = new $.fn.dataTable.SearchBuilder(dt, {}); // Create for current table\n                             $('#sb-modal-body').append(sb.getNode());\n                             $('#searchBuilderModal').modal('show');\n                         }\n                    },\n                    'copy', 'csv', 'excel',\n                    {\n                        extend: 'pdfHtml5',\n                        orientation: 'landscape',\n                        pageSize: 'A4',\n                        customize: function(doc) {\n                            // 1. Optimize Margins\n                            doc.pageMargins = [10, 10, 10, 10];\n                            \n                            // 2. robust column count\n                            var table = doc.content[1].table;\n                            var colCount = table.body[0].length;\n                            \n                            // 3. Dynamic Font Scaling (More granular)\n                            // Base 9, reduced by 0.2 for every column over 5, min 4\n                            var fontSize = 9;\n                            if(colCount > 5) {\n                                fontSize = Math.max(4, 9 - ((colCount - 5) * 0.3)); \n                            }\n                            \n                            doc.defaultStyle.fontSize = fontSize;\n                            doc.styles.tableHeader.fontSize = fontSize + 1;\n                            doc.styles.title.fontSize = 12;\n\n                            // 4. Force Fit Page Width\n                            table.widths = new Array(colCount).fill('*');\n\n                            // 5. Condensed margins & alignment\n                            var rowCount = table.body.length;\n                            for (var i = 1; i < rowCount; i++) {\n                                table.body[i].forEach(function(cell) {\n                                    if(!isNaN(Number(cell.text)) && cell.text !== \"\") {\n                                        cell.alignment = 'right';\n                                    }\n                                    cell.margin = [1, 2, 1, 2];\n                                });\n                            }\n                        }\n                    },\n                    'print', 'colvis'\n                ],\n                initComplete: function() {\n                    var api = this.api();\n                    api.columns().eq(0).each(function (colIdx) {\n                        var header = $(api.column(colIdx).header());\n                        var title = header.text();\n                        var input = $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" style=\"width:100%; border:1px solid #ddd; border-radius:4px; padding:2px 4px; font-weight:normal;\" />')\n                            .appendTo(header.empty())\n                            .on('keyup change', function () { api.column(colIdx).search(this.value).draw(); });\n                        header.prepend('<div style=\"margin-bottom: 5px; font-weight: 600;\">' + title + '</div>');\n                    });\n                }\n            });\n        });\n    });\n    <\/script></body></html>")),new Blob([i.join("")],{type:"text/html"})}function o(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var a,o,r,s,i=[],d=!0,l=!1;try{if(r=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;d=!1}else for(;!(d=(a=r.call(e)).done)&&(i.push(a.value),i.length!==n);d=!0);}catch(t){l=!0,o=t}finally{try{if(!d&&null!=e.return&&(s=e.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(t,n)||s(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=s(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,d=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){d=!0,r=t},f:function(){try{i||null==e.return||e.return()}finally{if(d)throw r}}}}function s(t,n){if(t){if("string"==typeof t)return i(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?i(t,n):void 0}}function i(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,a=Array(n);e<n;e++)a[e]=t[e];return a}function d(){var t,n,e="function"==typeof Symbol?Symbol:{},a=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function r(e,a,o,r){var d=a&&a.prototype instanceof i?a:i,c=Object.create(d.prototype);return l(c,"_invoke",function(e,a,o){var r,i,d,l=0,c=o||[],b=!1,u={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(n,e){return r=n,i=0,d=t,u.n=e,s}};function h(e,a){for(i=e,d=a,n=0;!b&&l&&!o&&n<c.length;n++){var o,r=c[n],h=u.p,p=r[2];e>3?(o=p===a)&&(d=r[(i=r[4])?5:(i=3,3)],r[4]=r[5]=t):r[0]<=h&&((o=e<2&&h<r[1])?(i=0,u.v=a,u.n=r[1]):h<p&&(o=e<3||r[0]>a||a>p)&&(r[4]=e,r[5]=a,u.n=p,i=0))}if(o||e>1)return s;throw b=!0,a}return function(o,c,p){if(l>1)throw TypeError("Generator is already running");for(b&&1===c&&h(c,p),i=c,d=p;(n=i<2?t:d)||!b;){r||(i?i<3?(i>1&&(u.n=-1),h(i,d)):u.n=d:u.v=d);try{if(l=2,r){if(i||(o="next"),n=r[o]){if(!(n=n.call(r,d)))throw TypeError("iterator result is not an object");if(!n.done)return n;d=n.value,i<2&&(i=0)}else 1===i&&(n=r.return)&&n.call(r),i<2&&(d=TypeError("The iterator does not provide a '"+o+"' method"),i=1);r=t}else if((n=(b=u.n<0)?d:e.call(a,u))!==s)break}catch(n){r=t,i=1,d=n}finally{l=1}}return{value:n,done:b}}}(e,o,r),!0),c}var s={};function i(){}function c(){}function b(){}n=Object.getPrototypeOf;var u=[][a]?n(n([][a]())):(l(n={},a,function(){return this}),n),h=b.prototype=i.prototype=Object.create(u);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,o,"GeneratorFunction")),t.prototype=Object.create(h),t}return c.prototype=b,l(h,"constructor",b),l(b,"constructor",c),c.displayName="GeneratorFunction",l(b,o,"GeneratorFunction"),l(h),l(h,o,"Generator"),l(h,a,function(){return this}),l(h,"toString",function(){return"[object Generator]"}),(d=function(){return{w:r,m:p}})()}function l(t,n,e,a){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}l=function(t,n,e,a){function r(n,e){l(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!a,configurable:!a,writable:!a}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},l(t,n,e,a)}function c(t,n,e,a,o,r,s){try{var i=t[r](s),d=i.value}catch(t){return void e(t)}i.done?n(d):Promise.resolve(d).then(a,o)}function b(t){return function(){var n=this,e=arguments;return new Promise(function(a,o){var r=t.apply(n,e);function s(t){c(r,a,o,s,i,"next",t)}function i(t){c(r,a,o,s,i,"throw",t)}s(void 0)})}}t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),window.LIB_URLS={bootstrap_css:"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css",datatables_css:"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css",buttons_css:"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css",searchbuilder_css:"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css",dateTime_css:"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css",jquery:"https://code.jquery.com/jquery-3.7.0.min.js",bootstrap_js:"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js",datatables_js:"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js",datatables_bs5_js:"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js",jszip:"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js",pdfmake:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js",vfs_fonts:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js",buttons_js:"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js",buttons_bs5_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js",buttons_colvis_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js",buttons_html5_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js",buttons_print_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js",dateTime_js:"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js",searchbuilder_js:"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js",searchbuilder_bs5_js:"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js"};var u={jquery:"https://code.jquery.com/jquery-3.7.0.min.js",bootstrap_css:"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css",bootstrap_js:"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js",datatables_css:"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css",datatables_js:"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js",datatables_bs5_js:"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js",buttons_css:"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css",buttons_js:"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js",buttons_bs5_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js",jszip:"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js",pdfmake:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js",vfs_fonts:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js",buttons_html5_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js",buttons_print_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js",buttons_colvis_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js",searchbuilder_css:"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css",searchbuilder_js:"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js",searchbuilder_bs5_js:"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js",dateTime_css:"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css",dateTime_js:"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js"};function h(){return(h=b(d().m(function t(n){return d().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,m("selection",n);case 1:return t.a(2)}},t)}))).apply(this,arguments)}function p(){return(p=b(d().m(function t(n){return d().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,m("workbook",n);case 1:return t.a(2)}},t)}))).apply(this,arguments)}function m(t,n){return f.apply(this,arguments)}function f(){return f=b(d().m(function t(o,s){var i,l,c,u,h,p,m,f;return d().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,i={stats:!0,info:!0,desc:!0,rich:!0,workbookName:"Report"},l={},c=[],t.n=1,Excel.run(function(){var t=b(d().m(function t(e){var a,s,b,u,h,p,m,f,v;return d().w(function(t){for(;;)switch(t.n){case 0:return(a=e.workbook).load("name"),t.n=1,e.sync();case 1:if(i.workbookName=a.name||"Report","selection"!==o){t.n=4;break}return(s=e.workbook.getSelectedRange()).load("values"),t.n=2,e.sync();case 2:if(b=n(s.values)){t.n=3;break}throw new Error("Selection is empty");case 3:l.Selection=b,c.push("Selection"),t.n=7;break;case 4:return(u=e.workbook.worksheets).load("items/name"),t.n=5,e.sync();case 5:return h=u.items.map(function(t){var n=t.getUsedRangeOrNullObject();return n.load("values, rowCount"),{name:t.name,rng:n}}),t.n=6,e.sync();case 6:p=r(h);try{for(p.s();!(m=p.n()).done;)!(f=m.value).rng.isNullObject&&f.rng.rowCount>0&&(v=n(f.rng.values))&&(l[f.name]=v,c.push(f.name))}catch(t){p.e(t)}finally{p.f()}case 7:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}());case 1:if(0!==c.length){t.n=2;break}throw new Error("No data found.");case 2:return t.n=3,v();case 3:u=t.v,h="workbook"===o?a(l,c,i,u):e(l,c,i,u),p=URL.createObjectURL(h),(m=document.createElement("a")).href=p,m.download="DataVista_".concat(i.workbookName,"_").concat((new Date).getTime(),".html"),document.body.appendChild(m),m.click(),document.body.removeChild(m),t.n=5;break;case 4:t.p=4,f=t.v,console.error(f);case 5:return t.p=5,s.completed(),t.f(5);case 6:return t.a(2)}},t,null,[[0,4,5,6]])})),f.apply(this,arguments)}function v(){return g.apply(this,arguments)}function g(){return g=b(d().m(function t(){var n,e,a,r,s,i,l,c;return d().w(function(t){for(;;)switch(t.n){case 0:return n=u,e=function(){var t=b(d().m(function t(n){var e;return d().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,fetch(n);case 1:if((e=t.v).ok){t.n=2;break}throw new Error(n);case 2:return t.n=3,e.text();case 3:return t.a(2,t.v);case 4:return t.p=4,t.v,t.a(2,"/* Failed: ".concat(n," */"))}},t,null,[[0,4]])}));return function(n){return t.apply(this,arguments)}}(),a=["bootstrap_css","datatables_css","buttons_css","searchbuilder_css","dateTime_css"],r=["jquery","bootstrap_js","datatables_js","datatables_bs5_js","jszip","pdfmake","vfs_fonts","buttons_js","buttons_bs5_js","buttons_colvis_js","buttons_html5_js","buttons_print_js","dateTime_js","searchbuilder_js","searchbuilder_bs5_js"],t.n=1,Promise.all([Promise.all(a.map(function(t){return e(n[t])})),Promise.all(r.map(function(t){return e(n[t])}))]);case 1:return s=t.v,i=o(s,2),l=i[0],c=i[1],t.a(2,{css:l.join("\n"),js:c.join("\n")})}},t)})),g.apply(this,arguments)}Office.onReady(function(){});var y="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t.g?t.g:void 0;y.exportSelection=function(t){return h.apply(this,arguments)},y.exportWorkbook=function(t){return p.apply(this,arguments)}})();
//# sourceMappingURL=commands.js.map