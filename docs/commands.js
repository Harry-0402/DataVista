/*! For license information please see commands.js.LICENSE.txt */
(()=>{"use strict";var t={};function n(t){if(!t||0===t.length)return null;for(var n=t.length,a=-1,e=t[0].length,r=-1,o=0;o<t.length;o++)for(var s=0;s<t[o].length;s++){var i=t[o][s];""!==i&&null!=i&&(o<n&&(n=o),o>a&&(a=o),s<e&&(e=s),s>r&&(r=s))}if(-1===a)return null;for(var d=[],c=n;c<=a;c++)d.push(t[c].slice(e,r+1));return d}function a(t,n,a,e){var r=[];r.push("<!DOCTYPE html><html lang='en' data-bs-theme='light'>"),r.push("<head><meta charset='UTF-8'><title>DataVista Report</title>"),r.push("<style>".concat(e.css||"","</style>")),r.push('<style>\n        :root { --header-bg: #3c6ea9; --header-text: white; }\n        [data-bs-theme="dark"] { --header-bg: #1f2937; }\n\n        html { scroll-behavior: smooth; }\n        body { \n            background-color: var(--bs-body-bg); \n            color: var(--bs-body-color); \n            font-family: \'Segoe UI\', sans-serif; \n            overflow-x: hidden; /* Prevent body scroll */\n            width: 100vw;\n        }\n        \n        /* Header Container */\n        .dv-header {\n            background-color: var(--header-bg); color: var(--header-text);\n            padding: 12px 2rem; display: flex; justify-content: space-between; align-items: center;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 1.5rem; gap: 2rem;\n        }\n        [data-bs-theme="dark"] .dv-header { background-color: var(--header-bg-dark); }\n\n        .dv-brand { font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; gap: 8px; }\n        .dv-meta { font-size: 0.75rem; opacity: 0.7; margin-top: 2px; }\n        \n        /* Navigation */\n        .dv-header-tabs .nav-link { \n            border: none; color: rgba(255,255,255,0.7); background: transparent;\n            padding: 8px 16px; font-weight: 500; border-radius: 20px; transition: all 0.2s; font-size: 0.85rem;\n        }\n        .dv-header-tabs .nav-link.active { color: white; background: rgba(255,255,255,0.2); }\n        .theme-toggler { cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 0.8rem; border: 1px solid rgba(255,255,255,0.3); padding: 4px 10px; border-radius: 16px; }\n\n        .dv-container { padding: 0 20px 3rem 20px; max-width: 100vw; overflow-x: hidden; }\n\n        /* Card */\n        .dv-card { background: var(--bs-card-bg); border: 1px solid var(--bs-border-color); border-radius: 12px; padding: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.02); margin-bottom: 2rem; }\n\n        /* === PRECISION HEADER & FILTERS (v9.0) === */\n        .dv-table-wrapper { width: 100%; margin-bottom: 2rem; position: relative; }\n        \n        /* Header Styling */\n        table.dataTable thead tr:first-child th {\n            background: var(--bs-secondary-bg) !important;\n            padding: 12px 18px !important;\n            font-weight: 700 !important;\n            border-bottom: 2px solid var(--bs-border-color) !important;\n            vertical-align: middle !important;\n        }\n        \n        /* Filter Row Styling */\n        .filter-row th {\n            padding: 8px 10px !important;\n            background: var(--bs-body-bg) !important;\n            border-bottom: 1px solid var(--bs-border-color) !important;\n        }\n        .filter-input {\n            width: 100%;\n            border: 1px solid var(--bs-border-color);\n            padding: 5px 10px;\n            font-size: 0.75rem;\n            border-radius: 6px;\n            outline: none;\n            transition: border-color 0.2s;\n        }\n        .filter-input:focus { border-color: #00bcd4; box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.1); }\n\n        /* SearchPanes Styling */\n        .dtsp-searchPanes { margin-bottom: 1.5rem; border: 1px solid var(--bs-border-color); border-radius: 8px; padding: 15px; background: var(--bs-body-bg); }\n        .dtsp-pane { border: none !important; }\n\n        /* Controls Row */\n        .dv-controls-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 12px; }\n        .dv-search-group { display: flex; align-items: center; gap: 15px; }\n        .dv-summary-stats { display: flex; gap: 10px; font-size: 0.85rem; color: var(--bs-secondary-color); border-right: 1px solid var(--bs-border-color); padding-right: 15px; }\n        .dv-stat-badge { background: var(--bs-secondary-bg); padding: 2px 8px; border-radius: 4px; font-weight: 600; color: var(--bs-primary); }\n\n        /* Navigator Bar Refinement */\n        .dv-header-tabs {\n            border-bottom: none !important;\n            justify-content: center;\n            gap: 5px;\n        }\n        .dv-header-tabs .nav-link {\n            border: none !important;\n            color: rgba(255,255,255,0.7) !important;\n            padding: 8px 20px !important;\n            border-radius: 20px !important;\n            font-weight: 500;\n            transition: all 0.3s;\n        }\n        .dv-header-tabs .nav-link:hover {\n            color: white !important;\n            background: rgba(255,255,255,0.1) !important;\n        }\n        .dv-header-tabs .nav-link.active {\n            color: white !important;\n            background: rgba(255,255,255,0.2) !important;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n\n        /* Teal Advanced Filters Button */\n        .btn-advanced-filters {\n            background-color: #00bcd4 !important;\n            color: white !important;\n            border: none !important;\n            font-weight: 600 !important;\n            padding: 7px 18px !important;\n            border-radius: 6px !important;\n            transition: transform 0.1s, opacity 0.2s;\n        }\n        .btn-advanced-filters:hover { opacity: 0.95; transform: translateY(-1px); }\n        .btn-advanced-filters:active { transform: translateY(0); }\n\n        /* Gray Export Buttons */\n        .dt-button {\n            background-color: #6c757d !important;\n            color: white !important;\n            border: none !important;\n            border-radius: 6px !important;\n            padding: 6px 14px !important;\n            font-size: 0.85rem !important;\n            margin-right: 4px !important;\n            transition: background 0.2s;\n        }\n        .dt-button:hover { background-color: #5a6268 !important; }\n\n        .dataTables_scrollBody { border: 1px solid var(--bs-border-color); border-radius: 0 0 8px 8px; }\n        .dataTables_scrollHead { border: 1px solid var(--bs-border-color); border-bottom: none; border-radius: 8px 8px 0 0; background: var(--bs-secondary-bg); }\n\n        table.dataTable { width: 100% !important; margin: 0 !important; table-layout: auto !important; border-collapse: collapse !important; }\n        table.dataTable th, table.dataTable td { \n            white-space: nowrap !important; \n            vertical-align: middle; \n            padding: 12px 18px !important; \n            font-size: inherit; \n            min-width: 120px; \n        }\n\n        /* RICH FORMATTING */\n        .dv-neg { color: #dc3545 !important; font-weight: 500; }\n        .dv-bar-cell { position: relative; z-index: 1; }\n        .dv-bar { position: absolute; top: 2px; bottom: 2px; left: 0; background: rgba(0, 188, 212, 0.15); z-index: -1; }\n    </style>'),r.push("</head><body>");var o=(new Date).toLocaleString(),s=n.length>0?n[0]:"Report";return r.push('\n    <div class="dv-header">\n        <div>\n            <div class="dv-brand">\n                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>\n                DataVista <span style="opacity: 0.6; margin: 0 8px;">|</span> '.concat(s,'\n            </div>\n            <div class="dv-meta">Generated: ').concat(o,' &bull; v9.0 (Precision Layout & Filters)</div>\n        </div>\n        <ul class="nav nav-tabs dv-header-tabs" role="tablist">\n            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#page-data">Data</a></li>\n            ').concat(a.info?'<li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#page-info">Info</a></li>':"","\n            ").concat(a.stats?'<li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#page-stats">Stats</a></li>':"","\n        </ul>\n        <div class=\"theme-toggler\" onclick=\"document.documentElement.setAttribute('data-bs-theme', document.documentElement.getAttribute('data-bs-theme')==='dark'?'light':'dark')\">\n            <span>Theme</span>\n        </div>\n    </div>\n    ")),r.push('<div class="container-fluid dv-container">'),r.push('<div class="tab-content dv-tab-content">'),r.push('<div id="page-data" class="tab-pane fade show active">'),n.forEach(function(n,a){var e=t[n],o=e.length>0,s=o?e[0]:[],i=o?e.slice(1):[],d=s.length,c=.9;d>6&&(c=Math.max(.5,.9-.05*(d-6)));var l=c.toFixed(2)+"rem";r.push('<div class="dv-sheet-section"><div class="dv-card">'),r.push('<div class="dv-table-wrapper">'),r.push('<table class="table table-hover display table-bordered" style="width:100% !important; font-size:'.concat(l,';">')),r.push("<thead>"),r.push("<tr>"),s.forEach(function(t){return r.push("<th>".concat(t,"</th>"))}),r.push("</tr>"),r.push('<tr class="filter-row">'),s.forEach(function(){return r.push("<th></th>")}),r.push("</tr>"),r.push("</thead><tbody>"),i.forEach(function(t){r.push("<tr>"),t.forEach(function(t){r.push("<td>".concat(t||"","</td>"))}),r.push("</tr>")}),r.push("</tbody></table></div></div></div>")}),r.push("</div>"),a.info&&r.push('<div id="page-info" class="tab-pane fade"><div class="dv-card"><h5>Dataset Info</h5><div class="alert alert-info">Generated via DataVista Engine v3.0</div></div></div>'),a.stats&&r.push('<div id="page-stats" class="tab-pane fade"><div class="dv-card"><h5>Statistics</h5><p>Statistics module initialized.</p></div></div>'),r.push("</div></div>"),r.push('\n    <div class="modal fade" id="searchBuilderModal" tabindex="-1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-body" id="sb-modal-body"></div></div></div></div>\n    '),r.push("<script>".concat(e.js||"","<\/script>")),r.push("<script>\n    $(document).ready(function() {\n        $('table.display').each(function() {\n            var table = $(this);\n            // Initialize DataTable with STRICT options\n            table.DataTable({\n                dom: 'P<\"dv-controls-row\"B<\"dv-search-group\"f>>t<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\n                orderCellsTop: true, // Use first row for sorting\n                searchPanes: {\n                    cascadePanes: true,\n                    viewTotal: true,\n                    layout: 'columns-3'\n                },\n                autoWidth: false,\n                scrollX: true,\n                scrollCollapse: true,\n                paging: true,\n                pageLength: 20,\n                buttons: [\n                    {\n                        text: 'Advanced Filters',\n                        className: 'btn-advanced-filters',\n                        action: function (e, dt) {\n                            $('#sb-modal-body').empty();\n                            var sb = new $.fn.dataTable.SearchBuilder(dt, {});\n                            $('#sb-modal-body').append(sb.getNode());\n                            $('#searchBuilderModal').modal('show');\n                        }\n                    },\n                    'copy', 'csv', 'excel', 'pdf', 'print', 'colvis'\n                ],\n                initComplete: function () {\n                    var api = this.api();\n                    \n                    // Add Row/Col Counts\n                    var rowCount = api.rows().count();\n                    var colCount = api.columns().count();\n                    var statsHtml = `\n                        <div class=\"dv-summary-stats\">\n                            <span>Total Rows: <span class=\"dv-stat-badge\">${rowCount}</span></span>\n                            <span>Total Columns: <span class=\"dv-stat-badge\">${colCount}</span></span>\n                        </div>\n                    `;\n                    $('.dv-search-group').prepend(statsHtml);\n\n                    // Inject filters into the SECOND header row\n                    $(api.table().header()).find('tr.filter-row th').each(function (colIdx) {\n                        $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" />')\n                            .appendTo(this)\n                            .on('keyup change', function (e) { \n                                e.stopPropagation();\n                                api.column(colIdx).search(this.value).draw(); \n                            });\n                    });\n                    \n                    setTimeout(function() { api.columns.adjust(); }, 150);\n                }\n            });\n        });\n    });\n    <\/script>"),r.push("</body></html>"),new Blob(r,{type:"text/html"})}function e(t,n,a,e){var r=(new Date).toLocaleString(),o=a.workbookName||"Workbook",s="\n    <style>\n        :root {\n            --bs-body-bg: #ffffff;\n            --bs-body-color: #212529;\n            --bs-primary: #0d6efd;\n            --bs-border-color: #dee2e6;\n            --dv-header-bg: #f8f9fa;\n        }\n        [data-bs-theme=\"dark\"] {\n            --bs-body-bg: #212529;\n            --bs-body-color: #f8f9fa;\n            --bs-border-color: #495057;\n            --dv-header-bg: #2c3034;\n        }\n        body { \n            font-family: 'Segoe UI', sans-serif; \n            margin: 0; padding: 0; \n            background-color: var(--bs-body-bg); color: var(--bs-body-color);\n            overflow-x: hidden; \n            width: 100vw;\n        }\n        \n        /* Dashboard Styles */\n        .dashboard-container { max-width: 1200px; margin: 50px auto; text-align: center; }\n        .dashboard-title { font-size: 2.5rem; font-weight: 300; margin-bottom: 10px; }\n        .dashboard-meta { color: gray; }\n        \n        .sheet-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px; }\n        .sheet-card {\n            background: var(--bs-body-bg);\n            border: 1px solid var(--bs-border-color);\n            border-radius: 8px;\n            padding: 30px;\n            cursor: pointer;\n            transition: transform 0.2s;\n            width: 280px;\n        }\n        .sheet-card:hover { transform: translateY(-5px); border-color: var(--bs-primary); }\n        .sheet-name { font-size: 1.2rem; font-weight: 500; margin-top: 15px; }\n\n        /* Sheet View Styles */\n        .view-section { display: none; padding-top: 0; }\n        .view-section.active { display: block; }\n\n        .sheet-header {\n            display: flex; align-items: center; justify-content: space-between;\n            background: var(--dv-header-bg); padding: 10px 20px;\n            border-bottom: 1px solid var(--bs-border-color); margin-bottom: 20px;\n        }\n        .btn-back { cursor: pointer; font-weight: 600; text-decoration: none; color: inherit; display: flex; align-items: center; gap: 5px; }\n\n        /* === PRECISION HEADER & FILTERS (v9.0) === */\n        .dv-table-wrapper { width: 100%; margin-bottom: 2rem; position: relative; }\n        \n        /* Header Styling */\n        table.dataTable thead tr:first-child th {\n            background: var(--dv-header-bg) !important;\n            padding: 12px 18px !important;\n            font-weight: 700 !important;\n            border-bottom: 2px solid var(--bs-border-color) !important;\n            vertical-align: middle !important;\n        }\n        \n        /* Filter Row Styling */\n        .filter-row th {\n            padding: 8px 10px !important;\n            background: var(--bs-body-bg) !important;\n            border-bottom: 1px solid var(--bs-border-color) !important;\n        }\n\n        .filter-input { width: 100%; border: 1px solid var(--bs-border-color); padding: 5px 10px; font-size: 0.75rem; border-radius: 6px; outline: none; transition: border-color 0.2s; }\n        .filter-input:focus { border-color: #00bcd4; box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.1); }\n\n        /* SearchPanes Styling */\n        .dtsp-searchPanes { margin-bottom: 1.5rem; border: 1px solid var(--bs-border-color); border-radius: 8px; padding: 15px; background: var(--bs-body-bg); }\n\n        .dv-controls-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 12px; }\n        .dv-search-group { display: flex; align-items: center; gap: 15px; }\n        .dv-summary-stats { display: flex; gap: 10px; font-size: 0.85rem; color: var(--bs-secondary-color); border-right: 1px solid var(--bs-border-color); padding-right: 15px; }\n        .dv-stat-badge { background: var(--bs-secondary-bg); padding: 2px 8px; border-radius: 4px; font-weight: 600; color: var(--dv-primary); }\n\n        .btn-advanced-filters { background-color: #00bcd4 !important; color: white !important; border: none !important; font-weight: 600 !important; padding: 7px 18px !important; border-radius: 6px !important; transition: opacity 0.2s, transform 0.1s; }\n        .btn-advanced-filters:hover { opacity: 0.95; transform: translateY(-1px); }\n\n        .dt-button { background-color: #6c757d !important; color: white !important; border: none !important; border-radius: 6px !important; padding: 6px 14px !important; font-size: 0.85rem !important; margin-right: 4px !important; transition: background 0.2s; }\n        .dt-button:hover { background-color: #5a6268 !important; }\n\n        .dataTables_scrollBody { border: 1px solid var(--bs-border-color); border-radius: 0 0 8px 8px; }\n        .dataTables_scrollHead { border: 1px solid var(--bs-border-color); border-bottom: none; border-radius: 8px 8px 0 0; background: var(--dv-header-bg); }\n\n        table.dataTable { width: 100% !important; margin: 0 !important; table-layout: auto !important; border-collapse: collapse !important; }\n        table.dataTable th, table.dataTable td { white-space: nowrap !important; vertical-align: middle; padding: 12px 18px !important; border: 1px solid var(--bs-border-color); min-width: 120px; }\n\n        .filter-input { width: 100%; border: 1px solid var(--bs-border-color); padding: 2px; font-size: 0.75rem; border-radius: 3px; }\n        .dataTables_paginate { display: flex; justify-content: flex-end; margin-top: 10px; font-size: 0.8rem; }\n    </style>\n    <style>".concat(e.css||"","</style>\n    "),i=[];return i.push('<!DOCTYPE html><html lang="en" data-bs-theme="light"><head><meta charset="UTF-8"><title>'.concat(o,"</title>").concat(s,"</head><body>")),i.push('\n    <div id="dashboard-view" class="view-section active">\n        <div class="dashboard-container">\n            <div class="dashboard-header">\n                <div style="font-size: 1.5rem; font-weight: bold; margin-bottom: 20px;">\n                    <img src="https://Harry-0402.github.io/DataVista/assets/icon-32.png" width="32" height="32" style="margin-right: 10px;">\n                    DataVista Report\n                </div>\n                <h1 class="dashboard-title">'.concat(o,'</h1>\n                <p class="dashboard-meta">Generated on ').concat(r," &bull; ").concat(n.length,' Sheets &bull; v9.0 (Precision Layout & Filters)</p>\n            </div>\n            <div class="sheet-grid">\n    ')),n.forEach(function(t,n){i.push('\n        <div class="sheet-card" onclick="showSheet(\''.concat(n,'\')">\n            <svg width="40" height="40" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>\n            <div class="sheet-name">').concat(t,"</div>\n        </div>\n        "))}),i.push("</div></div></div>"),n.forEach(function(n,a){var e=t[n],r=e.length>0?e[0]:[],o=e.length>0?e.slice(1):[],s=r.length,d=.9;s>6&&(d=Math.max(.5,.9-.05*(s-6)));var c=d.toFixed(2)+"rem";i.push('\n        <div id="sheet-view-'.concat(a,'" class="view-section">\n            <div class="sheet-header">\n                <a class="btn-back" onclick="showDashboard()">\n                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M10 19l-7-7m0 0l7-7m-7 7h18"/></svg>\n                    Back to Dashboard\n                </a>\n                <div style="font-weight: bold;">').concat(n,'</div>\n                <div onclick="document.documentElement.setAttribute(\'data-bs-theme\', document.documentElement.getAttribute(\'data-bs-theme\')===\'dark\'?\'light\':\'dark\')" style="cursor: pointer;">Theme</div>\n            </div>\n            <div class="container-fluid" style="padding: 0 20px;">\n                <div class="dv-table-wrapper">\n                    <table class="table table-striped table-hover display table-bordered" style="width:100% !important; font-size:').concat(c,';">\n                        <thead>\n                            <tr>').concat(r.map(function(t){return"<th>".concat(t||"","</th>")}).join(""),'</tr>\n                            <tr class="filter-row">').concat(r.map(function(){return"<th></th>"}).join(""),"</tr>\n                        </thead>\n                        <tbody>\n                            ").concat(o.map(function(t){return"<tr>".concat(t.map(function(t){return"<td>".concat(t||"","</td>")}).join(""),"</tr>")}).join(""),"\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n        "))}),i.push('\n    <div class="modal fade" id="searchBuilderModal" tabindex="-1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-body" id="sb-modal-body"></div></div></div></div>\n    '),i.push("<script>".concat(e.js||"","<\/script>")),i.push("<script>\n    function showDashboard() { $('.view-section').removeClass('active'); $('#dashboard-view').addClass('active'); }\n    function showSheet(index) { \n        $('.view-section').removeClass('active'); \n        $('#sheet-view-' + index).addClass('active'); \n        $.fn.dataTable.tables({ visible: true, api: true }).columns.adjust();\n    }\n\n    $(document).ready(function() {\n        $('table.display').each(function() {\n            var table = $(this);\n            table.DataTable({\n                dom: 'P<\"dv-controls-row\"B<\"dv-search-group\"f>>t<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\n                orderCellsTop: true,\n                searchPanes: {\n                    cascadePanes: true,\n                    viewTotal: true,\n                    layout: 'columns-3'\n                },\n                autoWidth: false,\n                scrollX: true,\n                scrollCollapse: true,\n                pageLength: 20,\n                buttons: [\n                    {\n                        text: 'Advanced Filters',\n                        className: 'btn-advanced-filters',\n                        action: function (e, dt) {\n                            $('#sb-modal-body').empty();\n                            var sb = new $.fn.dataTable.SearchBuilder(dt, {});\n                            $('#sb-modal-body').append(sb.getNode());\n                            $('#searchBuilderModal').modal('show');\n                        }\n                    },\n                    'copy', 'csv', 'excel', 'pdf', 'print', 'colvis'\n                ],\n                initComplete: function() {\n                    var api = this.api();\n\n                    // Add Row/Col Counts\n                    var rowCount = api.rows().count();\n                    var colCount = api.columns().count();\n                    var statsHtml = `\n                        <div class=\"dv-summary-stats\">\n                            <span>Total Rows: <span class=\"dv-stat-badge\">${rowCount}</span></span>\n                            <span>Total Columns: <span class=\"dv-stat-badge\">${colCount}</span></span>\n                        </div>\n                    `;\n                    $(this).closest('.dv-table-wrapper').find('.dv-search-group').prepend(statsHtml);\n\n                    // Inject filters into the SECOND header row\n                    $(api.table().header()).find('tr.filter-row th').each(function (colIdx) {\n                        $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" />')\n                            .appendTo(this)\n                            .on('keyup change', function (e) { \n                                e.stopPropagation();\n                                api.column(colIdx).search(this.value).draw(); \n                            });\n                    });\n                    \n                    setTimeout(function() { api.columns.adjust(); }, 150);\n                }\n            });\n        });\n    });\n    <\/script></body></html>"),new Blob([i.join("")],{type:"text/html"})}function r(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var e,r,o,s,i=[],d=!0,c=!1;try{if(o=(a=a.call(t)).next,0===n){if(Object(a)!==a)return;d=!1}else for(;!(d=(e=o.call(a)).done)&&(i.push(e.value),i.length!==n);d=!0);}catch(t){c=!0,r=t}finally{try{if(!d&&null!=a.return&&(s=a.return(),Object(s)!==s))return}finally{if(c)throw r}}return i}}(t,n)||s(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,n){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=s(t))||n&&t&&"number"==typeof t.length){a&&(t=a);var e=0,r=function(){};return{s:r,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,d=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return i=t.done,t},e:function(t){d=!0,o=t},f:function(){try{i||null==a.return||a.return()}finally{if(d)throw o}}}}function s(t,n){if(t){if("string"==typeof t)return i(t,n);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?i(t,n):void 0}}function i(t,n){(null==n||n>t.length)&&(n=t.length);for(var a=0,e=Array(n);a<n;a++)e[a]=t[a];return e}function d(){var t,n,a="function"==typeof Symbol?Symbol:{},e=a.iterator||"@@iterator",r=a.toStringTag||"@@toStringTag";function o(a,e,r,o){var d=e&&e.prototype instanceof i?e:i,l=Object.create(d.prototype);return c(l,"_invoke",function(a,e,r){var o,i,d,c=0,l=r||[],p=!1,b={p:0,n:0,v:t,a:u,f:u.bind(t,4),d:function(n,a){return o=n,i=0,d=t,b.n=a,s}};function u(a,e){for(i=a,d=e,n=0;!p&&c&&!r&&n<l.length;n++){var r,o=l[n],u=b.p,h=o[2];a>3?(r=h===e)&&(d=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=t):o[0]<=u&&((r=a<2&&u<o[1])?(i=0,b.v=e,b.n=o[1]):u<h&&(r=a<3||o[0]>e||e>h)&&(o[4]=a,o[5]=e,b.n=h,i=0))}if(r||a>1)return s;throw p=!0,e}return function(r,l,h){if(c>1)throw TypeError("Generator is already running");for(p&&1===l&&u(l,h),i=l,d=h;(n=i<2?t:d)||!p;){o||(i?i<3?(i>1&&(b.n=-1),u(i,d)):b.n=d:b.v=d);try{if(c=2,o){if(i||(r="next"),n=o[r]){if(!(n=n.call(o,d)))throw TypeError("iterator result is not an object");if(!n.done)return n;d=n.value,i<2&&(i=0)}else 1===i&&(n=o.return)&&n.call(o),i<2&&(d=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=t}else if((n=(p=b.n<0)?d:a.call(e,b))!==s)break}catch(n){o=t,i=1,d=n}finally{c=1}}return{value:n,done:p}}}(a,r,o),!0),l}var s={};function i(){}function l(){}function p(){}n=Object.getPrototypeOf;var b=[][e]?n(n([][e]())):(c(n={},e,function(){return this}),n),u=p.prototype=i.prototype=Object.create(b);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,r,"GeneratorFunction")),t.prototype=Object.create(u),t}return l.prototype=p,c(u,"constructor",p),c(p,"constructor",l),l.displayName="GeneratorFunction",c(p,r,"GeneratorFunction"),c(u),c(u,r,"Generator"),c(u,e,function(){return this}),c(u,"toString",function(){return"[object Generator]"}),(d=function(){return{w:o,m:h}})()}function c(t,n,a,e){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}c=function(t,n,a,e){function o(n,a){c(t,n,function(t){return this._invoke(n,a,t)})}n?r?r(t,n,{value:a,enumerable:!e,configurable:!e,writable:!e}):t[n]=a:(o("next",0),o("throw",1),o("return",2))},c(t,n,a,e)}function l(t,n,a,e,r,o,s){try{var i=t[o](s),d=i.value}catch(t){return void a(t)}i.done?n(d):Promise.resolve(d).then(e,r)}function p(t){return function(){var n=this,a=arguments;return new Promise(function(e,r){var o=t.apply(n,a);function s(t){l(o,e,r,s,i,"next",t)}function i(t){l(o,e,r,s,i,"throw",t)}s(void 0)})}}t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),window.LIB_URLS={bootstrap_css:"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css",datatables_css:"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css",buttons_css:"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css",searchbuilder_css:"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css",dateTime_css:"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css",searchpanes_css:"https://cdn.datatables.net/searchpanes/2.2.0/css/searchPanes.bootstrap5.min.css",select_css:"https://cdn.datatables.net/select/1.7.0/css/select.bootstrap5.min.css",jquery:"https://code.jquery.com/jquery-3.7.0.min.js",bootstrap_js:"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js",datatables_js:"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js",datatables_bs5_js:"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js",jszip:"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js",pdfmake:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js",vfs_fonts:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js",buttons_js:"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js",buttons_bs5_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js",buttons_colvis_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js",buttons_html5_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js",buttons_print_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js",dateTime_js:"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js",searchbuilder_js:"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js",searchbuilder_bs5_js:"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js",searchpanes_js:"https://cdn.datatables.net/searchpanes/2.2.0/js/dataTables.searchPanes.min.js",searchpanes_bs5_js:"https://cdn.datatables.net/searchpanes/2.2.0/js/searchPanes.bootstrap5.min.js",select_js:"https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js"};var b={jquery:"https://code.jquery.com/jquery-3.7.0.min.js",bootstrap_css:"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css",bootstrap_js:"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js",datatables_css:"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css",datatables_js:"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js",datatables_bs5_js:"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js",buttons_css:"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css",buttons_js:"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js",buttons_bs5_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js",jszip:"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js",pdfmake:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js",vfs_fonts:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js",buttons_html5_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js",buttons_print_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js",buttons_colvis_js:"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js",searchbuilder_css:"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css",searchbuilder_js:"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js",searchbuilder_bs5_js:"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js",dateTime_css:"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css",dateTime_js:"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js",searchpanes_css:"https://cdn.datatables.net/searchpanes/2.2.0/css/searchPanes.bootstrap5.min.css",searchpanes_js:"https://cdn.datatables.net/searchpanes/2.2.0/js/dataTables.searchPanes.min.js",searchpanes_bs5_js:"https://cdn.datatables.net/searchpanes/2.2.0/js/searchPanes.bootstrap5.min.js",select_css:"https://cdn.datatables.net/select/1.7.0/css/select.bootstrap5.min.css",select_js:"https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js"};function u(){return(u=p(d().m(function t(n){return d().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,m("selection",n);case 1:return t.a(2)}},t)}))).apply(this,arguments)}function h(){return(h=p(d().m(function t(n){return d().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,m("workbook",n);case 1:return t.a(2)}},t)}))).apply(this,arguments)}function m(t,n){return v.apply(this,arguments)}function v(){return v=p(d().m(function t(r,s){var i,c,l,b,u,h,m,v;return d().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,i={stats:!0,info:!0,desc:!0,rich:!0,workbookName:"Report"},c={},l=[],t.n=1,Excel.run(function(){var t=p(d().m(function t(a){var e,s,p,b,u,h,m,v,f;return d().w(function(t){for(;;)switch(t.n){case 0:return(e=a.workbook).load("name"),t.n=1,a.sync();case 1:if(i.workbookName=e.name||"Report","selection"!==r){t.n=4;break}return(s=a.workbook.getSelectedRange()).load("values"),t.n=2,a.sync();case 2:if(p=n(s.values)){t.n=3;break}throw new Error("Selection is empty");case 3:c.Selection=p,l.push("Selection"),t.n=7;break;case 4:return(b=a.workbook.worksheets).load("items/name"),t.n=5,a.sync();case 5:return u=b.items.map(function(t){var n=t.getUsedRangeOrNullObject();return n.load("values, rowCount"),{name:t.name,rng:n}}),t.n=6,a.sync();case 6:h=o(u);try{for(h.s();!(m=h.n()).done;)!(v=m.value).rng.isNullObject&&v.rng.rowCount>0&&(f=n(v.rng.values))&&(c[v.name]=f,l.push(v.name))}catch(t){h.e(t)}finally{h.f()}case 7:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}());case 1:if(0!==l.length){t.n=2;break}throw new Error("No data found.");case 2:return t.n=3,f();case 3:b=t.v,u="workbook"===r?e(c,l,i,b):a(c,l,i,b),h=URL.createObjectURL(u),(m=document.createElement("a")).href=h,m.download="DataVista_".concat(i.workbookName,"_").concat((new Date).getTime(),".html"),document.body.appendChild(m),m.click(),document.body.removeChild(m),t.n=5;break;case 4:t.p=4,v=t.v,console.error(v);case 5:return t.p=5,s.completed(),t.f(5);case 6:return t.a(2)}},t,null,[[0,4,5,6]])})),v.apply(this,arguments)}function f(){return g.apply(this,arguments)}function g(){return g=p(d().m(function t(){var n,a,e,o,s,i,c,l;return d().w(function(t){for(;;)switch(t.n){case 0:return n=b,a=function(){var t=p(d().m(function t(n){var a;return d().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,fetch(n);case 1:if((a=t.v).ok){t.n=2;break}throw new Error(n);case 2:return t.n=3,a.text();case 3:return t.a(2,t.v);case 4:return t.p=4,t.v,t.a(2,"/* Failed: ".concat(n," */"))}},t,null,[[0,4]])}));return function(n){return t.apply(this,arguments)}}(),e=["bootstrap_css","datatables_css","buttons_css","searchbuilder_css","dateTime_css"],o=["jquery","bootstrap_js","datatables_js","datatables_bs5_js","jszip","pdfmake","vfs_fonts","buttons_js","buttons_bs5_js","buttons_colvis_js","buttons_html5_js","buttons_print_js","dateTime_js","searchbuilder_js","searchbuilder_bs5_js"],t.n=1,Promise.all([Promise.all(e.map(function(t){return a(n[t])})),Promise.all(o.map(function(t){return a(n[t])}))]);case 1:return s=t.v,i=r(s,2),c=i[0],l=i[1],t.a(2,{css:c.join("\n"),js:l.join("\n")})}},t)})),g.apply(this,arguments)}Office.onReady(function(){});var y="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t.g?t.g:void 0;y.exportSelection=function(t){return u.apply(this,arguments)},y.exportWorkbook=function(t){return h.apply(this,arguments)}})();
//# sourceMappingURL=commands.js.map