{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://datavista-excel-addin/webpack/bootstrap","webpack://datavista-excel-addin/./src/utils/data-utils.js","webpack://datavista-excel-addin/./src/taskpane/generators.js","webpack://datavista-excel-addin/./src/taskpane/workbook_generators.js","webpack://datavista-excel-addin/./src/commands/commands.js","webpack://datavista-excel-addin/webpack/runtime/global"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","\r\n/**\r\n * Trims empty rows and columns from a 2D array.\r\n * @param {any[][]} data \r\n * @returns {any[][] | null} Trimmed data or null if empty\r\n */\r\nexport function trimEmptyGrid(data) {\r\n    if (!data || data.length === 0) return null;\r\n\r\n    let minRow = data.length;\r\n    let maxRow = -1;\r\n    let minCol = data[0].length;\r\n    let maxCol = -1;\r\n\r\n    // 1. Find Bounds\r\n    for (let r = 0; r < data.length; r++) {\r\n        for (let c = 0; c < data[r].length; c++) {\r\n            const val = data[r][c];\r\n            if (val !== \"\" && val !== null && val !== undefined) {\r\n                if (r < minRow) minRow = r;\r\n                if (r > maxRow) maxRow = r;\r\n                if (c < minCol) minCol = c;\r\n                if (c > maxCol) maxCol = c;\r\n            }\r\n        }\r\n    }\r\n\r\n    // 2. Check if empty\r\n    if (maxRow === -1) return null;\r\n\r\n    // 3. Slice\r\n    const trimmed = [];\r\n    for (let r = minRow; r <= maxRow; r++) {\r\n        trimmed.push(data[r].slice(minCol, maxCol + 1));\r\n    }\r\n\r\n    return trimmed;\r\n}\r\n","/* global Blob, window */\r\n// generators.js\r\n\r\nwindow.LIB_URLS = {\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n\r\n    // SearchBuilder & DateTime\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n    searchpanes_css: \"https://cdn.datatables.net/searchpanes/2.2.0/css/searchPanes.bootstrap5.min.css\",\r\n    select_css: \"https://cdn.datatables.net/select/1.7.0/css/select.bootstrap5.min.css\",\r\n\r\n    // JS Dependencies\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n\r\n    // DataTables Core & BS5\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n\r\n    // Export Dependencies\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n\r\n    // Extensions\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\",\r\n    searchpanes_js: \"https://cdn.datatables.net/searchpanes/2.2.0/js/dataTables.searchPanes.min.js\",\r\n    searchpanes_bs5_js: \"https://cdn.datatables.net/searchpanes/2.2.0/js/searchPanes.bootstrap5.min.js\",\r\n    select_js: \"https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js\"\r\n};\r\n\r\n/**\r\n * Main Generator Function\r\n * @param {Object} data - { \"Sheet1\": [[header, val], [val, val]] }\r\n * @param {string[]} sheetNames\r\n * @param {Object} options - { stats: bool, info: bool, desc: bool, rich: bool, workbookName: string }\r\n * @param {Object} libs - { css: string, js: string }\r\n */\r\nexport function generateHTML(data, sheetNames, options, libs) {\r\n    const parts = [];\r\n    parts.push(`<!DOCTYPE html><html lang='en' data-bs-theme='light'>`);\r\n    parts.push(\"<head><meta charset='UTF-8'><title>DataVista Report</title>\");\r\n\r\n    // 1. CSS\r\n    parts.push(`<style>${libs.css || \"\"}</style>`);\r\n\r\n    // 2. Custom CSS - STRICT FIT TO SCREEN\r\n    parts.push(`<style>\r\n        :root { --header-bg: #3c6ea9; --header-text: white; }\r\n        [data-bs-theme=\"dark\"] { --header-bg: #1f2937; }\r\n\r\n        html { scroll-behavior: smooth; }\r\n        body { \r\n            background-color: var(--bs-body-bg); \r\n            color: var(--bs-body-color); \r\n            font-family: 'Segoe UI', sans-serif; \r\n            overflow-x: hidden; /* Prevent body scroll */\r\n            width: 100vw;\r\n        }\r\n        \r\n        /* Header Container */\r\n        .dv-header {\r\n            background-color: var(--header-bg); color: var(--header-text);\r\n            padding: 12px 2rem; display: flex; justify-content: space-between; align-items: center;\r\n            box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 1.5rem; gap: 2rem;\r\n        }\r\n        [data-bs-theme=\"dark\"] .dv-header { background-color: var(--header-bg-dark); }\r\n\r\n        .dv-brand { font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; gap: 8px; }\r\n        .dv-meta { font-size: 0.75rem; opacity: 0.7; margin-top: 2px; }\r\n        \r\n        /* Navigation */\r\n        .dv-header-tabs .nav-link { \r\n            border: none; color: rgba(255,255,255,0.7); background: transparent;\r\n            padding: 8px 16px; font-weight: 500; border-radius: 20px; transition: all 0.2s; font-size: 0.85rem;\r\n        }\r\n        .dv-header-tabs .nav-link.active { color: white; background: rgba(255,255,255,0.2); }\r\n        .theme-toggler { cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 0.8rem; border: 1px solid rgba(255,255,255,0.3); padding: 4px 10px; border-radius: 16px; }\r\n\r\n        .dv-container { padding: 0 20px 3rem 20px; max-width: 100vw; overflow-x: hidden; }\r\n\r\n        /* Card */\r\n        .dv-card { background: var(--bs-card-bg); border: 1px solid var(--bs-border-color); border-radius: 12px; padding: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.02); margin-bottom: 2rem; }\r\n\r\n        /* === PRECISION HEADER & FILTERS (v9.0) === */\r\n        .dv-table-wrapper { width: 100%; margin-bottom: 2rem; position: relative; }\r\n        \r\n        /* Header Styling */\r\n        table.dataTable thead tr:first-child th {\r\n            background: var(--bs-secondary-bg) !important;\r\n            padding: 12px 18px !important;\r\n            font-weight: 700 !important;\r\n            border-bottom: 2px solid var(--bs-border-color) !important;\r\n            vertical-align: middle !important;\r\n        }\r\n        \r\n        /* Filter Row Styling */\r\n        .filter-row th {\r\n            padding: 4px 10px !important;\r\n            background: var(--bs-body-bg) !important;\r\n            border-bottom: 1px solid var(--bs-border-color) !important;\r\n            line-height: 1 !important;\r\n        }\r\n        .filter-input {\r\n            width: 100%;\r\n            border: 1px solid var(--bs-border-color);\r\n            padding: 5px 10px;\r\n            font-size: 0.75rem;\r\n            border-radius: 6px;\r\n            outline: none;\r\n            transition: border-color 0.2s;\r\n        }\r\n        .filter-input:focus { border-color: #00bcd4; box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.1); }\r\n\r\n        /* SearchPanes Styling */\r\n        .dtsp-searchPanes { margin-bottom: 1.5rem; border: 1px solid var(--bs-border-color); border-radius: 8px; padding: 15px; background: var(--bs-body-bg); }\r\n        .dtsp-pane { border: none !important; }\r\n\r\n        /* Controls Row */\r\n        .dv-controls-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 12px; }\r\n        .dv-search-group { display: flex; align-items: center; gap: 15px; }\r\n        .dv-summary-stats { display: flex; gap: 10px; font-size: 0.85rem; color: var(--bs-secondary-color); border-right: 1px solid var(--bs-border-color); padding-right: 15px; }\r\n        .dv-stat-badge { background: var(--bs-secondary-bg); padding: 2px 8px; border-radius: 4px; font-weight: 600; color: var(--bs-primary); }\r\n\r\n        /* Navigator Bar Refinement */\r\n        .dv-header-tabs {\r\n            border-bottom: none !important;\r\n            justify-content: center;\r\n            gap: 5px;\r\n        }\r\n        .dv-header-tabs .nav-link {\r\n            border: none !important;\r\n            color: rgba(255,255,255,0.7) !important;\r\n            padding: 8px 20px !important;\r\n            border-radius: 20px !important;\r\n            font-weight: 500;\r\n            transition: all 0.3s;\r\n        }\r\n        .dv-header-tabs .nav-link:hover {\r\n            color: white !important;\r\n            background: rgba(255,255,255,0.1) !important;\r\n        }\r\n        .dv-header-tabs .nav-link.active {\r\n            color: white !important;\r\n            background: rgba(255,255,255,0.2) !important;\r\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n        }\r\n\r\n        /* Unified Button Group Styling (v11.0) */\r\n        .dt-buttons {\r\n            display: inline-flex !important;\r\n            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\r\n            border-radius: 8px;\r\n            overflow: hidden;\r\n            border: 1px solid var(--bs-border-color);\r\n        }\r\n        .btn-advanced-filters, .dt-button {\r\n            margin: 0 !important;\r\n            border: none !important;\r\n            border-radius: 0 !important;\r\n            padding: 8px 18px !important;\r\n            font-size: 0.85rem !important;\r\n            height: 38px;\r\n            display: flex;\r\n            align-items: center;\r\n            font-weight: 500 !important;\r\n            transition: all 0.2s !important;\r\n        }\r\n        .btn-advanced-filters {\r\n            background-color: #00bcd4 !important;\r\n            color: white !important;\r\n            border-right: 1px solid rgba(0,0,0,0.1) !important;\r\n        }\r\n        .dt-button {\r\n            background-color: #6c757d !important;\r\n            color: white !important;\r\n            border-right: 1px solid rgba(255,255,255,0.1) !important;\r\n        }\r\n        .dt-button:last-child { border-right: none !important; }\r\n        .dt-button:hover { background-color: #5a6268 !important; transform: none !important; }\r\n        .btn-advanced-filters:hover { background-color: #00acc1 !important; transform: none !important; }\r\n\r\n        .dataTables_scrollBody { border: 1px solid var(--bs-border-color); border-radius: 0 0 8px 8px; }\r\n        .dataTables_scrollHead { border: 1px solid var(--bs-border-color); border-bottom: none; border-radius: 8px 8px 0 0; background: var(--bs-secondary-bg); }\r\n\r\n        table.dataTable { width: 100% !important; margin: 0 !important; table-layout: auto !important; border-collapse: collapse !important; }\r\n        table.dataTable th, table.dataTable td { \r\n            white-space: nowrap !important; \r\n            vertical-align: middle; \r\n            padding: 12px 18px !important; \r\n            font-size: inherit; \r\n            min-width: 120px; \r\n        }\r\n\r\n        /* RICH FORMATTING */\r\n        .dv-pos { color: #28a745 !important; font-weight: 600; }\r\n        .dv-neg { color: #dc3545 !important; font-weight: 600; }\r\n        .dv-bar-cell { position: relative; z-index: 1; }\r\n        .dv-bar { position: absolute; top: 2px; bottom: 2px; left: 0; background: rgba(0, 188, 212, 0.15); z-index: -1; }\r\n    </style>`);\r\n\r\n    parts.push(\"</head><body>\");\r\n\r\n    const timestamp = new Date().toLocaleString();\r\n    const sheetName = sheetNames.length > 0 ? sheetNames[0] : \"Report\";\r\n    parts.push(`\r\n    <div class=\"dv-header\">\r\n        <div>\r\n            <div class=\"dv-brand\">\r\n                <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" viewBox=\"0 0 24 24\"><path d=\"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"/></svg>\r\n                DataVista <span style=\"opacity: 0.6; margin: 0 8px;\">|</span> ${sheetName}\r\n            </div>\r\n            <div class=\"dv-meta\">Generated: ${timestamp} &bull; v11.0 (Precision Alignment)</div>\r\n        </div>\r\n        <ul class=\"nav nav-tabs dv-header-tabs\" role=\"tablist\">\r\n            <li class=\"nav-item\"><a class=\"nav-link active\" data-bs-toggle=\"tab\" href=\"#page-data\">Data</a></li>\r\n            ${options.info ? '<li class=\"nav-item\"><a class=\"nav-link\" data-bs-toggle=\"tab\" href=\"#page-info\">Info</a></li>' : ''}\r\n            ${options.stats ? '<li class=\"nav-item\"><a class=\"nav-link\" data-bs-toggle=\"tab\" href=\"#page-stats\">Stats</a></li>' : ''}\r\n        </ul>\r\n        <div class=\"theme-toggler\" onclick=\"document.documentElement.setAttribute('data-bs-theme', document.documentElement.getAttribute('data-bs-theme')==='dark'?'light':'dark')\">\r\n            <span>Theme</span>\r\n        </div>\r\n    </div>\r\n    `);\r\n\r\n    parts.push(`<div class=\"container-fluid dv-container\">`);\r\n    parts.push(`<div class=\"tab-content dv-tab-content\">`);\r\n\r\n    // --- DATA PAGE ---\r\n    parts.push(`<div id=\"page-data\" class=\"tab-pane fade show active\">`);\r\n    sheetNames.forEach((name, i) => {\r\n        const rows = data[name];\r\n        const hasHeader = rows.length > 0;\r\n        const header = hasHeader ? rows[0] : [];\r\n        // v11.0: Aggressive row cleaning (removes any rows with only whitespace/nulls)\r\n        const body = hasHeader ? rows.slice(1).filter(r => r.some(c => c !== null && c !== undefined && c.toString().trim() !== \"\")) : [];\r\n        const colCount = header.length;\r\n\r\n        // Dynamic Font Scaling Logic (v10.0 Refined)\r\n        // Baseline: 1.0rem for < 6 cols\r\n        // Reduce by 0.04rem for each col above 6\r\n        // Min: 0.75rem (Improved readability)\r\n        let fontSizeVal = 1.0;\r\n        if (colCount > 6) {\r\n            fontSizeVal = Math.max(0.75, 1.0 - ((colCount - 6) * 0.04));\r\n        }\r\n        const fontSizeStr = fontSizeVal.toFixed(2) + \"rem\";\r\n\r\n        parts.push(`<div class=\"dv-sheet-section\"><div class=\"dv-card\">`);\r\n        parts.push(`<div class=\"dv-table-wrapper\">`); // Main wrapper for DataTables\r\n\r\n        // Explicit style injection for font size\r\n        parts.push(`<table class=\"table table-hover display table-bordered\" style=\"width:100% !important; font-size:${fontSizeStr};\">`);\r\n        parts.push(`<thead>`);\r\n\r\n        // Row 1: Titles\r\n        parts.push(`<tr>`);\r\n        header.forEach((h) => parts.push(`<th>${h}</th>`));\r\n        parts.push(`</tr>`);\r\n\r\n        // Row 2: Filters\r\n        parts.push(`<tr class=\"filter-row\">`);\r\n        header.forEach(() => parts.push(`<th></th>`));\r\n        parts.push(`</tr>`);\r\n\r\n        parts.push(`</thead><tbody>`);\r\n\r\n        body.forEach(row => {\r\n            parts.push(`<tr>`);\r\n            row.forEach((cell) => {\r\n                parts.push(`<td>${cell || \"\"}</td>`);\r\n            });\r\n            parts.push(`</tr>`);\r\n        });\r\n        parts.push(`</tbody></table></div></div></div>`);\r\n    });\r\n    parts.push(`</div>`); // End Data Page\r\n\r\n    // --- INFO & STATS PAGES (Simplified) ---\r\n    if (options.info) {\r\n        parts.push(`<div id=\"page-info\" class=\"tab-pane fade\"><div class=\"dv-card\"><h5>Dataset Info</h5><div class=\"alert alert-info\">Generated via DataVista Engine v3.0</div></div></div>`);\r\n    }\r\n    if (options.stats) {\r\n        parts.push(`<div id=\"page-stats\" class=\"tab-pane fade\"><div class=\"dv-card\"><h5>Statistics</h5><p>Statistics module initialized.</p></div></div>`);\r\n    }\r\n\r\n    parts.push(`</div></div>`); // End Container\r\n\r\n    // SearchBuilder Modal\r\n    parts.push(`\r\n    <div class=\"modal fade\" id=\"searchBuilderModal\" tabindex=\"-1\"><div class=\"modal-dialog modal-xl\"><div class=\"modal-content\"><div class=\"modal-body\" id=\"sb-modal-body\"></div></div></div></div>\r\n    `);\r\n\r\n    // Scripts\r\n    parts.push(`<script>${libs.js || \"\"}</script>`);\r\n    parts.push(`<script>\r\n    $(document).ready(function() {\r\n        $('table.display').each(function() {\r\n            var table = $(this);\r\n            // Initialize DataTable with STRICT options\r\n            table.DataTable({\r\n                dom: 'P<\"dv-controls-row\"B<\"dv-search-group\"f>>t<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\r\n                orderCellsTop: true, // Use first row for sorting\r\n                searchPanes: {\r\n                    cascadePanes: true,\r\n                    viewTotal: true,\r\n                    layout: 'columns-3'\r\n                },\r\n                autoWidth: false,\r\n                scrollX: true,\r\n                scrollCollapse: true,\r\n                paging: true,\r\n                pageLength: 20,\r\n                rowCallback: function(row, data) {\r\n                    // v10.0: Numeric Conditional Coloring\r\n                    $('td', row).each(function() {\r\n                        var text = $(this).text().trim();\r\n                        var val = parseFloat(text.replace(/[^0-9.-]+/g, \"\"));\r\n                        if (!isNaN(val) && !text.includes('/') && !text.includes('-20') && text.length < 15) {\r\n                            if (val > 0) $(this).addClass('dv-pos');\r\n                            else if (val < 0) $(this).addClass('dv-neg');\r\n                        }\r\n                    });\r\n                },\r\n                buttons: [\r\n                    {\r\n                        text: 'Advanced Filters',\r\n                        className: 'btn-advanced-filters',\r\n                        action: function (e, dt) {\r\n                            $('#sb-modal-body').empty();\r\n                            var sb = new $.fn.dataTable.SearchBuilder(dt, {});\r\n                            $('#sb-modal-body').append(sb.getNode());\r\n                            $('#searchBuilderModal').modal('show');\r\n                        }\r\n                    },\r\n                    'copy', 'csv', 'excel', 'pdf', 'print', 'colvis'\r\n                ],\r\n                initComplete: function () {\r\n                    var api = this.api();\r\n                    \r\n                    // Add Row/Col Counts\r\n                    var rowCount = api.rows().count();\r\n                    var colCount = api.columns().count();\r\n                    var statsHtml = \\`\r\n                        <div class=\"dv-summary-stats\">\r\n                            <span>Total Rows: <span class=\"dv-stat-badge\">\\${rowCount}</span></span>\r\n                            <span>Total Columns: <span class=\"dv-stat-badge\">\\${colCount}</span></span>\r\n                        </div>\r\n                    \\`;\r\n                    $('.dv-search-group').prepend(statsHtml);\r\n\r\n                    // Inject filters into the SECOND header row\r\n                    $(api.table().header()).find('tr.filter-row th').each(function (colIdx) {\r\n                        $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" />')\r\n                            .appendTo(this)\r\n                            .on('keyup change', function (e) { \r\n                                e.stopPropagation();\r\n                                api.column(colIdx).search(this.value).draw(); \r\n                            });\r\n                    });\r\n                    \r\n                    setTimeout(function() { api.columns.adjust(); }, 150);\r\n                }\r\n            });\r\n        });\r\n    });\r\n    </script>`);\r\n\r\n    parts.push(\"</body></html>\");\r\n    return new Blob(parts, { type: \"text/html\" });\r\n}\r\n","/* global console */\r\n\r\n// Function to generate the HTML content for the Entire Workbook (Dashboard/Index Style)\r\nexport function generateWorkbookHTML(data, sheetNames, options, libs) {\r\n    const timestamp = new Date().toLocaleString();\r\n    const workbookName = options.workbookName || \"Workbook\";\r\n\r\n    // 1. CSS & Styles (Reusing Strict Core Styles)\r\n    const styles = `\r\n    <style>\r\n        :root {\r\n            --bs-body-bg: #ffffff;\r\n            --bs-body-color: #212529;\r\n            --bs-primary: #0d6efd;\r\n            --bs-border-color: #dee2e6;\r\n            --dv-header-bg: #f8f9fa;\r\n        }\r\n        [data-bs-theme=\"dark\"] {\r\n            --bs-body-bg: #212529;\r\n            --bs-body-color: #f8f9fa;\r\n            --bs-border-color: #495057;\r\n            --dv-header-bg: #2c3034;\r\n        }\r\n        body { \r\n            font-family: 'Segoe UI', sans-serif; \r\n            margin: 0; padding: 0; \r\n            background-color: var(--bs-body-bg); color: var(--bs-body-color);\r\n            overflow-x: hidden; \r\n            width: 100vw;\r\n        }\r\n        \r\n        /* Dashboard Styles */\r\n        .dashboard-container { max-width: 1200px; margin: 50px auto; text-align: center; }\r\n        .dashboard-title { font-size: 2.5rem; font-weight: 300; margin-bottom: 10px; }\r\n        .dashboard-meta { color: gray; }\r\n        \r\n        .sheet-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px; }\r\n        .sheet-card {\r\n            background: var(--bs-body-bg);\r\n            border: 1px solid var(--bs-border-color);\r\n            border-radius: 8px;\r\n            padding: 30px;\r\n            cursor: pointer;\r\n            transition: transform 0.2s;\r\n            width: 280px;\r\n        }\r\n        .sheet-card:hover { transform: translateY(-5px); border-color: var(--bs-primary); }\r\n        .sheet-name { font-size: 1.2rem; font-weight: 500; margin-top: 15px; }\r\n\r\n        /* Sheet View Styles */\r\n        .view-section { display: none; padding-top: 0; }\r\n        .view-section.active { display: block; }\r\n\r\n        .sheet-header {\r\n            display: flex; align-items: center; justify-content: space-between;\r\n            background: var(--dv-header-bg); padding: 10px 20px;\r\n            border-bottom: 1px solid var(--bs-border-color); margin-bottom: 20px;\r\n        }\r\n        .btn-back { cursor: pointer; font-weight: 600; text-decoration: none; color: inherit; display: flex; align-items: center; gap: 5px; }\r\n\r\n        /* === PRECISION HEADER & FILTERS (v9.0) === */\r\n        .dv-table-wrapper { width: 100%; margin-bottom: 2rem; position: relative; }\r\n        \r\n        /* Header Styling */\r\n        table.dataTable thead tr:first-child th {\r\n            background: var(--dv-header-bg) !important;\r\n            padding: 12px 18px !important;\r\n            font-weight: 700 !important;\r\n            border-bottom: 2px solid var(--bs-border-color) !important;\r\n            vertical-align: middle !important;\r\n        }\r\n        \r\n        /* Filter Row Styling */\r\n        .filter-row th {\r\n            padding: 4px 10px !important;\r\n            background: var(--bs-body-bg) !important;\r\n            border-bottom: 1px solid var(--bs-border-color) !important;\r\n            line-height: 1 !important;\r\n        }\r\n\r\n        .filter-input { width: 100%; border: 1px solid var(--bs-border-color); padding: 5px 10px; font-size: 0.75rem; border-radius: 6px; outline: none; transition: border-color 0.2s; }\r\n        .filter-input:focus { border-color: #00bcd4; box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.1); }\r\n\r\n        /* SearchPanes Styling */\r\n        .dtsp-searchPanes { margin-bottom: 1.5rem; border: 1px solid var(--bs-border-color); border-radius: 8px; padding: 15px; background: var(--bs-body-bg); }\r\n\r\n        .dv-controls-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 12px; }\r\n        .dv-search-group { display: flex; align-items: center; gap: 15px; }\r\n        .dv-summary-stats { display: flex; gap: 10px; font-size: 0.85rem; color: var(--bs-secondary-color); border-right: 1px solid var(--bs-border-color); padding-right: 15px; }\r\n        .dv-stat-badge { background: var(--bs-secondary-bg); padding: 2px 8px; border-radius: 4px; font-weight: 600; color: var(--dv-primary); }\r\n\r\n        /* Unified Button Group Styling (v11.0) */\r\n        .dt-buttons {\r\n            display: inline-flex !important;\r\n            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\r\n            border-radius: 8px;\r\n            overflow: hidden;\r\n            border: 1px solid var(--bs-border-color);\r\n        }\r\n        .btn-advanced-filters, .dt-button {\r\n            margin: 0 !important;\r\n            border: none !important;\r\n            border-radius: 0 !important;\r\n            padding: 8px 18px !important;\r\n            font-size: 0.85rem !important;\r\n            height: 38px;\r\n            display: flex;\r\n            align-items: center;\r\n            font-weight: 500 !important;\r\n            transition: all 0.2s !important;\r\n        }\r\n        .btn-advanced-filters {\r\n            background-color: #00bcd4 !important;\r\n            color: white !important;\r\n            border-right: 1px solid rgba(0,0,0,0.1) !important;\r\n        }\r\n        .dt-button {\r\n            background-color: #6c757d !important;\r\n            color: white !important;\r\n            border-right: 1px solid rgba(255,255,255,0.1) !important;\r\n        }\r\n        .dt-button:last-child { border-right: none !important; }\r\n        .dt-button:hover { background-color: #5a6268 !important; }\r\n        .btn-advanced-filters:hover { background-color: #00acc1 !important; }\r\n\r\n        .dataTables_scrollBody { border: 1px solid var(--bs-border-color); border-radius: 0 0 8px 8px; }\r\n        .dataTables_scrollHead { border: 1px solid var(--bs-border-color); border-bottom: none; border-radius: 8px 8px 0 0; background: var(--dv-header-bg); }\r\n\r\n        table.dataTable { width: 100% !important; margin: 0 !important; table-layout: auto !important; border-collapse: collapse !important; }\r\n        table.dataTable th, table.dataTable td { white-space: nowrap !important; vertical-align: middle; padding: 12px 18px !important; border: 1px solid var(--bs-border-color); min-width: 120px; }\r\n\r\n        .filter-input { width: 100%; border: 1px solid var(--bs-border-color); padding: 2px; font-size: 0.75rem; border-radius: 3px; }\r\n        .dataTables_paginate { display: flex; justify-content: flex-end; margin-top: 10px; font-size: 0.8rem; }\r\n        \r\n        /* RICH FORMATTING */\r\n        .dv-pos { color: #28a745 !important; font-weight: 600; }\r\n        .dv-neg { color: #dc3545 !important; font-weight: 600; }\r\n    </style>\r\n    <style>${libs.css || \"\"}</style>\r\n    `;\r\n\r\n    const parts = [];\r\n    parts.push(`<!DOCTYPE html><html lang=\"en\" data-bs-theme=\"light\"><head><meta charset=\"UTF-8\"><title>${workbookName}</title>${styles}</head><body>`);\r\n\r\n    // --- 1. DASHBOARD OVERVIEW ---\r\n    parts.push(`\r\n    <div id=\"dashboard-view\" class=\"view-section active\">\r\n        <div class=\"dashboard-container\">\r\n            <div class=\"dashboard-header\">\r\n                <div style=\"font-size: 1.5rem; font-weight: bold; margin-bottom: 20px;\">\r\n                    <img src=\"https://Harry-0402.github.io/DataVista/assets/icon-32.png\" width=\"32\" height=\"32\" style=\"margin-right: 10px;\">\r\n                    DataVista Report\r\n                </div>\r\n                <h1 class=\"dashboard-title\">${workbookName}</h1>\r\n                <p class=\"dashboard-meta\">Generated on ${timestamp} &bull; ${sheetNames.length} Sheets &bull; v11.0 (Precision Alignment)</p>\r\n            </div>\r\n            <div class=\"sheet-grid\">\r\n    `);\r\n\r\n    sheetNames.forEach((name, index) => {\r\n        parts.push(`\r\n        <div class=\"sheet-card\" onclick=\"showSheet('${index}')\">\r\n            <svg width=\"40\" height=\"40\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"></path></svg>\r\n            <div class=\"sheet-name\">${name}</div>\r\n        </div>\r\n        `);\r\n    });\r\n    parts.push(`</div></div></div>`);\r\n\r\n    // --- 2. INDIVIDUAL SHEET VIEWS ---\r\n    sheetNames.forEach((name, index) => {\r\n        const rows = data[name];\r\n        const header = rows.length > 0 ? rows[0] : [];\r\n        // v11.0: Aggressive row cleaning\r\n        const body = rows.length > 0 ? rows.slice(1).filter(r => r.some(c => c !== null && c !== undefined && c.toString().trim() !== \"\")) : [];\r\n\r\n        // Dynamic Font Scaling (v10.0 Refined)\r\n        const colCount = header.length;\r\n        let fontSizeVal = 1.0;\r\n        if (colCount > 6) {\r\n            fontSizeVal = Math.max(0.75, 1.0 - ((colCount - 6) * 0.04));\r\n        }\r\n        const fontSizeStr = fontSizeVal.toFixed(2) + \"rem\";\r\n\r\n        parts.push(`\r\n        <div id=\"sheet-view-${index}\" class=\"view-section\">\r\n            <div class=\"sheet-header\">\r\n                <a class=\"btn-back\" onclick=\"showDashboard()\">\r\n                    <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" viewBox=\"0 0 24 24\"><path d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/></svg>\r\n                    Back to Dashboard\r\n                </a>\r\n                <div style=\"font-weight: bold;\">${name}</div>\r\n                <div onclick=\"document.documentElement.setAttribute('data-bs-theme', document.documentElement.getAttribute('data-bs-theme')==='dark'?'light':'dark')\" style=\"cursor: pointer;\">Theme</div>\r\n            </div>\r\n            <div class=\"container-fluid\" style=\"padding: 0 20px;\">\r\n                <div class=\"dv-table-wrapper\">\r\n                    <table class=\"table table-striped table-hover display table-bordered\" style=\"width:100% !important; font-size:${fontSizeStr};\">\r\n                        <thead>\r\n                            <tr>${header.map(h => `<th>${h || \"\"}</th>`).join('')}</tr>\r\n                            <tr class=\"filter-row\">${header.map(() => `<th></th>`).join('')}</tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            ${body.map(r => `<tr>${r.map(c => `<td>${c || \"\"}</td>`).join('')}</tr>`).join('')}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        `);\r\n    });\r\n\r\n    parts.push(`\r\n    <div class=\"modal fade\" id=\"searchBuilderModal\" tabindex=\"-1\"><div class=\"modal-dialog modal-xl\"><div class=\"modal-content\"><div class=\"modal-body\" id=\"sb-modal-body\"></div></div></div></div>\r\n    `);\r\n\r\n    // --- 3. SCRIPTS ---\r\n    parts.push(`<script>${libs.js || \"\"}</script>`);\r\n    parts.push(`<script>\r\n    function showDashboard() { $('.view-section').removeClass('active'); $('#dashboard-view').addClass('active'); }\r\n    function showSheet(index) { \r\n        $('.view-section').removeClass('active'); \r\n        $('#sheet-view-' + index).addClass('active'); \r\n        $.fn.dataTable.tables({ visible: true, api: true }).columns.adjust();\r\n    }\r\n\r\n    $(document).ready(function() {\r\n        $('table.display').each(function() {\r\n            var table = $(this);\r\n            table.DataTable({\r\n                dom: 'P<\"dv-controls-row\"B<\"dv-search-group\"f>>t<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\r\n                orderCellsTop: true,\r\n                searchPanes: {\r\n                    cascadePanes: true,\r\n                    viewTotal: true,\r\n                    layout: 'columns-3'\r\n                },\r\n                autoWidth: false,\r\n                scrollX: true,\r\n                scrollCollapse: true,\r\n                pageLength: 20,\r\n                rowCallback: function(row, data) {\r\n                    // v10.0: Numeric Conditional Coloring\r\n                    $('td', row).each(function() {\r\n                        var text = $(this).text().trim();\r\n                        var val = parseFloat(text.replace(/[^0-9.-]+/g, \"\"));\r\n                        if (!isNaN(val) && !text.includes('/') && !text.includes('-20') && text.length < 15) {\r\n                            if (val > 0) $(this).addClass('dv-pos');\r\n                            else if (val < 0) $(this).addClass('dv-neg');\r\n                        }\r\n                    });\r\n                },\r\n                buttons: [\r\n                    {\r\n                        text: 'Advanced Filters',\r\n                        className: 'btn-advanced-filters',\r\n                        action: function (e, dt) {\r\n                            $('#sb-modal-body').empty();\r\n                            var sb = new $.fn.dataTable.SearchBuilder(dt, {});\r\n                            $('#sb-modal-body').append(sb.getNode());\r\n                            $('#searchBuilderModal').modal('show');\r\n                        }\r\n                    },\r\n                    'copy', 'csv', 'excel', 'pdf', 'print', 'colvis'\r\n                ],\r\n                initComplete: function() {\r\n                    var api = this.api();\r\n\r\n                    // Add Row/Col Counts\r\n                    var rowCount = api.rows().count();\r\n                    var colCount = api.columns().count();\r\n                    var statsHtml = \\`\r\n                        <div class=\"dv-summary-stats\">\r\n                            <span>Total Rows: <span class=\"dv-stat-badge\">\\${rowCount}</span></span>\r\n                            <span>Total Columns: <span class=\"dv-stat-badge\">\\${colCount}</span></span>\r\n                        </div>\r\n                    \\`;\r\n                    $(this).closest('.dv-table-wrapper').find('.dv-search-group').prepend(statsHtml);\r\n\r\n                    // Inject filters into the SECOND header row\r\n                    $(api.table().header()).find('tr.filter-row th').each(function (colIdx) {\r\n                        $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" />')\r\n                            .appendTo(this)\r\n                            .on('keyup change', function (e) { \r\n                                e.stopPropagation();\r\n                                api.column(colIdx).search(this.value).draw(); \r\n                            });\r\n                    });\r\n                    \r\n                    setTimeout(function() { api.columns.adjust(); }, 150);\r\n                }\r\n            });\r\n        });\r\n    });\r\n    </script></body></html>`);\r\n\r\n    return new Blob([parts.join(\"\")], { type: \"text/html\" });\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\nimport { trimEmptyGrid } from \"../utils/data-utils\";\r\nimport { generateHTML } from \"../taskpane/generators\";\r\nimport { generateWorkbookHTML } from \"../taskpane/workbook_generators\";\r\n\r\n// Define library URLs for offline bundling (Same as taskpane.js)\r\nconst LIB_URLS = {\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\",\r\n    searchpanes_css: \"https://cdn.datatables.net/searchpanes/2.2.0/css/searchPanes.bootstrap5.min.css\",\r\n    searchpanes_js: \"https://cdn.datatables.net/searchpanes/2.2.0/js/dataTables.searchPanes.min.js\",\r\n    searchpanes_bs5_js: \"https://cdn.datatables.net/searchpanes/2.2.0/js/searchPanes.bootstrap5.min.js\",\r\n    select_css: \"https://cdn.datatables.net/select/1.7.0/css/select.bootstrap5.min.css\",\r\n    select_js: \"https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js\"\r\n};\r\n\r\nOffice.onReady(() => {\r\n    // If needed, Office.js is ready to be called\r\n});\r\n\r\n/**\r\n * Exports the currently selected range.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportSelection(event) {\r\n    await runHeadlessExport(\"selection\", event);\r\n}\r\n\r\n/**\r\n * Exports the entire workbook.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportWorkbook(event) {\r\n    await runHeadlessExport(\"workbook\", event);\r\n}\r\n\r\nasync function runHeadlessExport(source, event) {\r\n    try {\r\n        // Show a \"working\" indicator (not really possible without UI, but we can prevent timeout)\r\n        // Default Options\r\n        const options = {\r\n            stats: true,\r\n            info: true,\r\n            desc: true,\r\n            rich: true,\r\n            workbookName: \"Report\"\r\n        };\r\n\r\n        let data = {};\r\n        let sheetNames = [];\r\n\r\n        await Excel.run(async (context) => {\r\n            const workbook = context.workbook;\r\n            workbook.load(\"name\");\r\n            await context.sync();\r\n            options.workbookName = workbook.name || \"Report\";\r\n\r\n            if (source === \"selection\") {\r\n                const range = context.workbook.getSelectedRange();\r\n                range.load(\"values\");\r\n                await context.sync();\r\n\r\n                // Trim empty\r\n                const trimmed = trimEmptyGrid(range.values);\r\n                if (!trimmed) throw new Error(\"Selection is empty\");\r\n\r\n                data[\"Selection\"] = trimmed;\r\n                sheetNames.push(\"Selection\");\r\n            } else {\r\n                const sheets = context.workbook.worksheets;\r\n                sheets.load(\"items/name\");\r\n                await context.sync();\r\n\r\n                const sheetRanges = sheets.items.map(sheet => {\r\n                    const rng = sheet.getUsedRangeOrNullObject();\r\n                    rng.load(\"values, rowCount\");\r\n                    return { name: sheet.name, rng: rng };\r\n                });\r\n                await context.sync();\r\n\r\n                for (let item of sheetRanges) {\r\n                    if (!item.rng.isNullObject && item.rng.rowCount > 0) {\r\n                        const trimmed = trimEmptyGrid(item.rng.values);\r\n                        if (trimmed) {\r\n                            data[item.name] = trimmed;\r\n                            sheetNames.push(item.name);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        if (sheetNames.length === 0) throw new Error(\"No data found.\");\r\n\r\n        // Fetch Libs\r\n        const libs = await fetchOfflineLibs();\r\n\r\n        let blob;\r\n        if (source === \"workbook\") {\r\n            blob = generateWorkbookHTML(data, sheetNames, options, libs); // From workbook_generators.js\r\n        } else {\r\n            blob = generateHTML(data, sheetNames, options, libs); // From generators.js\r\n        }\r\n\r\n        // Trigger Download\r\n        const url = URL.createObjectURL(blob);\r\n\r\n        // In FunctionFile, we have a hidden DOM. Creating an anchor usually works.\r\n        const a = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = `DataVista_${options.workbookName}_${new Date().getTime()}.html`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n\r\n        // Success Notification?\r\n        // Office.context.ui.displayDialogAsync is only for opening windows.\r\n        // We assume download started.\r\n\r\n    } catch (error) {\r\n        console.error(error);\r\n        // If error, show a dialog? Or just silent fail?\r\n        // Since we are headless, we can't show alerts easily unless we use displayDialogAsync\r\n    } finally {\r\n        event.completed();\r\n    }\r\n}\r\n\r\nasync function fetchOfflineLibs() {\r\n    const urls = LIB_URLS;\r\n    const load = async (url) => {\r\n        try {\r\n            const r = await fetch(url);\r\n            if (!r.ok) throw new Error(url);\r\n            return await r.text();\r\n        } catch (e) {\r\n            return `/* Failed: ${url} */`;\r\n        }\r\n    };\r\n\r\n    const cssKeys = ['bootstrap_css', 'datatables_css', 'buttons_css', 'searchbuilder_css', 'dateTime_css'];\r\n    const jsKeys = [\r\n        'jquery', 'bootstrap_js', 'datatables_js', 'datatables_bs5_js',\r\n        'jszip', 'pdfmake', 'vfs_fonts',\r\n        'buttons_js', 'buttons_bs5_js', 'buttons_colvis_js', 'buttons_html5_js', 'buttons_print_js',\r\n        'dateTime_js', 'searchbuilder_js', 'searchbuilder_bs5_js'\r\n    ];\r\n\r\n    const [cssArr, jsArr] = await Promise.all([\r\n        Promise.all(cssKeys.map(k => load(urls[k]))),\r\n        Promise.all(jsKeys.map(k => load(urls[k])))\r\n    ]);\r\n\r\n    return {\r\n        css: cssArr.join(\"\\n\"),\r\n        js: jsArr.join(\"\\n\")\r\n    };\r\n}\r\n\r\nconst g = getGlobal();\r\ng.exportSelection = exportSelection;\r\ng.exportWorkbook = exportWorkbook;\r\n\r\nfunction getGlobal() {\r\n    return typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : typeof global !== \"undefined\" ? global : undefined;\r\n}\r\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();"],"names":["__webpack_require__","trimEmptyGrid","data","length","minRow","maxRow","minCol","maxCol","r","c","val","trimmed","push","slice","generateHTML","sheetNames","options","libs","parts","concat","css","timestamp","Date","toLocaleString","sheetName","info","stats","forEach","name","i","rows","hasHeader","header","body","filter","some","toString","trim","colCount","fontSizeVal","Math","max","fontSizeStr","toFixed","h","row","cell","js","Blob","type","generateWorkbookHTML","workbookName","styles","index","map","join","e","t","Symbol","n","iterator","o","toStringTag","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","g","globalThis","this","Function","window","LIB_URLS","bootstrap_css","datatables_css","buttons_css","searchbuilder_css","dateTime_css","searchpanes_css","select_css","jquery","bootstrap_js","datatables_js","datatables_bs5_js","jszip","pdfmake","vfs_fonts","buttons_js","buttons_bs5_js","buttons_colvis_js","buttons_html5_js","buttons_print_js","dateTime_js","searchbuilder_js","searchbuilder_bs5_js","searchpanes_js","searchpanes_bs5_js","select_js","_exportSelection","_callee","event","_context","runHeadlessExport","_exportWorkbook","_callee2","_context2","_x3","_x4","_runHeadlessExport","_callee4","source","blob","url","_t","_context4","desc","rich","Excel","run","_ref","_callee3","context","workbook","range","sheets","sheetRanges","_iterator","_step","item","_trimmed","_context3","load","sync","getSelectedRange","values","Error","worksheets","items","sheet","rng","getUsedRangeOrNullObject","_createForOfIteratorHelper","s","isNullObject","rowCount","err","_x5","fetchOfflineLibs","URL","createObjectURL","document","createElement","href","download","getTime","appendChild","click","removeChild","console","error","completed","_fetchOfflineLibs","_callee6","urls","cssKeys","jsKeys","_yield$Promise$all","_yield$Promise$all2","cssArr","jsArr","_context6","_ref2","_callee5","_context5","fetch","ok","text","_x6","all","k","_slicedToArray","Office","onReady","self","global","undefined","exportSelection","_x","exportWorkbook","_x2"],"ignoreList":[],"sourceRoot":""}