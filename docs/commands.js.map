{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://datavista-excel-addin/webpack/bootstrap","webpack://datavista-excel-addin/./src/commands/commands.js","webpack://datavista-excel-addin/webpack/runtime/global"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\n// Define library URLs for offline bundling (Same as taskpane.js)\r\nconst LIB_URLS = {\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\"\r\n};\r\n\r\nOffice.onReady(() => {\r\n    // If needed, Office.js is ready to be called\r\n});\r\n\r\n/**\r\n * Exports the currently selected range.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportSelection(event) {\r\n    await runHeadlessExport(\"selection\", event);\r\n}\r\n\r\n/**\r\n * Exports the entire workbook.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportWorkbook(event) {\r\n    await runHeadlessExport(\"workbook\", event);\r\n}\r\n\r\nasync function runHeadlessExport(source, event) {\r\n    try {\r\n        // Show a \"working\" indicator (not really possible without UI, but we can prevent timeout)\r\n        // Default Options\r\n        const options = {\r\n            stats: true,\r\n            info: true,\r\n            desc: true,\r\n            rich: true,\r\n            workbookName: \"Report\"\r\n        };\r\n\r\n        let data = {};\r\n        let sheetNames = [];\r\n\r\n        await Excel.run(async (context) => {\r\n            const workbook = context.workbook;\r\n            workbook.load(\"name\");\r\n            await context.sync();\r\n            options.workbookName = workbook.name || \"Report\";\r\n\r\n            if (source === \"selection\") {\r\n                const range = context.workbook.getSelectedRange();\r\n                range.load(\"values\");\r\n                await context.sync();\r\n\r\n                if (!range.values || range.values.length === 0) throw new Error(\"Selection is empty\");\r\n                data[\"Selection\"] = range.values;\r\n                sheetNames.push(\"Selection\");\r\n            } else {\r\n                const sheets = context.workbook.worksheets;\r\n                sheets.load(\"items/name\");\r\n                await context.sync();\r\n\r\n                const sheetRanges = sheets.items.map(sheet => {\r\n                    const rng = sheet.getUsedRangeOrNullObject();\r\n                    rng.load(\"values, rowCount\");\r\n                    return { name: sheet.name, rng: rng };\r\n                });\r\n                await context.sync();\r\n\r\n                for (let item of sheetRanges) {\r\n                    if (!item.rng.isNullObject && item.rng.rowCount > 0) {\r\n                        data[item.name] = item.rng.values;\r\n                        sheetNames.push(item.name);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        if (sheetNames.length === 0) throw new Error(\"No data found.\");\r\n\r\n        // Fetch Libs\r\n        const libs = await fetchOfflineLibs();\r\n\r\n        let blob;\r\n        if (source === \"workbook\") {\r\n            blob = generateWorkbookHTML(data, sheetNames, options, libs); // From workbook_generators.js\r\n        } else {\r\n            blob = generateHTML(data, sheetNames, options, libs); // From generators.js\r\n        }\r\n\r\n        // Trigger Download\r\n        const url = URL.createObjectURL(blob);\r\n\r\n        // In FunctionFile, we have a hidden DOM. Creating an anchor usually works.\r\n        const a = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = `DataVista_${options.workbookName}_${new Date().getTime()}.html`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n\r\n        // Success Notification?\r\n        // Office.context.ui.displayDialogAsync is only for opening windows.\r\n        // We assume download started.\r\n\r\n    } catch (error) {\r\n        console.error(error);\r\n        // If error, show a dialog? Or just silent fail?\r\n        // Since we are headless, we can't show alerts easily unless we use displayDialogAsync\r\n    } finally {\r\n        event.completed();\r\n    }\r\n}\r\n\r\nasync function fetchOfflineLibs() {\r\n    const urls = LIB_URLS;\r\n    const load = async (url) => {\r\n        try {\r\n            const r = await fetch(url);\r\n            if (!r.ok) throw new Error(url);\r\n            return await r.text();\r\n        } catch (e) {\r\n            return `/* Failed: ${url} */`;\r\n        }\r\n    };\r\n\r\n    const cssKeys = ['bootstrap_css', 'datatables_css', 'buttons_css', 'searchbuilder_css', 'dateTime_css'];\r\n    const jsKeys = [\r\n        'jquery', 'bootstrap_js', 'datatables_js', 'datatables_bs5_js',\r\n        'jszip', 'pdfmake', 'vfs_fonts',\r\n        'buttons_js', 'buttons_bs5_js', 'buttons_colvis_js', 'buttons_html5_js', 'buttons_print_js',\r\n        'dateTime_js', 'searchbuilder_js', 'searchbuilder_bs5_js'\r\n    ];\r\n\r\n    const [cssArr, jsArr] = await Promise.all([\r\n        Promise.all(cssKeys.map(k => load(urls[k]))),\r\n        Promise.all(jsKeys.map(k => load(urls[k])))\r\n    ]);\r\n\r\n    return {\r\n        css: cssArr.join(\"\\n\"),\r\n        js: jsArr.join(\"\\n\")\r\n    };\r\n}\r\n\r\nconst g = getGlobal();\r\ng.exportSelection = exportSelection;\r\ng.exportWorkbook = exportWorkbook;\r\n\r\nfunction getGlobal() {\r\n    return typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : typeof global !== \"undefined\" ? global : undefined;\r\n}\r\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();"],"names":["__webpack_require__","e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","g","globalThis","this","Function","window","LIB_URLS","jquery","bootstrap_css","bootstrap_js","datatables_css","datatables_js","datatables_bs5_js","buttons_css","buttons_js","buttons_bs5_js","jszip","pdfmake","vfs_fonts","buttons_html5_js","buttons_print_js","buttons_colvis_js","searchbuilder_css","searchbuilder_js","searchbuilder_bs5_js","dateTime_css","dateTime_js","_exportSelection","_callee","event","_context","runHeadlessExport","_exportWorkbook","_callee2","_context2","_x3","_x4","_runHeadlessExport","_callee4","source","options","data","sheetNames","libs","blob","url","_t","_context4","stats","info","desc","rich","workbookName","Excel","run","_ref","_callee3","context","workbook","range","sheets","sheetRanges","_iterator","_step","item","_context3","load","sync","name","getSelectedRange","values","Error","push","worksheets","items","map","sheet","rng","getUsedRangeOrNullObject","_createForOfIteratorHelper","s","isNullObject","rowCount","err","_x5","fetchOfflineLibs","generateWorkbookHTML","generateHTML","URL","createObjectURL","document","createElement","href","download","concat","Date","getTime","body","appendChild","click","removeChild","console","error","completed","_fetchOfflineLibs","_callee6","urls","cssKeys","jsKeys","_yield$Promise$all","_yield$Promise$all2","cssArr","jsArr","_context6","_ref2","_callee5","_context5","fetch","ok","text","_x6","all","k","_slicedToArray","css","join","js","Office","onReady","self","global","undefined","exportSelection","_x","exportWorkbook","_x2"],"ignoreList":[],"sourceRoot":""}