{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://datavista-excel-addin/webpack/bootstrap","webpack://datavista-excel-addin/./src/utils/data-utils.js","webpack://datavista-excel-addin/./src/taskpane/generators.js","webpack://datavista-excel-addin/./src/taskpane/workbook_generators.js","webpack://datavista-excel-addin/./src/commands/commands.js","webpack://datavista-excel-addin/webpack/runtime/global"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","\r\n/**\r\n * Trims empty rows and columns from a 2D array.\r\n * @param {any[][]} data \r\n * @returns {any[][] | null} Trimmed data or null if empty\r\n */\r\nexport function trimEmptyGrid(data) {\r\n    if (!data || data.length === 0) return null;\r\n\r\n    let minRow = data.length;\r\n    let maxRow = -1;\r\n    let minCol = data[0].length;\r\n    let maxCol = -1;\r\n\r\n    // 1. Find Bounds\r\n    for (let r = 0; r < data.length; r++) {\r\n        for (let c = 0; c < data[r].length; c++) {\r\n            const val = data[r][c];\r\n            if (val !== \"\" && val !== null && val !== undefined) {\r\n                if (r < minRow) minRow = r;\r\n                if (r > maxRow) maxRow = r;\r\n                if (c < minCol) minCol = c;\r\n                if (c > maxCol) maxCol = c;\r\n            }\r\n        }\r\n    }\r\n\r\n    // 2. Check if empty\r\n    if (maxRow === -1) return null;\r\n\r\n    // 3. Slice\r\n    const trimmed = [];\r\n    for (let r = minRow; r <= maxRow; r++) {\r\n        trimmed.push(data[r].slice(minCol, maxCol + 1));\r\n    }\r\n\r\n    return trimmed;\r\n}\r\n","/* global Blob, window */\r\n// generators.js\r\n\r\nwindow.LIB_URLS = {\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n\r\n    // SearchBuilder & DateTime\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n\r\n    // JS Dependencies\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n\r\n    // DataTables Core & BS5\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n\r\n    // Export Dependencies\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n\r\n    // Extensions\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\"\r\n};\r\n\r\n/**\r\n * Main Generator Function\r\n * @param {Object} data - { \"Sheet1\": [[header, val], [val, val]] }\r\n * @param {string[]} sheetNames\r\n * @param {Object} options - { stats: bool, info: bool, desc: bool, rich: bool, workbookName: string }\r\n * @param {Object} libs - { css: string, js: string }\r\n */\r\nexport function generateHTML(data, sheetNames, options, libs) {\r\n    const parts = [];\r\n    parts.push(`<!DOCTYPE html><html lang='en' data-bs-theme='light'>`);\r\n    parts.push(\"<head><meta charset='UTF-8'><title>DataVista Report</title>\");\r\n\r\n    // 1. CSS\r\n    parts.push(`<style>${libs.css || \"\"}</style>`);\r\n\r\n    // 2. Custom CSS - STRICT FIT TO SCREEN\r\n    parts.push(`<style>\r\n        :root { --header-bg: #3c6ea9; --header-text: white; }\r\n        [data-bs-theme=\"dark\"] { --header-bg: #1f2937; }\r\n\r\n        html { scroll-behavior: smooth; }\r\n        body { \r\n            background-color: var(--bs-body-bg); \r\n            color: var(--bs-body-color); \r\n            font-family: 'Segoe UI', sans-serif; \r\n            overflow-x: hidden; /* Prevent body scroll */\r\n            width: 100vw;\r\n        }\r\n        \r\n        /* Header Container */\r\n        .dv-header {\r\n            background-color: var(--header-bg); color: var(--header-text);\r\n            padding: 12px 2rem; display: flex; justify-content: space-between; align-items: center;\r\n            box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 1.5rem; gap: 2rem;\r\n        }\r\n        [data-bs-theme=\"dark\"] .dv-header { background-color: var(--header-bg-dark); }\r\n\r\n        .dv-brand { font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; gap: 8px; }\r\n        .dv-meta { font-size: 0.75rem; opacity: 0.7; margin-top: 2px; }\r\n        \r\n        /* Navigation */\r\n        .dv-header-tabs .nav-link { \r\n            border: none; color: rgba(255,255,255,0.7); background: transparent;\r\n            padding: 8px 16px; font-weight: 500; border-radius: 20px; transition: all 0.2s; font-size: 0.85rem;\r\n        }\r\n        .dv-header-tabs .nav-link.active { color: white; background: rgba(255,255,255,0.2); }\r\n        .theme-toggler { cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 0.8rem; border: 1px solid rgba(255,255,255,0.3); padding: 4px 10px; border-radius: 16px; }\r\n\r\n        .dv-container { padding: 0 20px 3rem 20px; max-width: 100vw; overflow-x: hidden; }\r\n\r\n        /* Card */\r\n        .dv-card { background: var(--bs-card-bg); border: 1px solid var(--bs-border-color); border-radius: 12px; padding: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.02); margin-bottom: 2rem; }\r\n\r\n        /* === VISUAL PRECISION & FIXED CONTROLS (v6.0) === */\r\n        .dv-table-wrapper {\r\n            width: 100%;\r\n            margin-bottom: 2rem;\r\n            position: relative;\r\n        }\r\n\r\n        /* Buttons & Search Row */\r\n        .dv-controls-row {\r\n            display: flex;\r\n            justify-content: space-between;\r\n            align-items: center;\r\n            margin-bottom: 1rem;\r\n            flex-wrap: wrap;\r\n            gap: 10px;\r\n        }\r\n\r\n        /* Teal Advanced Filters Button */\r\n        .btn-advanced-filters {\r\n            background-color: #00bcd4 !important;\r\n            color: white !important;\r\n            border: none !important;\r\n            font-weight: 600 !important;\r\n            padding: 6px 16px !important;\r\n            border-radius: 4px !important;\r\n            transition: opacity 0.2s;\r\n        }\r\n        .btn-advanced-filters:hover { opacity: 0.9; }\r\n\r\n        /* Gray Export Buttons */\r\n        .dt-button {\r\n            background-color: #6c757d !important;\r\n            color: white !important;\r\n            border: none !important;\r\n            border-radius: 4px !important;\r\n            padding: 5px 12px !important;\r\n            font-size: 0.8rem !important;\r\n            margin-right: 4px !important;\r\n        }\r\n        .dt-button:hover { background-color: #5a6268 !important; }\r\n\r\n        .dataTables_scrollBody { border: 1px solid var(--bs-border-color); border-radius: 0 0 8px 8px; }\r\n        .dataTables_scrollHead { border: 1px solid var(--bs-border-color); border-bottom: none; border-radius: 8px 8px 0 0; background: var(--bs-secondary-bg); }\r\n\r\n        table.dataTable { width: 100% !important; margin: 0 !important; table-layout: auto !important; border-collapse: collapse !important; }\r\n        table.dataTable th, table.dataTable td { \r\n            white-space: nowrap !important; \r\n            vertical-align: middle; \r\n            padding: 12px 15px !important; \r\n            font-size: inherit; \r\n            min-width: 120px; \r\n        }\r\n\r\n        /* RICH FORMATTING */\r\n        .dv-neg { color: #dc3545 !important; font-weight: 500; }\r\n        .dv-bar-cell { position: relative; z-index: 1; }\r\n        .dv-bar { position: absolute; top: 2px; bottom: 2px; left: 0; background: rgba(0, 188, 212, 0.15); z-index: -1; }\r\n    </style>`);\r\n\r\n    parts.push(\"</head><body>\");\r\n\r\n    const timestamp = new Date().toLocaleString();\r\n    const sheetName = sheetNames.length > 0 ? sheetNames[0] : \"Report\";\r\n    parts.push(`\r\n    <div class=\"dv-header\">\r\n        <div>\r\n            <div class=\"dv-brand\">\r\n                <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" viewBox=\"0 0 24 24\"><path d=\"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"/></svg>\r\n                DataVista <span style=\"opacity: 0.6; margin: 0 8px;\">|</span> ${sheetName}\r\n            </div>\r\n            <div class=\"dv-meta\">Generated: ${timestamp} &bull; v7.0 (Precision Layout)</div>\r\n        </div>\r\n        <ul class=\"nav nav-tabs dv-header-tabs\" role=\"tablist\">\r\n            <li class=\"nav-item\"><a class=\"nav-link active\" data-bs-toggle=\"tab\" href=\"#page-data\">Data</a></li>\r\n            ${options.info ? '<li class=\"nav-item\"><a class=\"nav-link\" data-bs-toggle=\"tab\" href=\"#page-info\">Info</a></li>' : ''}\r\n            ${options.stats ? '<li class=\"nav-item\"><a class=\"nav-link\" data-bs-toggle=\"tab\" href=\"#page-stats\">Stats</a></li>' : ''}\r\n        </ul>\r\n        <div class=\"theme-toggler\" onclick=\"document.documentElement.setAttribute('data-bs-theme', document.documentElement.getAttribute('data-bs-theme')==='dark'?'light':'dark')\">\r\n            <span>Theme</span>\r\n        </div>\r\n    </div>\r\n    `);\r\n\r\n    parts.push(`<div class=\"container-fluid dv-container\">`);\r\n    parts.push(`<div class=\"tab-content dv-tab-content\">`);\r\n\r\n    // --- DATA PAGE ---\r\n    parts.push(`<div id=\"page-data\" class=\"tab-pane fade show active\">`);\r\n    sheetNames.forEach((name, i) => {\r\n        const rows = data[name];\r\n        const hasHeader = rows.length > 0;\r\n        const header = hasHeader ? rows[0] : [];\r\n        const body = hasHeader ? rows.slice(1) : [];\r\n        const colCount = header.length;\r\n\r\n        // Dynamic Font Scaling Logic\r\n        // Baseline: 0.9rem for < 6 cols\r\n        // Reduce by 0.05rem for each col above 6\r\n        // Min: 0.5rem\r\n        let fontSizeVal = 0.9;\r\n        if (colCount > 6) {\r\n            fontSizeVal = Math.max(0.5, 0.9 - ((colCount - 6) * 0.05));\r\n        }\r\n        const fontSizeStr = fontSizeVal.toFixed(2) + \"rem\";\r\n\r\n        parts.push(`<div class=\"dv-sheet-section\"><div class=\"dv-card\">`);\r\n        parts.push(`<div class=\"dv-table-wrapper\">`); // Main wrapper for DataTables\r\n\r\n        // Explicit style injection for font size\r\n        parts.push(`<table class=\"table table-hover display table-bordered\" style=\"width:100% !important; font-size:${fontSizeStr};\">`);\r\n        parts.push(`<thead><tr>`);\r\n        header.forEach((h) => parts.push(`<th>${h}</th>`));\r\n        parts.push(`</tr></thead><tbody>`);\r\n\r\n        body.forEach(row => {\r\n            parts.push(`<tr>`);\r\n            row.forEach((cell) => {\r\n                parts.push(`<td>${cell || \"\"}</td>`);\r\n            });\r\n            parts.push(`</tr>`);\r\n        });\r\n        parts.push(`</tbody></table></div></div></div>`);\r\n    });\r\n    parts.push(`</div>`); // End Data Page\r\n\r\n    // --- INFO & STATS PAGES (Simplified) ---\r\n    if (options.info) {\r\n        parts.push(`<div id=\"page-info\" class=\"tab-pane fade\"><div class=\"dv-card\"><h5>Dataset Info</h5><div class=\"alert alert-info\">Generated via DataVista Engine v3.0</div></div></div>`);\r\n    }\r\n    if (options.stats) {\r\n        parts.push(`<div id=\"page-stats\" class=\"tab-pane fade\"><div class=\"dv-card\"><h5>Statistics</h5><p>Statistics module initialized.</p></div></div>`);\r\n    }\r\n\r\n    parts.push(`</div></div>`); // End Container\r\n\r\n    // SearchBuilder Modal\r\n    parts.push(`\r\n    <div class=\"modal fade\" id=\"searchBuilderModal\" tabindex=\"-1\"><div class=\"modal-dialog modal-xl\"><div class=\"modal-content\"><div class=\"modal-body\" id=\"sb-modal-body\"></div></div></div></div>\r\n    `);\r\n\r\n    // Scripts\r\n    parts.push(`<script>${libs.js || \"\"}</script>`);\r\n    parts.push(`<script>\r\n    $(document).ready(function() {\r\n        $('table.display').each(function() {\r\n            var table = $(this);\r\n            // Initialize DataTable with STRICT options\r\n            table.DataTable({\r\n                dom: '<\"dv-controls-row\"Bf>t<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\r\n                autoWidth: false,\r\n                scrollX: true,\r\n                scrollCollapse: true,\r\n                paging: true,\r\n                pageLength: 20,\r\n                buttons: [\r\n                    {\r\n                        text: 'Advanced Filters',\r\n                        className: 'btn-advanced-filters',\r\n                        action: function (e, dt) {\r\n                            $('#sb-modal-body').empty();\r\n                            var sb = new $.fn.dataTable.SearchBuilder(dt, {});\r\n                            $('#sb-modal-body').append(sb.getNode());\r\n                            $('#searchBuilderModal').modal('show');\r\n                        }\r\n                    },\r\n                    'copy', 'csv', 'excel', 'pdf', 'print', 'colvis'\r\n                ],\r\n                initComplete: function () {\r\n                    var api = this.api();\r\n                    $(api.table().header()).find('th').each(function (colIdx) {\r\n                        var title = $(this).text();\r\n                        $(this).empty().append('<div style=\"margin-bottom:5px;font-weight:600;font-size:0.75rem;\">'+title+'</div>');\r\n                        $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" style=\"width:100%; border:1px solid #ddd; padding:2px; font-size:0.75rem;\" />')\r\n                            .appendTo(this)\r\n                            .on('keyup change', function (e) { \r\n                                e.stopPropagation();\r\n                                api.column(colIdx).search(this.value).draw(); \r\n                            });\r\n                    });\r\n                    setTimeout(function() { api.columns.adjust(); }, 100);\r\n                }\r\n            });\r\n        });\r\n    });\r\n    </script>`);\r\n\r\n    parts.push(\"</body></html>\");\r\n    return new Blob(parts, { type: \"text/html\" });\r\n}\r\n","/* global console */\r\n\r\n// Function to generate the HTML content for the Entire Workbook (Dashboard/Index Style)\r\nexport function generateWorkbookHTML(data, sheetNames, options, libs) {\r\n    const timestamp = new Date().toLocaleString();\r\n    const workbookName = options.workbookName || \"Workbook\";\r\n\r\n    // 1. CSS & Styles (Reusing Strict Core Styles)\r\n    const styles = `\r\n    <style>\r\n        :root {\r\n            --bs-body-bg: #ffffff;\r\n            --bs-body-color: #212529;\r\n            --bs-primary: #0d6efd;\r\n            --bs-border-color: #dee2e6;\r\n            --dv-header-bg: #f8f9fa;\r\n        }\r\n        [data-bs-theme=\"dark\"] {\r\n            --bs-body-bg: #212529;\r\n            --bs-body-color: #f8f9fa;\r\n            --bs-border-color: #495057;\r\n            --dv-header-bg: #2c3034;\r\n        }\r\n        body { \r\n            font-family: 'Segoe UI', sans-serif; \r\n            margin: 0; padding: 0; \r\n            background-color: var(--bs-body-bg); color: var(--bs-body-color);\r\n            overflow-x: hidden; \r\n            width: 100vw;\r\n        }\r\n        \r\n        /* Dashboard Styles */\r\n        .dashboard-container { max-width: 1200px; margin: 50px auto; text-align: center; }\r\n        .dashboard-title { font-size: 2.5rem; font-weight: 300; margin-bottom: 10px; }\r\n        .dashboard-meta { color: gray; }\r\n        \r\n        .sheet-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px; }\r\n        .sheet-card {\r\n            background: var(--bs-body-bg);\r\n            border: 1px solid var(--bs-border-color);\r\n            border-radius: 8px;\r\n            padding: 30px;\r\n            cursor: pointer;\r\n            transition: transform 0.2s;\r\n            width: 280px;\r\n        }\r\n        .sheet-card:hover { transform: translateY(-5px); border-color: var(--bs-primary); }\r\n        .sheet-name { font-size: 1.2rem; font-weight: 500; margin-top: 15px; }\r\n\r\n        /* Sheet View Styles */\r\n        .view-section { display: none; padding-top: 0; }\r\n        .view-section.active { display: block; }\r\n\r\n        .sheet-header {\r\n            display: flex; align-items: center; justify-content: space-between;\r\n            background: var(--dv-header-bg); padding: 10px 20px;\r\n            border-bottom: 1px solid var(--bs-border-color); margin-bottom: 20px;\r\n        }\r\n        .btn-back { cursor: pointer; font-weight: 600; text-decoration: none; color: inherit; display: flex; align-items: center; gap: 5px; }\r\n\r\n        /* === VISUAL PRECISION & FIXED CONTROLS (v6.0) === */\r\n        .dv-table-wrapper { width: 100%; margin-bottom: 2rem; position: relative; }\r\n        .dv-controls-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 10px; }\r\n        \r\n        .btn-advanced-filters { background-color: #00bcd4 !important; color: white !important; border: none !important; font-weight: 600 !important; padding: 6px 16px !important; border-radius: 4px !important; transition: opacity 0.2s; }\r\n        .btn-advanced-filters:hover { opacity: 0.9; }\r\n\r\n        .dt-button { background-color: #6c757d !important; color: white !important; border: none !important; border-radius: 4px !important; padding: 5px 12px !important; font-size: 0.8rem !important; margin-right: 4px !important; }\r\n        .dt-button:hover { background-color: #5a6268 !important; }\r\n\r\n        .dataTables_scrollBody { border: 1px solid var(--bs-border-color); border-radius: 0 0 8px 8px; }\r\n        .dataTables_scrollHead { border: 1px solid var(--bs-border-color); border-bottom: none; border-radius: 8px 8px 0 0; background: var(--dv-header-bg); }\r\n\r\n        table.dataTable { width: 100% !important; margin: 0 !important; table-layout: auto !important; border-collapse: collapse !important; }\r\n        table.dataTable th, table.dataTable td { white-space: nowrap !important; vertical-align: middle; padding: 12px 15px !important; border: 1px solid var(--bs-border-color); min-width: 120px; }\r\n\r\n        .filter-input { width: 100%; border: 1px solid var(--bs-border-color); padding: 2px; font-size: 0.75rem; border-radius: 3px; }\r\n        .dataTables_paginate { display: flex; justify-content: flex-end; margin-top: 10px; font-size: 0.8rem; }\r\n    </style>\r\n    <style>${libs.css || \"\"}</style>\r\n    `;\r\n\r\n    const parts = [];\r\n    parts.push(`<!DOCTYPE html><html lang=\"en\" data-bs-theme=\"light\"><head><meta charset=\"UTF-8\"><title>${workbookName}</title>${styles}</head><body>`);\r\n\r\n    // --- 1. DASHBOARD OVERVIEW ---\r\n    parts.push(`\r\n    <div id=\"dashboard-view\" class=\"view-section active\">\r\n        <div class=\"dashboard-container\">\r\n            <div class=\"dashboard-header\">\r\n                <div style=\"font-size: 1.5rem; font-weight: bold; margin-bottom: 20px;\">\r\n                    <img src=\"https://Harry-0402.github.io/DataVista/assets/icon-32.png\" width=\"32\" height=\"32\" style=\"margin-right: 10px;\">\r\n                    DataVista Report\r\n                </div>\r\n                <h1 class=\"dashboard-title\">${workbookName}</h1>\r\n                <p class=\"dashboard-meta\">Generated on ${timestamp} &bull; ${sheetNames.length} Sheets &bull; v7.0 (Precision Layout)</p>\r\n            </div>\r\n            <div class=\"sheet-grid\">\r\n    `);\r\n\r\n    sheetNames.forEach((name, index) => {\r\n        parts.push(`\r\n        <div class=\"sheet-card\" onclick=\"showSheet('${index}')\">\r\n            <svg width=\"40\" height=\"40\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"></path></svg>\r\n            <div class=\"sheet-name\">${name}</div>\r\n        </div>\r\n        `);\r\n    });\r\n    parts.push(`</div></div></div>`);\r\n\r\n    // --- 2. INDIVIDUAL SHEET VIEWS ---\r\n    sheetNames.forEach((name, index) => {\r\n        const rows = data[name];\r\n        const header = rows.length > 0 ? rows[0] : [];\r\n        const body = rows.length > 0 ? rows.slice(1) : [];\r\n\r\n        // Dynamic Font Scaling\r\n        const colCount = header.length;\r\n        let fontSizeVal = 0.9;\r\n        if (colCount > 6) {\r\n            fontSizeVal = Math.max(0.5, 0.9 - ((colCount - 6) * 0.05));\r\n        }\r\n        const fontSizeStr = fontSizeVal.toFixed(2) + \"rem\";\r\n\r\n        parts.push(`\r\n        <div id=\"sheet-view-${index}\" class=\"view-section\">\r\n            <div class=\"sheet-header\">\r\n                <a class=\"btn-back\" onclick=\"showDashboard()\">\r\n                    <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" viewBox=\"0 0 24 24\"><path d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/></svg>\r\n                    Back to Dashboard\r\n                </a>\r\n                <div style=\"font-weight: bold;\">${name}</div>\r\n                <div onclick=\"document.documentElement.setAttribute('data-bs-theme', document.documentElement.getAttribute('data-bs-theme')==='dark'?'light':'dark')\" style=\"cursor: pointer;\">Theme</div>\r\n            </div>\r\n            <div class=\"container-fluid\" style=\"padding: 0 20px;\">\r\n                <div class=\"dv-table-wrapper\">\r\n                    <table class=\"table table-striped table-hover display table-bordered\" style=\"width:100% !important; font-size:${fontSizeStr};\">\r\n                        <thead><tr>${header.map(h => `<th>${h || \"\"}</th>`).join('')}</tr></thead>\r\n                        <tbody>\r\n                            ${body.map(r => `<tr>${r.map(c => `<td>${c || \"\"}</td>`).join('')}</tr>`).join('')}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        `);\r\n    });\r\n\r\n    parts.push(`\r\n    <div class=\"modal fade\" id=\"searchBuilderModal\" tabindex=\"-1\"><div class=\"modal-dialog modal-xl\"><div class=\"modal-content\"><div class=\"modal-body\" id=\"sb-modal-body\"></div></div></div></div>\r\n    `);\r\n\r\n    // --- 3. SCRIPTS ---\r\n    parts.push(`<script>${libs.js || \"\"}</script>`);\r\n    parts.push(`<script>\r\n    function showDashboard() { $('.view-section').removeClass('active'); $('#dashboard-view').addClass('active'); }\r\n    function showSheet(index) { \r\n        $('.view-section').removeClass('active'); \r\n        $('#sheet-view-' + index).addClass('active'); \r\n        $.fn.dataTable.tables({ visible: true, api: true }).columns.adjust();\r\n    }\r\n\r\n    $(document).ready(function() {\r\n        $('table.display').each(function() {\r\n            var table = $(this);\r\n            table.DataTable({\r\n                dom: '<\"dv-controls-row\"Bf>t<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\r\n                autoWidth: false,\r\n                scrollX: true,\r\n                scrollCollapse: true,\r\n                pageLength: 20,\r\n                buttons: [\r\n                    {\r\n                        text: 'Advanced Filters',\r\n                        className: 'btn-advanced-filters',\r\n                        action: function (e, dt) {\r\n                            $('#sb-modal-body').empty();\r\n                            var sb = new $.fn.dataTable.SearchBuilder(dt, {});\r\n                            $('#sb-modal-body').append(sb.getNode());\r\n                            $('#searchBuilderModal').modal('show');\r\n                        }\r\n                    },\r\n                    'copy', 'csv', 'excel', 'pdf', 'print', 'colvis'\r\n                ],\r\n                initComplete: function() {\r\n                    var api = this.api();\r\n                    $(api.table().header()).find('th').each(function (colIdx) {\r\n                        var title = $(this).text();\r\n                        $(this).empty().append('<div style=\"margin-bottom:5px;font-weight:600;font-size:0.75rem;\">'+title+'</div>');\r\n                        $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" style=\"width:100%; border:1px solid #ddd; padding:2px; font-size:0.75rem;\" />')\r\n                            .appendTo(this)\r\n                            .on('keyup change', function (e) { \r\n                                e.stopPropagation();\r\n                                api.column(colIdx).search(this.value).draw(); \r\n                            });\r\n                    });\r\n                    setTimeout(function() { api.columns.adjust(); }, 100);\r\n                }\r\n            });\r\n        });\r\n    });\r\n    </script></body></html>`);\r\n\r\n    return new Blob([parts.join(\"\")], { type: \"text/html\" });\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\nimport { trimEmptyGrid } from \"../utils/data-utils\";\r\nimport { generateHTML } from \"../taskpane/generators\";\r\nimport { generateWorkbookHTML } from \"../taskpane/workbook_generators\";\r\n\r\n// Define library URLs for offline bundling (Same as taskpane.js)\r\nconst LIB_URLS = {\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\"\r\n};\r\n\r\nOffice.onReady(() => {\r\n    // If needed, Office.js is ready to be called\r\n});\r\n\r\n/**\r\n * Exports the currently selected range.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportSelection(event) {\r\n    await runHeadlessExport(\"selection\", event);\r\n}\r\n\r\n/**\r\n * Exports the entire workbook.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportWorkbook(event) {\r\n    await runHeadlessExport(\"workbook\", event);\r\n}\r\n\r\nasync function runHeadlessExport(source, event) {\r\n    try {\r\n        // Show a \"working\" indicator (not really possible without UI, but we can prevent timeout)\r\n        // Default Options\r\n        const options = {\r\n            stats: true,\r\n            info: true,\r\n            desc: true,\r\n            rich: true,\r\n            workbookName: \"Report\"\r\n        };\r\n\r\n        let data = {};\r\n        let sheetNames = [];\r\n\r\n        await Excel.run(async (context) => {\r\n            const workbook = context.workbook;\r\n            workbook.load(\"name\");\r\n            await context.sync();\r\n            options.workbookName = workbook.name || \"Report\";\r\n\r\n            if (source === \"selection\") {\r\n                const range = context.workbook.getSelectedRange();\r\n                range.load(\"values\");\r\n                await context.sync();\r\n\r\n                // Trim empty\r\n                const trimmed = trimEmptyGrid(range.values);\r\n                if (!trimmed) throw new Error(\"Selection is empty\");\r\n\r\n                data[\"Selection\"] = trimmed;\r\n                sheetNames.push(\"Selection\");\r\n            } else {\r\n                const sheets = context.workbook.worksheets;\r\n                sheets.load(\"items/name\");\r\n                await context.sync();\r\n\r\n                const sheetRanges = sheets.items.map(sheet => {\r\n                    const rng = sheet.getUsedRangeOrNullObject();\r\n                    rng.load(\"values, rowCount\");\r\n                    return { name: sheet.name, rng: rng };\r\n                });\r\n                await context.sync();\r\n\r\n                for (let item of sheetRanges) {\r\n                    if (!item.rng.isNullObject && item.rng.rowCount > 0) {\r\n                        const trimmed = trimEmptyGrid(item.rng.values);\r\n                        if (trimmed) {\r\n                            data[item.name] = trimmed;\r\n                            sheetNames.push(item.name);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        if (sheetNames.length === 0) throw new Error(\"No data found.\");\r\n\r\n        // Fetch Libs\r\n        const libs = await fetchOfflineLibs();\r\n\r\n        let blob;\r\n        if (source === \"workbook\") {\r\n            blob = generateWorkbookHTML(data, sheetNames, options, libs); // From workbook_generators.js\r\n        } else {\r\n            blob = generateHTML(data, sheetNames, options, libs); // From generators.js\r\n        }\r\n\r\n        // Trigger Download\r\n        const url = URL.createObjectURL(blob);\r\n\r\n        // In FunctionFile, we have a hidden DOM. Creating an anchor usually works.\r\n        const a = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = `DataVista_${options.workbookName}_${new Date().getTime()}.html`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n\r\n        // Success Notification?\r\n        // Office.context.ui.displayDialogAsync is only for opening windows.\r\n        // We assume download started.\r\n\r\n    } catch (error) {\r\n        console.error(error);\r\n        // If error, show a dialog? Or just silent fail?\r\n        // Since we are headless, we can't show alerts easily unless we use displayDialogAsync\r\n    } finally {\r\n        event.completed();\r\n    }\r\n}\r\n\r\nasync function fetchOfflineLibs() {\r\n    const urls = LIB_URLS;\r\n    const load = async (url) => {\r\n        try {\r\n            const r = await fetch(url);\r\n            if (!r.ok) throw new Error(url);\r\n            return await r.text();\r\n        } catch (e) {\r\n            return `/* Failed: ${url} */`;\r\n        }\r\n    };\r\n\r\n    const cssKeys = ['bootstrap_css', 'datatables_css', 'buttons_css', 'searchbuilder_css', 'dateTime_css'];\r\n    const jsKeys = [\r\n        'jquery', 'bootstrap_js', 'datatables_js', 'datatables_bs5_js',\r\n        'jszip', 'pdfmake', 'vfs_fonts',\r\n        'buttons_js', 'buttons_bs5_js', 'buttons_colvis_js', 'buttons_html5_js', 'buttons_print_js',\r\n        'dateTime_js', 'searchbuilder_js', 'searchbuilder_bs5_js'\r\n    ];\r\n\r\n    const [cssArr, jsArr] = await Promise.all([\r\n        Promise.all(cssKeys.map(k => load(urls[k]))),\r\n        Promise.all(jsKeys.map(k => load(urls[k])))\r\n    ]);\r\n\r\n    return {\r\n        css: cssArr.join(\"\\n\"),\r\n        js: jsArr.join(\"\\n\")\r\n    };\r\n}\r\n\r\nconst g = getGlobal();\r\ng.exportSelection = exportSelection;\r\ng.exportWorkbook = exportWorkbook;\r\n\r\nfunction getGlobal() {\r\n    return typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : typeof global !== \"undefined\" ? global : undefined;\r\n}\r\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();"],"names":["__webpack_require__","trimEmptyGrid","data","length","minRow","maxRow","minCol","maxCol","r","c","val","trimmed","push","slice","generateHTML","sheetNames","options","libs","parts","concat","css","timestamp","Date","toLocaleString","sheetName","info","stats","forEach","name","i","rows","hasHeader","header","body","colCount","fontSizeVal","Math","max","fontSizeStr","toFixed","h","row","cell","js","Blob","type","generateWorkbookHTML","workbookName","styles","index","map","join","e","t","Symbol","n","iterator","o","toStringTag","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","g","globalThis","this","Function","window","LIB_URLS","bootstrap_css","datatables_css","buttons_css","searchbuilder_css","dateTime_css","jquery","bootstrap_js","datatables_js","datatables_bs5_js","jszip","pdfmake","vfs_fonts","buttons_js","buttons_bs5_js","buttons_colvis_js","buttons_html5_js","buttons_print_js","dateTime_js","searchbuilder_js","searchbuilder_bs5_js","_exportSelection","_callee","event","_context","runHeadlessExport","_exportWorkbook","_callee2","_context2","_x3","_x4","_runHeadlessExport","_callee4","source","blob","url","_t","_context4","desc","rich","Excel","run","_ref","_callee3","context","workbook","range","sheets","sheetRanges","_iterator","_step","item","_trimmed","_context3","load","sync","getSelectedRange","values","Error","worksheets","items","sheet","rng","getUsedRangeOrNullObject","_createForOfIteratorHelper","s","isNullObject","rowCount","err","_x5","fetchOfflineLibs","URL","createObjectURL","document","createElement","href","download","getTime","appendChild","click","removeChild","console","error","completed","_fetchOfflineLibs","_callee6","urls","cssKeys","jsKeys","_yield$Promise$all","_yield$Promise$all2","cssArr","jsArr","_context6","_ref2","_callee5","_context5","fetch","ok","text","_x6","all","k","_slicedToArray","Office","onReady","self","global","undefined","exportSelection","_x","exportWorkbook","_x2"],"ignoreList":[],"sourceRoot":""}