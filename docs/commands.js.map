{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://datavista-excel-addin/webpack/bootstrap","webpack://datavista-excel-addin/./src/utils/data-utils.js","webpack://datavista-excel-addin/./src/taskpane/generators.js","webpack://datavista-excel-addin/./src/taskpane/workbook_generators.js","webpack://datavista-excel-addin/./src/commands/commands.js","webpack://datavista-excel-addin/webpack/runtime/global"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","\r\n/**\r\n * Trims empty rows and columns from a 2D array.\r\n * @param {any[][]} data \r\n * @returns {any[][] | null} Trimmed data or null if empty\r\n */\r\nexport function trimEmptyGrid(data) {\r\n    if (!data || data.length === 0) return null;\r\n\r\n    let minRow = data.length;\r\n    let maxRow = -1;\r\n    let minCol = data[0].length;\r\n    let maxCol = -1;\r\n\r\n    // 1. Find Bounds\r\n    for (let r = 0; r < data.length; r++) {\r\n        for (let c = 0; c < data[r].length; c++) {\r\n            const val = data[r][c];\r\n            if (val !== \"\" && val !== null && val !== undefined) {\r\n                if (r < minRow) minRow = r;\r\n                if (r > maxRow) maxRow = r;\r\n                if (c < minCol) minCol = c;\r\n                if (c > maxCol) maxCol = c;\r\n            }\r\n        }\r\n    }\r\n\r\n    // 2. Check if empty\r\n    if (maxRow === -1) return null;\r\n\r\n    // 3. Slice\r\n    const trimmed = [];\r\n    for (let r = minRow; r <= maxRow; r++) {\r\n        trimmed.push(data[r].slice(minCol, maxCol + 1));\r\n    }\r\n\r\n    return trimmed;\r\n}\r\n","/* global Blob, window */\r\n// generators.js\r\n\r\nwindow.LIB_URLS = {\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n\r\n    // SearchBuilder & DateTime\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n    searchpanes_css: \"https://cdn.datatables.net/searchpanes/2.2.0/css/searchPanes.bootstrap5.min.css\",\r\n    select_css: \"https://cdn.datatables.net/select/1.7.0/css/select.bootstrap5.min.css\",\r\n\r\n    // JS Dependencies\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n\r\n    // DataTables Core & BS5\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n\r\n    // Export Dependencies\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n\r\n    // Extensions\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\",\r\n    searchpanes_js: \"https://cdn.datatables.net/searchpanes/2.2.0/js/dataTables.searchPanes.min.js\",\r\n    searchpanes_bs5_js: \"https://cdn.datatables.net/searchpanes/2.2.0/js/searchPanes.bootstrap5.min.js\",\r\n    select_js: \"https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js\"\r\n};\r\n\r\n/**\r\n * Main Generator Function\r\n * @param {Object} data - { \"Sheet1\": [[header, val], [val, val]] }\r\n * @param {string[]} sheetNames\r\n * @param {Object} options - { stats: bool, info: bool, desc: bool, rich: bool, workbookName: string }\r\n * @param {Object} libs - { css: string, js: string }\r\n */\r\nexport function generateHTML(data, sheetNames, options, libs) {\r\n    const parts = [];\r\n    parts.push(`<!DOCTYPE html><html lang='en' data-bs-theme='light'>`);\r\n    parts.push(\"<head><meta charset='UTF-8'><title>DataVista Report</title>\");\r\n\r\n    // 1. CSS\r\n    parts.push(`<style>${libs.css || \"\"}</style>`);\r\n\r\n    // 2. Custom CSS - STRICT FIT TO SCREEN\r\n    parts.push(`<style>\r\n        :root { --header-bg: #3c6ea9; --header-text: white; }\r\n        [data-bs-theme=\"dark\"] { --header-bg: #1f2937; }\r\n\r\n        html { scroll-behavior: smooth; }\r\n        body { \r\n            background-color: var(--bs-body-bg); \r\n            color: var(--bs-body-color); \r\n            font-family: 'Segoe UI', sans-serif; \r\n            overflow-x: hidden; /* Prevent body scroll */\r\n            width: 100vw;\r\n        }\r\n        \r\n        /* Header Container */\r\n        .dv-header {\r\n            background-color: var(--header-bg); color: var(--header-text);\r\n            padding: 12px 2rem; display: flex; justify-content: space-between; align-items: center;\r\n            box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 1.5rem; gap: 2rem;\r\n        }\r\n        [data-bs-theme=\"dark\"] .dv-header { background-color: var(--header-bg-dark); }\r\n\r\n        .dv-brand { font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; gap: 8px; }\r\n        .dv-meta { font-size: 0.75rem; opacity: 0.7; margin-top: 2px; }\r\n        \r\n        /* Navigation */\r\n        .dv-header-tabs .nav-link { \r\n            border: none; color: rgba(255,255,255,0.7); background: transparent;\r\n            padding: 8px 16px; font-weight: 500; border-radius: 20px; transition: all 0.2s; font-size: 0.85rem;\r\n        }\r\n        .dv-header-tabs .nav-link.active { color: white; background: rgba(255,255,255,0.2); }\r\n        .theme-toggler { cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 0.8rem; border: 1px solid rgba(255,255,255,0.3); padding: 4px 10px; border-radius: 16px; }\r\n\r\n        .dv-container { padding: 0 20px 3rem 20px; max-width: 100vw; overflow-x: hidden; }\r\n\r\n        /* Card */\r\n        .dv-card { background: var(--bs-card-bg); border: 1px solid var(--bs-border-color); border-radius: 12px; padding: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.02); margin-bottom: 2rem; }\r\n\r\n        /* === PRECISION HEADER & FILTERS (v9.0) === */\r\n        .dv-table-wrapper { width: 100%; margin-bottom: 2rem; position: relative; }\r\n        \r\n        /* Header Styling */\r\n        table.dataTable thead tr:first-child th {\r\n            background: var(--bs-secondary-bg) !important;\r\n            padding: 12px 18px !important;\r\n            font-weight: 700 !important;\r\n            border-bottom: 2px solid var(--bs-border-color) !important;\r\n            vertical-align: middle !important;\r\n        }\r\n        \r\n        /* Filter Row Styling */\r\n        .filter-row th {\r\n            padding: 4px 10px !important;\r\n            background: var(--bs-body-bg) !important;\r\n            border-bottom: 1px solid var(--bs-border-color) !important;\r\n            line-height: 1 !important;\r\n        }\r\n        .filter-input {\r\n            width: 100%;\r\n            border: 1px solid var(--bs-border-color);\r\n            padding: 5px 10px;\r\n            font-size: 0.75rem;\r\n            border-radius: 6px;\r\n            outline: none;\r\n            transition: border-color 0.2s;\r\n        }\r\n        .filter-input:focus { border-color: #00bcd4; box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.1); }\r\n\r\n        /* SearchPanes Styling */\r\n        .dtsp-searchPanes { margin-bottom: 1.5rem; border: 1px solid var(--bs-border-color); border-radius: 8px; padding: 15px; background: var(--bs-body-bg); }\r\n        .dtsp-pane { border: none !important; }\r\n\r\n        /* Controls Row */\r\n        .dv-controls-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 12px; }\r\n        .dv-search-group { display: flex; align-items: center; gap: 15px; }\r\n        .dv-summary-stats { display: flex; gap: 10px; font-size: 0.85rem; color: var(--bs-secondary-color); border-right: 1px solid var(--bs-border-color); padding-right: 15px; }\r\n        .dv-stat-badge { background: var(--bs-secondary-bg); padding: 2px 8px; border-radius: 4px; font-weight: 600; color: var(--bs-primary); }\r\n\r\n        /* Navigator Bar Refinement */\r\n        .dv-header-tabs {\r\n            border-bottom: none !important;\r\n            justify-content: center;\r\n            gap: 5px;\r\n        }\r\n        .dv-header-tabs .nav-link {\r\n            border: none !important;\r\n            color: rgba(255,255,255,0.7) !important;\r\n            padding: 8px 20px !important;\r\n            border-radius: 20px !important;\r\n            font-weight: 500;\r\n            transition: all 0.3s;\r\n        }\r\n        .dv-header-tabs .nav-link:hover {\r\n            color: white !important;\r\n            background: rgba(255,255,255,0.1) !important;\r\n        }\r\n        .dv-header-tabs .nav-link.active {\r\n            color: white !important;\r\n            background: rgba(255,255,255,0.2) !important;\r\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n        }\r\n\r\n        /* Unified Button Group Styling (v11.0) */\r\n        .dt-buttons {\r\n            display: inline-flex !important;\r\n            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\r\n            border-radius: 8px;\r\n            overflow: hidden;\r\n            border: 1px solid var(--bs-border-color);\r\n        }\r\n        .btn-advanced-filters, .dt-button {\r\n            margin: 0 !important;\r\n            border: none !important;\r\n            border-radius: 0 !important;\r\n            padding: 8px 18px !important;\r\n            font-size: 0.85rem !important;\r\n            height: 38px;\r\n            display: flex;\r\n            align-items: center;\r\n            font-weight: 500 !important;\r\n            transition: all 0.2s !important;\r\n        }\r\n        .btn-advanced-filters {\r\n            background-color: #00bcd4 !important;\r\n            color: white !important;\r\n            border-right: 1px solid rgba(0,0,0,0.1) !important;\r\n        }\r\n        .dt-button {\r\n            background-color: #6c757d !important;\r\n            color: white !important;\r\n            border-right: 1px solid rgba(255,255,255,0.1) !important;\r\n        }\r\n        .dt-button:last-child { border-right: none !important; }\r\n        .dt-button:hover { background-color: #5a6268 !important; transform: none !important; }\r\n        .btn-advanced-filters:hover { background-color: #00acc1 !important; transform: none !important; }\r\n\r\n        .dataTables_scrollBody { border: 1px solid var(--bs-border-color); border-radius: 0 0 8px 8px; }\r\n        .dataTables_scrollHead { border: 1px solid var(--bs-border-color); border-bottom: none; border-radius: 8px 8px 0 0; background: var(--bs-secondary-bg); }\r\n\r\n        table.dataTable { width: 100% !important; margin: 0 !important; table-layout: auto !important; border-collapse: collapse !important; }\r\n        table.dataTable th, table.dataTable td { \r\n            white-space: nowrap !important; \r\n            vertical-align: middle; \r\n            padding: 12px 18px !important; \r\n            font-size: inherit; \r\n            min-width: 120px; \r\n        }\r\n\r\n        /* RICH FORMATTING */\r\n        .dv-pos { color: #28a745 !important; font-weight: 600; }\r\n        .dv-neg { color: #dc3545 !important; font-weight: 600; }\r\n        .dv-bar-cell { position: relative; z-index: 1; }\r\n        .dv-bar { position: absolute; top: 2px; bottom: 2px; left: 0; background: rgba(0, 188, 212, 0.15); z-index: -1; }\r\n    </style>`);\r\n\r\n    parts.push(\"</head><body>\");\r\n\r\n    const timestamp = new Date().toLocaleString();\r\n    const sheetName = sheetNames.length > 0 ? sheetNames[0] : \"Report\";\r\n    parts.push(`\r\n    <div class=\"dv-header\">\r\n        <div>\r\n            <div class=\"dv-brand\">\r\n                <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" viewBox=\"0 0 24 24\"><path d=\"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"/></svg>\r\n                DataVista <span style=\"opacity: 0.6; margin: 0 8px;\">|</span> ${sheetName}\r\n            </div>\r\n            <div class=\"dv-meta\">Generated: ${timestamp} &bull; v1.2.0 (Analytics Edition)</div>\r\n        </div>\r\n        <ul class=\"nav nav-tabs dv-header-tabs\" role=\"tablist\">\r\n            <li class=\"nav-item\"><a class=\"nav-link active\" data-bs-toggle=\"tab\" href=\"#page-data\">Data</a></li>\r\n            ${options.info ? '<li class=\"nav-item\"><a class=\"nav-link\" data-bs-toggle=\"tab\" href=\"#page-info\">Info</a></li>' : ''}\r\n            ${options.stats ? '<li class=\"nav-item\"><a class=\"nav-link\" data-bs-toggle=\"tab\" href=\"#page-stats\">Stats</a></li>' : ''}\r\n        </ul>\r\n        <div class=\"theme-toggler\" onclick=\"document.documentElement.setAttribute('data-bs-theme', document.documentElement.getAttribute('data-bs-theme')==='dark'?'light':'dark')\">\r\n            <span>Theme</span>\r\n        </div>\r\n    </div>\r\n    `);\r\n\r\n    parts.push(`<div class=\"container-fluid dv-container\">`);\r\n    parts.push(`<div class=\"tab-content dv-tab-content\">`);\r\n\r\n    // --- DATA PAGE ---\r\n    parts.push(`<div id=\"page-data\" class=\"tab-pane fade show active\">`);\r\n    sheetNames.forEach((name, i) => {\r\n        const rows = data[name];\r\n        const hasHeader = rows.length > 0;\r\n        const header = hasHeader ? rows[0] : [];\r\n        // v11.0: Aggressive row cleaning (removes any rows with only whitespace/nulls)\r\n        const body = hasHeader ? rows.slice(1).filter(r => r.some(c => c !== null && c !== undefined && c.toString().trim() !== \"\")) : [];\r\n        const colCount = header.length;\r\n\r\n        // Dynamic Font Scaling Logic (v10.0 Refined)\r\n        // Baseline: 1.0rem for < 6 cols\r\n        // Reduce by 0.04rem for each col above 6\r\n        // Min: 0.75rem (Improved readability)\r\n        let fontSizeVal = 1.0;\r\n        if (colCount > 6) {\r\n            fontSizeVal = Math.max(0.75, 1.0 - ((colCount - 6) * 0.04));\r\n        }\r\n        const fontSizeStr = fontSizeVal.toFixed(2) + \"rem\";\r\n\r\n        parts.push(`<div class=\"dv-sheet-section\"><div class=\"dv-card\">`);\r\n        parts.push(`<div class=\"dv-table-wrapper\">`); // Main wrapper for DataTables\r\n\r\n        // Explicit style injection for font size\r\n        parts.push(`<table class=\"table table-hover display table-bordered\" style=\"width:100% !important; font-size:${fontSizeStr};\">`);\r\n        parts.push(`<thead>`);\r\n\r\n        // Row 1: Titles\r\n        parts.push(`<tr>`);\r\n        header.forEach((h) => parts.push(`<th>${h}</th>`));\r\n        parts.push(`</tr>`);\r\n\r\n        // Row 2: Filters\r\n        parts.push(`<tr class=\"filter-row\">`);\r\n        header.forEach(() => parts.push(`<th></th>`));\r\n        parts.push(`</tr>`);\r\n\r\n        parts.push(`</thead><tbody>`);\r\n\r\n        body.forEach(row => {\r\n            parts.push(`<tr>`);\r\n            row.forEach((cell) => {\r\n                parts.push(`<td>${cell || \"\"}</td>`);\r\n            });\r\n            parts.push(`</tr>`);\r\n        });\r\n        parts.push(`</tbody></table></div></div></div>`);\r\n    });\r\n    parts.push(`</div>`); // End Data Page\r\n\r\n    // --- INFO & STATS PAGES ---\r\n    if (options.info || options.stats) {\r\n        // Calculate Stats (v1.2.0)\r\n        const name = sheetNames[0];\r\n        const rows = data[name] || [];\r\n        const header = rows.length > 0 ? rows[0] : [];\r\n        const body = rows.length > 0 ? rows.slice(1).filter(r => r.some(c => c !== null && c !== undefined && c.toString().trim() !== \"\")) : [];\r\n\r\n        const columnStats = header.map((h, colIdx) => {\r\n            const values = body.map(r => {\r\n                const val = r[colIdx];\r\n                if (val === null || val === undefined || val === \"\") return null;\r\n                const num = parseFloat(val.toString().replace(/[^0-9.-]+/g, \"\"));\r\n                return isNaN(num) ? null : num;\r\n            }).filter(v => v !== null);\r\n\r\n            if (values.length === 0) return null;\r\n\r\n            const sum = values.reduce((a, b) => a + b, 0);\r\n            return {\r\n                label: h || `Column ${colIdx + 1}`,\r\n                count: values.length,\r\n                sum: sum,\r\n                avg: sum / values.length,\r\n                min: Math.min(...values),\r\n                max: Math.max(...values)\r\n            };\r\n        }).filter(s => s !== null);\r\n\r\n        if (options.info) {\r\n            parts.push(`\r\n            <div id=\"page-info\" class=\"tab-pane fade\">\r\n                <div class=\"dv-card\">\r\n                    <h5 class=\"mb-3\">Dataset Metadata</h5>\r\n                    <div class=\"table-responsive\">\r\n                        <table class=\"table table-bordered\">\r\n                            <thead class=\"table-light\"><tr><th>Property</th><th>Value</th></tr></thead>\r\n                            <tbody>\r\n                                <tr><td><strong>Source Sheet</strong></td><td>${sheetName}</td></tr>\r\n                                <tr><td><strong>Total Rows</strong></td><td>${body.length}</td></tr>\r\n                                <tr><td><strong>Total Columns</strong></td><td>${header.length}</td></tr>\r\n                                <tr><td><strong>Numeric Columns</strong></td><td>${columnStats.length}</td></tr>\r\n                                <tr><td><strong>Export Quality</strong></td><td><span class=\"badge bg-success\">Verified</span></td></tr>\r\n                                <tr><td><strong>Engine Node</strong></td><td>DataVista v1.2.0</td></tr>\r\n                                <tr><td><strong>Export Date</strong></td><td>${timestamp}</td></tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </div>`);\r\n        }\r\n        if (options.stats) {\r\n            parts.push(`\r\n            <div id=\"page-stats\" class=\"tab-pane fade\">\r\n                <div class=\"dv-card\">\r\n                    <h5 class=\"mb-3\">Summary Statistics</h5>\r\n                    <div class=\"table-responsive\">\r\n                        <table class=\"table table-hover table-bordered\">\r\n                            <thead class=\"table-light\">\r\n                                <tr>\r\n                                    <th>Column</th>\r\n                                    <th>Count</th>\r\n                                    <th>Sum</th>\r\n                                    <th>Average</th>\r\n                                    <th>Min</th>\r\n                                    <th>Max</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                ${columnStats.map(s => `\r\n                                    <tr>\r\n                                        <td><strong>${s.label}</strong></td>\r\n                                        <td>${s.count}</td>\r\n                                        <td>${s.sum.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</td>\r\n                                        <td>${s.avg.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</td>\r\n                                        <td>${s.min.toLocaleString()}</td>\r\n                                        <td>${s.max.toLocaleString()}</td>\r\n                                    </tr>\r\n                                `).join('')}\r\n                                ${columnStats.length === 0 ? '<tr><td colspan=\"6\" class=\"text-center text-muted\">No numeric data found for calculation.</td></tr>' : ''}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </div>`);\r\n        }\r\n    }\r\n\r\n    parts.push(`</div></div>`); // End Container\r\n\r\n    // SearchBuilder Modal\r\n    parts.push(`\r\n    <div class=\"modal fade\" id=\"searchBuilderModal\" tabindex=\"-1\"><div class=\"modal-dialog modal-xl\"><div class=\"modal-content\"><div class=\"modal-body\" id=\"sb-modal-body\"></div></div></div></div>\r\n    `);\r\n\r\n    // Scripts\r\n    parts.push(`<script>${libs.js || \"\"}</script>`);\r\n    parts.push(`<script>\r\n    $(document).ready(function() {\r\n        $('table.display').each(function() {\r\n            var table = $(this);\r\n            // Initialize DataTable with STRICT options\r\n            table.DataTable({\r\n                dom: 'P<\"dv-controls-row\"B<\"dv-search-group\"f>>t<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\r\n                orderCellsTop: true, // Use first row for sorting\r\n                searchPanes: {\r\n                    cascadePanes: true,\r\n                    viewTotal: true,\r\n                    layout: 'columns-3'\r\n                },\r\n                autoWidth: false,\r\n                scrollX: true,\r\n                scrollCollapse: true,\r\n                paging: true,\r\n                pageLength: 20,\r\n                rowCallback: function(row, data) {\r\n                    // v10.0: Numeric Conditional Coloring\r\n                    $('td', row).each(function() {\r\n                        var text = $(this).text().trim();\r\n                        var val = parseFloat(text.replace(/[^0-9.-]+/g, \"\"));\r\n                        if (!isNaN(val) && !text.includes('/') && !text.includes('-20') && text.length < 15) {\r\n                            if (val > 0) $(this).addClass('dv-pos');\r\n                            else if (val < 0) $(this).addClass('dv-neg');\r\n                        }\r\n                    });\r\n                },\r\n                buttons: [\r\n                    {\r\n                        text: 'Advanced Filters',\r\n                        className: 'btn-advanced-filters',\r\n                        action: function (e, dt) {\r\n                            $('#sb-modal-body').empty();\r\n                            var sb = new $.fn.dataTable.SearchBuilder(dt, {});\r\n                            $('#sb-modal-body').append(sb.getNode());\r\n                            $('#searchBuilderModal').modal('show');\r\n                        }\r\n                    },\r\n                    'copy', 'csv', 'excel', 'pdf', 'print', 'colvis'\r\n                ],\r\n                initComplete: function () {\r\n                    var api = this.api();\r\n                    \r\n                    // Add Row/Col Counts\r\n                    var rowCount = api.rows().count();\r\n                    var colCount = api.columns().count();\r\n                    var statsHtml = '<div class=\"dv-summary-stats\">' +\r\n                        '<span>Total Rows: <span class=\"dv-stat-badge\">' + rowCount + '</span></span>' +\r\n                        '<span>Total Columns: <span class=\"dv-stat-badge\">' + colCount + '</span></span>' +\r\n                        '</div>';\r\n                    $('.dv-search-group').prepend(statsHtml);\r\n\r\n                    // Inject filters into the SECOND header row\r\n                    $(api.table().header()).find('tr.filter-row th').each(function (colIdx) {\r\n                        $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" />')\r\n                            .appendTo(this)\r\n                            .on('keyup change', function (e) { \r\n                                e.stopPropagation();\r\n                                api.column(colIdx).search(this.value).draw(); \r\n                            });\r\n                    });\r\n                    \r\n                    setTimeout(function() { api.columns.adjust(); }, 150);\r\n                }\r\n            });\r\n        });\r\n    });\r\n    </script>`);\r\n\r\n    parts.push(\"</body></html>\");\r\n    return new Blob(parts, { type: \"text/html\" });\r\n}\r\n","/* global console */\r\n\r\n// Function to generate the HTML content for the Entire Workbook (Dashboard/Index Style)\r\nexport function generateWorkbookHTML(data, sheetNames, options, libs) {\r\n    const timestamp = new Date().toLocaleString();\r\n    const workbookName = options.workbookName || \"Workbook\";\r\n\r\n    // 1. CSS & Styles (Reusing Strict Core Styles)\r\n    const styles = `\r\n    <style>\r\n        :root {\r\n            --bs-body-bg: #ffffff;\r\n            --bs-body-color: #212529;\r\n            --bs-primary: #0d6efd;\r\n            --bs-border-color: #dee2e6;\r\n            --dv-header-bg: #f8f9fa;\r\n        }\r\n        [data-bs-theme=\"dark\"] {\r\n            --bs-body-bg: #212529;\r\n            --bs-body-color: #f8f9fa;\r\n            --bs-border-color: #495057;\r\n            --dv-header-bg: #2c3034;\r\n        }\r\n        body { \r\n            font-family: 'Segoe UI', sans-serif; \r\n            margin: 0; padding: 0; \r\n            background-color: var(--bs-body-bg); color: var(--bs-body-color);\r\n            overflow-x: hidden; \r\n            width: 100vw;\r\n        }\r\n        \r\n        /* Dashboard Styles */\r\n        .dashboard-container { max-width: 1200px; margin: 50px auto; text-align: center; }\r\n        .dashboard-title { font-size: 2.5rem; font-weight: 300; margin-bottom: 10px; }\r\n        .dashboard-meta { color: gray; }\r\n        \r\n        .sheet-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px; }\r\n        .sheet-card {\r\n            background: var(--bs-body-bg);\r\n            border: 1px solid var(--bs-border-color);\r\n            border-radius: 8px;\r\n            padding: 30px;\r\n            cursor: pointer;\r\n            transition: transform 0.2s;\r\n            width: 280px;\r\n        }\r\n        .sheet-card:hover { transform: translateY(-5px); border-color: var(--bs-primary); }\r\n        .sheet-name { font-size: 1.2rem; font-weight: 500; margin-top: 15px; }\r\n\r\n        /* Sheet View Styles */\r\n        .view-section { display: none; padding-top: 0; }\r\n        .view-section.active { display: block; }\r\n\r\n        .sheet-header {\r\n            display: flex; align-items: center; justify-content: space-between;\r\n            background: var(--dv-header-bg); padding: 10px 20px;\r\n            border-bottom: 1px solid var(--bs-border-color); margin-bottom: 20px;\r\n        }\r\n        .btn-back { cursor: pointer; font-weight: 600; text-decoration: none; color: inherit; display: flex; align-items: center; gap: 5px; }\r\n\r\n        /* === PRECISION HEADER & FILTERS === */\r\n        .dv-table-wrapper { width: 100%; margin-bottom: 2rem; position: relative; }\r\n        \r\n        /* Header Styling */\r\n        table.dataTable thead tr:first-child th {\r\n            background: var(--dv-header-bg) !important;\r\n            padding: 12px 18px !important;\r\n            font-weight: 700 !important;\r\n            border-bottom: 2px solid var(--bs-border-color) !important;\r\n            vertical-align: middle !important;\r\n        }\r\n        \r\n        /* Filter Row Styling */\r\n        .filter-row th {\r\n            padding: 4px 10px !important;\r\n            background: var(--bs-body-bg) !important;\r\n            border-bottom: 1px solid var(--bs-border-color) !important;\r\n            line-height: 1 !important;\r\n        }\r\n\r\n        .filter-input { width: 100%; border: 1px solid var(--bs-border-color); padding: 5px 10px; font-size: 0.75rem; border-radius: 6px; outline: none; transition: border-color 0.2s; }\r\n        .filter-input:focus { border-color: #00bcd4; box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.1); }\r\n\r\n        /* SearchPanes Styling */\r\n        .dtsp-searchPanes { margin-bottom: 1.5rem; border: 1px solid var(--bs-border-color); border-radius: 8px; padding: 15px; background: var(--bs-body-bg); }\r\n\r\n        .dv-controls-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 12px; }\r\n        .dv-search-group { display: flex; align-items: center; gap: 15px; }\r\n        .dv-summary-stats { display: flex; gap: 10px; font-size: 0.85rem; color: var(--bs-secondary-color); border-right: 1px solid var(--bs-border-color); padding-right: 15px; }\r\n        .dv-stat-badge { background: var(--bs-secondary-bg); padding: 2px 8px; border-radius: 4px; font-weight: 600; color: #00bcd4; }\r\n\r\n        /* Unified Button Group Styling (v11.0) */\r\n        .dt-buttons {\r\n            display: inline-flex !important;\r\n            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\r\n            border-radius: 8px;\r\n            overflow: hidden;\r\n            border: 1px solid var(--bs-border-color);\r\n        }\r\n        .btn-advanced-filters, .dt-button {\r\n            margin: 0 !important;\r\n            border: none !important;\r\n            border-radius: 0 !important;\r\n            padding: 8px 18px !important;\r\n            font-size: 0.85rem !important;\r\n            height: 38px;\r\n            display: flex;\r\n            align-items: center;\r\n            font-weight: 500 !important;\r\n            transition: all 0.2s !important;\r\n        }\r\n        .btn-advanced-filters {\r\n            background-color: #00bcd4 !important;\r\n            color: white !important;\r\n            border-right: 1px solid rgba(0,0,0,0.1) !important;\r\n        }\r\n        .dt-button {\r\n            background-color: #6c757d !important;\r\n            color: white !important;\r\n            border-right: 1px solid rgba(255,255,255,0.1) !important;\r\n        }\r\n        .dt-button:last-child { border-right: none !important; }\r\n        .dt-button:hover { background-color: #5a6268 !important; }\r\n        .btn-advanced-filters:hover { background-color: #00acc1 !important; }\r\n\r\n        .dataTables_scrollBody { border: 1px solid var(--bs-border-color); border-radius: 0 0 8px 8px; }\r\n        .dataTables_scrollHead { border: 1px solid var(--bs-border-color); border-bottom: none; border-radius: 8px 8px 0 0; background: var(--dv-header-bg); }\r\n\r\n        table.dataTable { width: 100% !important; margin: 0 !important; table-layout: auto !important; border-collapse: collapse !important; }\r\n        table.dataTable th, table.dataTable td { white-space: nowrap !important; vertical-align: middle; padding: 12px 18px !important; border: 1px solid var(--bs-border-color); min-width: 120px; }\r\n\r\n        .dataTables_paginate { display: flex; justify-content: flex-end; margin-top: 10px; font-size: 0.8rem; }\r\n        \r\n        /* RICH FORMATTING */\r\n        .dv-pos { color: #28a745 !important; font-weight: 600; }\r\n        .dv-neg { color: #dc3545 !important; font-weight: 600; }\r\n        .dv-card { background: var(--bs-body-bg); border: 1px solid var(--bs-border-color); border-radius: 8px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }\r\n    </style>\r\n    <style>${libs.css || \"\"}</style>\r\n    `;\r\n\r\n    const parts = [];\r\n    parts.push(`<!DOCTYPE html><html lang=\"en\" data-bs-theme=\"light\"><head><meta charset=\"UTF-8\"><title>${workbookName}</title>${styles}</head><body>`);\r\n\r\n    // --- 1. DASHBOARD OVERVIEW ---\r\n    parts.push(`\r\n    <div id=\"dashboard-view\" class=\"view-section active\">\r\n        <div class=\"dashboard-container\">\r\n            <div class=\"dashboard-header\">\r\n                <div style=\"font-size: 1.5rem; font-weight: bold; margin-bottom: 20px;\">\r\n                    <img src=\"https://Harry-0402.github.io/DataVista/assets/icon-32.png\" width=\"32\" height=\"32\" style=\"margin-right: 10px;\">\r\n                    DataVista Report\r\n                </div>\r\n                <h1 class=\"dashboard-title\">${workbookName}</h1>\r\n                <p class=\"dashboard-meta\">Generated on ${timestamp} &bull; ${sheetNames.length} Sheets &bull; v1.2.1 (Analytics Edition)</p>\r\n            </div>\r\n            <div class=\"sheet-grid\">\r\n    `);\r\n\r\n    sheetNames.forEach((name, index) => {\r\n        parts.push(`\r\n        <div class=\"sheet-card\" onclick=\"showSheet('${index}')\">\r\n            <svg width=\"40\" height=\"40\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"></path></svg>\r\n            <div class=\"sheet-name\">${name}</div>\r\n        </div>\r\n        `);\r\n    });\r\n    parts.push(`</div></div></div>`);\r\n\r\n    // --- 2. INDIVIDUAL SHEET VIEWS ---\r\n    sheetNames.forEach((name, index) => {\r\n        const rows = data[name];\r\n        const header = rows.length > 0 ? rows[0] : [];\r\n        const body = rows.length > 0 ? rows.slice(1).filter(r => r.some(c => c !== null && c !== undefined && c.toString().trim() !== \"\")) : [];\r\n\r\n        const colCount = header.length;\r\n        let fontSizeVal = 1.0;\r\n        if (colCount > 6) {\r\n            fontSizeVal = Math.max(0.75, 1.0 - ((colCount - 6) * 0.04));\r\n        }\r\n        const fontSizeStr = fontSizeVal.toFixed(2) + \"rem\";\r\n\r\n        parts.push(`\r\n        <div id=\"sheet-view-${index}\" class=\"view-section\">\r\n            <div class=\"sheet-header\">\r\n                <a class=\"btn-back\" onclick=\"showDashboard()\">\r\n                    <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" viewBox=\"0 0 24 24\"><path d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/></svg>\r\n                    Back to Dashboard\r\n                </a>\r\n                <div style=\"font-weight: bold;\">${name}</div>\r\n                <div onclick=\"document.documentElement.setAttribute('data-bs-theme', document.documentElement.getAttribute('data-bs-theme')==='dark'?'light':'dark')\" style=\"cursor: pointer;\">Theme</div>\r\n            </div>\r\n            <div class=\"container-fluid\" style=\"padding: 0 20px;\">\r\n                <ul class=\"nav nav-pills mb-3 justify-content-center\" role=\"tablist\">\r\n                    <li class=\"nav-item\"><a class=\"nav-link active\" data-bs-toggle=\"pill\" href=\"#sheet-${index}-data\">Data</a></li>\r\n                    <li class=\"nav-item\"><a class=\"nav-link\" data-bs-toggle=\"pill\" href=\"#sheet-${index}-stats\">Analytics</a></li>\r\n                </ul>\r\n                <div class=\"tab-content\">\r\n                    <div id=\"sheet-${index}-data\" class=\"tab-pane fade show active\">\r\n                        <div class=\"dv-table-wrapper\">\r\n                            <table class=\"table table-striped table-hover display table-bordered\" style=\"width:100% !important; font-size:${fontSizeStr};\">\r\n                                <thead>\r\n                                    <tr>${header.map(h => `<th>${h || \"\"}</th>`).join('')}</tr>\r\n                                    <tr class=\"filter-row\">${header.map(() => `<th></th>`).join('')}</tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    ${body.map(r => `<tr>${r.map(c => `<td>${c || \"\"}</td>`).join('')}</tr>`).join('')}\r\n                                </tbody>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                    <div id=\"sheet-${index}-stats\" class=\"tab-pane fade\">\r\n                        <div class=\"row\">\r\n                            <div class=\"col-md-4\">\r\n                                <div class=\"dv-card mb-3\">\r\n                                    <h6>Metadata</h6>\r\n                                    <p class=\"small mb-1 text-muted\">Total Rows: <strong>${body.length}</strong></p>\r\n                                    <p class=\"small mb-1 text-muted\">Total Columns: <strong>${header.length}</strong></p>\r\n                                    <p class=\"small mb-3 text-muted\">Sheet: <strong>${name}</strong></p>\r\n                                    <div class=\"alert alert-secondary py-2 small\">Analytics calculated on raw selection.</div>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"col-md-8\">\r\n                                <div class=\"dv-card\">\r\n                                    <h6>Column Statistics</h6>\r\n                                    <div class=\"table-responsive\">\r\n                                        <table class=\"table table-sm small\">\r\n                                            <thead><tr><th>Column</th><th>Sum</th><th>Avg</th></tr></thead>\r\n                                            <tbody>\r\n                                                ${header.map((h, colIdx) => {\r\n            const vals = body.map(r => {\r\n                const v = r[colIdx];\r\n                const n = parseFloat(v?.toString().replace(/[^0-9.-]+/g, \"\"));\r\n                return isNaN(n) ? null : n;\r\n            }).filter(v => v !== null);\r\n            if (vals.length === 0) return '';\r\n            const s = vals.reduce((a, b) => a + b, 0);\r\n            return `<tr><td>${h}</td><td>${s.toLocaleString()}</td><td>${(s / vals.length).toLocaleString()}</td></tr>`;\r\n        }).join('')}\r\n                                            </tbody>\r\n                                        </table>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        `);\r\n    });\r\n\r\n    parts.push(`\r\n    <div class=\"modal fade\" id=\"searchBuilderModal\" tabindex=\"-1\"><div class=\"modal-dialog modal-xl\"><div class=\"modal-content\"><div class=\"modal-body\" id=\"sb-modal-body\"></div></div></div></div>\r\n    `);\r\n\r\n    // --- 3. SCRIPTS ---\r\n    parts.push(`<script>${libs.js || \"\"}</script>`);\r\n    parts.push(`<script>\r\n        function showDashboard() { $('.view-section').removeClass('active'); $('#dashboard-view').addClass('active'); }\r\n        function showSheet(index) {\r\n            $('.view-section').removeClass('active');\r\n            $('#sheet-view-' + index).addClass('active');\r\n            $.fn.dataTable.tables({ visible: true, api: true }).columns.adjust();\r\n        }\r\n\r\n        $(document).ready(function () {\r\n            $('table.display').each(function () {\r\n                var table = $(this);\r\n                table.DataTable({\r\n                    dom: 'P<\"dv-controls-row\"B<\"dv-search-group\"f>>t<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\r\n                    orderCellsTop: true,\r\n                    searchPanes: { cascadePanes: true, viewTotal: true, layout: 'columns-3' },\r\n                    autoWidth: false, scrollX: true, scrollCollapse: true, pageLength: 20,\r\n                    rowCallback: function (row, data) {\r\n                        $('td', row).each(function () {\r\n                            var text = $(this).text().trim();\r\n                            var val = parseFloat(text.replace(/[^0-9.-]+/g, \"\"));\r\n                            if (!isNaN(val) && !text.includes('/') && !text.includes('-20') && text.length < 15) {\r\n                                if (val > 0) $(this).addClass('dv-pos');\r\n                                else if (val < 0) $(this).addClass('dv-neg');\r\n                            }\r\n                        });\r\n                    },\r\n                    buttons: [\r\n                        {\r\n                            text: 'Advanced Filters', className: 'btn-advanced-filters',\r\n                            action: function (e, dt) {\r\n                                $('#sb-modal-body').empty();\r\n                                var sb = new $.fn.dataTable.SearchBuilder(dt, {});\r\n                                $('#sb-modal-body').append(sb.getNode());\r\n                                $('#searchBuilderModal').modal('show');\r\n                            }\r\n                        },\r\n                        'copy', 'csv', 'excel', 'pdf', 'print', 'colvis'\r\n                    ],\r\n                    initComplete: function () {\r\n                        var api = this.api();\r\n                        var rowCount = api.rows().count();\r\n                        var colCount = api.columns().count();\r\n                        var statsHtml = '<div class=\"dv-summary-stats\">' +\r\n                            '<span>Total Rows: <span class=\"dv-stat-badge\">' + rowCount + '</span></span>' +\r\n                            '<span>Total Columns: <span class=\"dv-stat-badge\">' + colCount + '</span></span>' +\r\n                            '</div>';\r\n                        $(this).closest('.dv-table-wrapper').find('.dv-search-group').prepend(statsHtml);\r\n\r\n                        $(api.table().header()).find('tr.filter-row th').each(function (colIdx) {\r\n                            $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" />')\r\n                                .appendTo(this)\r\n                                .on('keyup change', function (e) {\r\n                                    e.stopPropagation();\r\n                                    api.column(colIdx).search(this.value).draw();\r\n                                });\r\n                        });\r\n                        setTimeout(function () { api.columns.adjust(); }, 150);\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    </script></body></html>`);\r\n\r\n    return new Blob([parts.join(\"\")], { type: \"text/html\" });\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\nimport { trimEmptyGrid } from \"../utils/data-utils\";\r\nimport { generateHTML } from \"../taskpane/generators\";\r\nimport { generateWorkbookHTML } from \"../taskpane/workbook_generators\";\r\n\r\n// Define library URLs for offline bundling (Same as taskpane.js)\r\nconst LIB_URLS = {\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\",\r\n    searchpanes_css: \"https://cdn.datatables.net/searchpanes/2.2.0/css/searchPanes.bootstrap5.min.css\",\r\n    searchpanes_js: \"https://cdn.datatables.net/searchpanes/2.2.0/js/dataTables.searchPanes.min.js\",\r\n    searchpanes_bs5_js: \"https://cdn.datatables.net/searchpanes/2.2.0/js/searchPanes.bootstrap5.min.js\",\r\n    select_css: \"https://cdn.datatables.net/select/1.7.0/css/select.bootstrap5.min.css\",\r\n    select_js: \"https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js\"\r\n};\r\n\r\nOffice.onReady(() => {\r\n    // If needed, Office.js is ready to be called\r\n});\r\n\r\n/**\r\n * Exports the currently selected range.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportSelection(event) {\r\n    await runHeadlessExport(\"selection\", event);\r\n}\r\n\r\n/**\r\n * Exports the entire workbook.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportWorkbook(event) {\r\n    await runHeadlessExport(\"workbook\", event);\r\n}\r\n\r\nasync function runHeadlessExport(source, event) {\r\n    try {\r\n        // Show a \"working\" indicator (not really possible without UI, but we can prevent timeout)\r\n        // Default Options\r\n        const options = {\r\n            stats: true,\r\n            info: true,\r\n            desc: true,\r\n            rich: true,\r\n            workbookName: \"Report\"\r\n        };\r\n\r\n        let data = {};\r\n        let sheetNames = [];\r\n\r\n        await Excel.run(async (context) => {\r\n            const workbook = context.workbook;\r\n            workbook.load(\"name\");\r\n            await context.sync();\r\n            options.workbookName = workbook.name || \"Report\";\r\n\r\n            if (source === \"selection\") {\r\n                const range = context.workbook.getSelectedRange();\r\n                range.load(\"values\");\r\n                await context.sync();\r\n\r\n                // Trim empty\r\n                const trimmed = trimEmptyGrid(range.values);\r\n                if (!trimmed) throw new Error(\"Selection is empty\");\r\n\r\n                data[\"Selection\"] = trimmed;\r\n                sheetNames.push(\"Selection\");\r\n            } else {\r\n                const sheets = context.workbook.worksheets;\r\n                sheets.load(\"items/name\");\r\n                await context.sync();\r\n\r\n                const sheetRanges = sheets.items.map(sheet => {\r\n                    const rng = sheet.getUsedRangeOrNullObject();\r\n                    rng.load(\"values, rowCount\");\r\n                    return { name: sheet.name, rng: rng };\r\n                });\r\n                await context.sync();\r\n\r\n                for (let item of sheetRanges) {\r\n                    if (!item.rng.isNullObject && item.rng.rowCount > 0) {\r\n                        const trimmed = trimEmptyGrid(item.rng.values);\r\n                        if (trimmed) {\r\n                            data[item.name] = trimmed;\r\n                            sheetNames.push(item.name);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        if (sheetNames.length === 0) throw new Error(\"No data found.\");\r\n\r\n        // Fetch Libs\r\n        const libs = await fetchOfflineLibs();\r\n\r\n        let blob;\r\n        if (source === \"workbook\") {\r\n            blob = generateWorkbookHTML(data, sheetNames, options, libs); // From workbook_generators.js\r\n        } else {\r\n            blob = generateHTML(data, sheetNames, options, libs); // From generators.js\r\n        }\r\n\r\n        // Trigger Download\r\n        const url = URL.createObjectURL(blob);\r\n\r\n        // In FunctionFile, we have a hidden DOM. Creating an anchor usually works.\r\n        const a = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = `DataVista_${options.workbookName}_${new Date().getTime()}.html`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n\r\n        // Success Notification?\r\n        // Office.context.ui.displayDialogAsync is only for opening windows.\r\n        // We assume download started.\r\n\r\n    } catch (error) {\r\n        console.error(error);\r\n        // If error, show a dialog? Or just silent fail?\r\n        // Since we are headless, we can't show alerts easily unless we use displayDialogAsync\r\n    } finally {\r\n        event.completed();\r\n    }\r\n}\r\n\r\nasync function fetchOfflineLibs() {\r\n    const urls = LIB_URLS;\r\n    const load = async (url) => {\r\n        try {\r\n            const r = await fetch(url);\r\n            if (!r.ok) throw new Error(url);\r\n            return await r.text();\r\n        } catch (e) {\r\n            return `/* Failed: ${url} */`;\r\n        }\r\n    };\r\n\r\n    const cssKeys = ['bootstrap_css', 'datatables_css', 'buttons_css', 'searchbuilder_css', 'dateTime_css'];\r\n    const jsKeys = [\r\n        'jquery', 'bootstrap_js', 'datatables_js', 'datatables_bs5_js',\r\n        'jszip', 'pdfmake', 'vfs_fonts',\r\n        'buttons_js', 'buttons_bs5_js', 'buttons_colvis_js', 'buttons_html5_js', 'buttons_print_js',\r\n        'dateTime_js', 'searchbuilder_js', 'searchbuilder_bs5_js'\r\n    ];\r\n\r\n    const [cssArr, jsArr] = await Promise.all([\r\n        Promise.all(cssKeys.map(k => load(urls[k]))),\r\n        Promise.all(jsKeys.map(k => load(urls[k])))\r\n    ]);\r\n\r\n    return {\r\n        css: cssArr.join(\"\\n\"),\r\n        js: jsArr.join(\"\\n\")\r\n    };\r\n}\r\n\r\nconst g = getGlobal();\r\ng.exportSelection = exportSelection;\r\ng.exportWorkbook = exportWorkbook;\r\n\r\nfunction getGlobal() {\r\n    return typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : typeof global !== \"undefined\" ? global : undefined;\r\n}\r\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();"],"names":["__webpack_require__","trimEmptyGrid","data","length","minRow","maxRow","minCol","maxCol","r","c","val","trimmed","push","slice","generateHTML","sheetNames","options","libs","parts","concat","css","timestamp","Date","toLocaleString","sheetName","info","stats","forEach","name","i","rows","hasHeader","header","body","filter","some","toString","trim","colCount","fontSizeVal","Math","max","fontSizeStr","toFixed","h","row","cell","columnStats","map","colIdx","values","num","parseFloat","replace","isNaN","v","sum","reduce","a","b","label","count","avg","min","apply","_toConsumableArray","s","undefined","minimumFractionDigits","maximumFractionDigits","join","js","Blob","type","generateWorkbookHTML","workbookName","styles","index","vals","n","e","t","Symbol","iterator","o","toStringTag","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","d","bind","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","_next","_throw","g","globalThis","this","Function","window","LIB_URLS","bootstrap_css","datatables_css","buttons_css","searchbuilder_css","dateTime_css","searchpanes_css","select_css","jquery","bootstrap_js","datatables_js","datatables_bs5_js","jszip","pdfmake","vfs_fonts","buttons_js","buttons_bs5_js","buttons_colvis_js","buttons_html5_js","buttons_print_js","dateTime_js","searchbuilder_js","searchbuilder_bs5_js","searchpanes_js","searchpanes_bs5_js","select_js","_exportSelection","_callee","event","_context","runHeadlessExport","_exportWorkbook","_callee2","_context2","_x3","_x4","_runHeadlessExport","_callee4","source","blob","url","_t","_context4","desc","rich","Excel","run","_ref","_callee3","context","workbook","range","sheets","sheetRanges","_iterator","_step","item","_trimmed","_context3","load","sync","getSelectedRange","Error","worksheets","items","sheet","rng","getUsedRangeOrNullObject","_createForOfIteratorHelper","isNullObject","rowCount","err","_x5","fetchOfflineLibs","URL","createObjectURL","document","createElement","href","download","getTime","appendChild","click","removeChild","console","error","completed","_fetchOfflineLibs","_callee6","urls","cssKeys","jsKeys","_yield$Promise$all","_yield$Promise$all2","cssArr","jsArr","_context6","_ref2","_callee5","_context5","fetch","ok","text","_x6","all","k","_slicedToArray","Office","onReady","self","global","exportSelection","_x","exportWorkbook","_x2"],"ignoreList":[],"sourceRoot":""}