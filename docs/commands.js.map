{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://datavista-excel-addin/webpack/bootstrap","webpack://datavista-excel-addin/./src/utils/data-utils.js","webpack://datavista-excel-addin/./src/commands/commands.js","webpack://datavista-excel-addin/webpack/runtime/global"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","\r\n/**\r\n * Trims empty rows and columns from a 2D array.\r\n * @param {any[][]} data \r\n * @returns {any[][] | null} Trimmed data or null if empty\r\n */\r\nexport function trimEmptyGrid(data) {\r\n    if (!data || data.length === 0) return null;\r\n\r\n    let minRow = data.length;\r\n    let maxRow = -1;\r\n    let minCol = data[0].length;\r\n    let maxCol = -1;\r\n\r\n    // 1. Find Bounds\r\n    for (let r = 0; r < data.length; r++) {\r\n        for (let c = 0; c < data[r].length; c++) {\r\n            const val = data[r][c];\r\n            if (val !== \"\" && val !== null && val !== undefined) {\r\n                if (r < minRow) minRow = r;\r\n                if (r > maxRow) maxRow = r;\r\n                if (c < minCol) minCol = c;\r\n                if (c > maxCol) maxCol = c;\r\n            }\r\n        }\r\n    }\r\n\r\n    // 2. Check if empty\r\n    if (maxRow === -1) return null;\r\n\r\n    // 3. Slice\r\n    const trimmed = [];\r\n    for (let r = minRow; r <= maxRow; r++) {\r\n        trimmed.push(data[r].slice(minCol, maxCol + 1));\r\n    }\r\n\r\n    return trimmed;\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\nimport { trimEmptyGrid } from \"../utils/data-utils\";\r\n\r\n// Define library URLs for offline bundling (Same as taskpane.js)\r\nconst LIB_URLS = {\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\"\r\n};\r\n\r\nOffice.onReady(() => {\r\n    // If needed, Office.js is ready to be called\r\n});\r\n\r\n/**\r\n * Exports the currently selected range.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportSelection(event) {\r\n    await runHeadlessExport(\"selection\", event);\r\n}\r\n\r\n/**\r\n * Exports the entire workbook.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportWorkbook(event) {\r\n    await runHeadlessExport(\"workbook\", event);\r\n}\r\n\r\nasync function runHeadlessExport(source, event) {\r\n    try {\r\n        // Show a \"working\" indicator (not really possible without UI, but we can prevent timeout)\r\n        // Default Options\r\n        const options = {\r\n            stats: true,\r\n            info: true,\r\n            desc: true,\r\n            rich: true,\r\n            workbookName: \"Report\"\r\n        };\r\n\r\n        let data = {};\r\n        let sheetNames = [];\r\n\r\n        await Excel.run(async (context) => {\r\n            const workbook = context.workbook;\r\n            workbook.load(\"name\");\r\n            await context.sync();\r\n            options.workbookName = workbook.name || \"Report\";\r\n\r\n            if (source === \"selection\") {\r\n                const range = context.workbook.getSelectedRange();\r\n                range.load(\"values\");\r\n                await context.sync();\r\n\r\n                // Trim empty\r\n                const trimmed = trimEmptyGrid(range.values);\r\n                if (!trimmed) throw new Error(\"Selection is empty\");\r\n\r\n                data[\"Selection\"] = trimmed;\r\n                sheetNames.push(\"Selection\");\r\n            } else {\r\n                const sheets = context.workbook.worksheets;\r\n                sheets.load(\"items/name\");\r\n                await context.sync();\r\n\r\n                const sheetRanges = sheets.items.map(sheet => {\r\n                    const rng = sheet.getUsedRangeOrNullObject();\r\n                    rng.load(\"values, rowCount\");\r\n                    return { name: sheet.name, rng: rng };\r\n                });\r\n                await context.sync();\r\n\r\n                for (let item of sheetRanges) {\r\n                    if (!item.rng.isNullObject && item.rng.rowCount > 0) {\r\n                        const trimmed = trimEmptyGrid(item.rng.values);\r\n                        if (trimmed) {\r\n                            data[item.name] = trimmed;\r\n                            sheetNames.push(item.name);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        if (sheetNames.length === 0) throw new Error(\"No data found.\");\r\n\r\n        // Fetch Libs\r\n        const libs = await fetchOfflineLibs();\r\n\r\n        let blob;\r\n        if (source === \"workbook\") {\r\n            blob = generateWorkbookHTML(data, sheetNames, options, libs); // From workbook_generators.js\r\n        } else {\r\n            blob = generateHTML(data, sheetNames, options, libs); // From generators.js\r\n        }\r\n\r\n        // Trigger Download\r\n        const url = URL.createObjectURL(blob);\r\n\r\n        // In FunctionFile, we have a hidden DOM. Creating an anchor usually works.\r\n        const a = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = `DataVista_${options.workbookName}_${new Date().getTime()}.html`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n\r\n        // Success Notification?\r\n        // Office.context.ui.displayDialogAsync is only for opening windows.\r\n        // We assume download started.\r\n\r\n    } catch (error) {\r\n        console.error(error);\r\n        // If error, show a dialog? Or just silent fail?\r\n        // Since we are headless, we can't show alerts easily unless we use displayDialogAsync\r\n    } finally {\r\n        event.completed();\r\n    }\r\n}\r\n\r\nasync function fetchOfflineLibs() {\r\n    const urls = LIB_URLS;\r\n    const load = async (url) => {\r\n        try {\r\n            const r = await fetch(url);\r\n            if (!r.ok) throw new Error(url);\r\n            return await r.text();\r\n        } catch (e) {\r\n            return `/* Failed: ${url} */`;\r\n        }\r\n    };\r\n\r\n    const cssKeys = ['bootstrap_css', 'datatables_css', 'buttons_css', 'searchbuilder_css', 'dateTime_css'];\r\n    const jsKeys = [\r\n        'jquery', 'bootstrap_js', 'datatables_js', 'datatables_bs5_js',\r\n        'jszip', 'pdfmake', 'vfs_fonts',\r\n        'buttons_js', 'buttons_bs5_js', 'buttons_colvis_js', 'buttons_html5_js', 'buttons_print_js',\r\n        'dateTime_js', 'searchbuilder_js', 'searchbuilder_bs5_js'\r\n    ];\r\n\r\n    const [cssArr, jsArr] = await Promise.all([\r\n        Promise.all(cssKeys.map(k => load(urls[k]))),\r\n        Promise.all(jsKeys.map(k => load(urls[k])))\r\n    ]);\r\n\r\n    return {\r\n        css: cssArr.join(\"\\n\"),\r\n        js: jsArr.join(\"\\n\")\r\n    };\r\n}\r\n\r\nconst g = getGlobal();\r\ng.exportSelection = exportSelection;\r\ng.exportWorkbook = exportWorkbook;\r\n\r\nfunction getGlobal() {\r\n    return typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : typeof global !== \"undefined\" ? global : undefined;\r\n}\r\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();"],"names":["__webpack_require__","trimEmptyGrid","data","length","minRow","maxRow","minCol","maxCol","r","c","val","trimmed","push","slice","e","t","Symbol","n","iterator","o","toStringTag","i","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","g","globalThis","this","Function","window","LIB_URLS","jquery","bootstrap_css","bootstrap_js","datatables_css","datatables_js","datatables_bs5_js","buttons_css","buttons_js","buttons_bs5_js","jszip","pdfmake","vfs_fonts","buttons_html5_js","buttons_print_js","buttons_colvis_js","searchbuilder_css","searchbuilder_js","searchbuilder_bs5_js","dateTime_css","dateTime_js","_exportSelection","_callee","event","_context","runHeadlessExport","_exportWorkbook","_callee2","_context2","_x3","_x4","_runHeadlessExport","_callee4","source","options","sheetNames","libs","blob","url","_t","_context4","stats","info","desc","rich","workbookName","Excel","run","_ref","_callee3","context","workbook","range","sheets","sheetRanges","_iterator","_step","item","_trimmed","_context3","load","sync","name","getSelectedRange","values","Error","worksheets","items","map","sheet","rng","getUsedRangeOrNullObject","_createForOfIteratorHelper","s","isNullObject","rowCount","err","_x5","fetchOfflineLibs","generateWorkbookHTML","generateHTML","URL","createObjectURL","document","createElement","href","download","concat","Date","getTime","body","appendChild","click","removeChild","console","error","completed","_fetchOfflineLibs","_callee6","urls","cssKeys","jsKeys","_yield$Promise$all","_yield$Promise$all2","cssArr","jsArr","_context6","_ref2","_callee5","_context5","fetch","ok","text","_x6","all","k","_slicedToArray","css","join","js","Office","onReady","self","global","undefined","exportSelection","_x","exportWorkbook","_x2"],"ignoreList":[],"sourceRoot":""}