{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://datavista-excel-addin/webpack/bootstrap","webpack://datavista-excel-addin/./src/utils/grid.js","webpack://datavista-excel-addin/webpack/runtime/global","webpack://datavista-excel-addin/./src/utils/settings.js","webpack://datavista-excel-addin/./src/commands/commands.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","\r\n/**\r\n * Trims empty rows and columns from a 2D array.\r\n * @param {any[][]} data \r\n * @returns {any[][] | null} Trimmed data or null if empty\r\n */\r\nexport function trimEmptyGrid(data) {\r\n    if (!data || data.length === 0) return null;\r\n\r\n    let minRow = data.length;\r\n    let maxRow = -1;\r\n    let minCol = data[0].length;\r\n    let maxCol = -1;\r\n\r\n    // 1. Find Bounds\r\n    for (let r = 0; r < data.length; r++) {\r\n        for (let c = 0; c < data[r].length; c++) {\r\n            const val = data[r][c];\r\n            if (val !== \"\" && val !== null && val !== undefined) {\r\n                if (r < minRow) minRow = r;\r\n                if (r > maxRow) maxRow = r;\r\n                if (c < minCol) minCol = c;\r\n                if (c > maxCol) maxCol = c;\r\n            }\r\n        }\r\n    }\r\n\r\n    // 2. Check if empty\r\n    if (maxRow === -1) return null;\r\n\r\n    // 3. Slice\r\n    const trimmed = [];\r\n    for (let r = minRow; r <= maxRow; r++) {\r\n        trimmed.push(data[r].slice(minCol, maxCol + 1));\r\n    }\r\n\r\n    return trimmed;\r\n}\r\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","\r\nconst STORAGE_KEY = \"DataVista_Settings\";\r\n\r\nconst DEFAULTS = {\r\n    stats: true,\r\n    info: true,\r\n    desc: false,\r\n    rich: true,\r\n    theme: 'light'\r\n};\r\n\r\n/**\r\n * Gets the current settings, merging with defaults.\r\n * @returns {typeof DEFAULTS}\r\n */\r\nexport function getSettings() {\r\n    try {\r\n        const stored = localStorage.getItem(STORAGE_KEY);\r\n        if (stored) {\r\n            return { ...DEFAULTS, ...JSON.parse(stored) };\r\n        }\r\n    } catch (e) {\r\n        console.warn(\"Failed to read settings\", e);\r\n    }\r\n    return { ...DEFAULTS };\r\n}\r\n\r\n/**\r\n * Updates a specific setting key.\r\n * @param {keyof DEFAULTS} key \r\n * @param {boolean|string} value \r\n */\r\nexport function updateSetting(key, value) {\r\n    const current = getSettings();\r\n    current[key] = value;\r\n    try {\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(current));\r\n    } catch (e) {\r\n        console.warn(\"Failed to save settings\", e);\r\n    }\r\n    return current;\r\n}\r\n\r\n/**\r\n * Toggles a boolean setting.\r\n * @param {keyof DEFAULTS} key \r\n * @returns {boolean} The new value\r\n */\r\nexport function toggleSetting(key) {\r\n    const current = getSettings();\r\n    const newValue = !current[key];\r\n    updateSetting(key, newValue);\r\n    return newValue;\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\n// Define library URLs for offline bundling (Same as taskpane.js)\r\nimport { trimEmptyGrid } from \"../utils/grid\";\r\nimport { getSettings, toggleSetting, updateSetting } from \"../utils/settings\";\r\n\r\nconst LIB_URLS = {\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\"\r\n};\r\n\r\nOffice.onReady(() => {\r\n    // If needed, Office.js is ready to be called\r\n});\r\n\r\n/**\r\n * Toggle Commands\r\n */\r\nfunction toggleStats(event) {\r\n    toggleSetting('stats');\r\n    event.completed();\r\n}\r\nfunction toggleInfo(event) {\r\n    toggleSetting('info');\r\n    event.completed();\r\n}\r\nfunction toggleDesc(event) {\r\n    toggleSetting('desc');\r\n    event.completed();\r\n}\r\nfunction toggleRich(event) {\r\n    toggleSetting('rich');\r\n    event.completed();\r\n}\r\nfunction toggleDark(event) {\r\n    const s = getSettings();\r\n    const newTheme = s.theme === 'dark' ? 'light' : 'dark';\r\n    updateSetting('theme', newTheme);\r\n    event.completed();\r\n}\r\n\r\n/**\r\n * Exports the currently selected range.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportSelection(event) {\r\n    await runHeadlessExport(\"selection\", event);\r\n}\r\n\r\n/**\r\n * Exports the entire workbook.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportWorkbook(event) {\r\n    await runHeadlessExport(\"workbook\", event);\r\n}\r\n\r\nasync function runHeadlessExport(source, event) {\r\n    try {\r\n        // Load Settings\r\n        const settings = getSettings();\r\n\r\n        const options = {\r\n            stats: settings.stats,\r\n            info: settings.info,\r\n            desc: settings.desc,\r\n            rich: settings.rich,\r\n            workbookName: \"Report\",\r\n            theme: settings.theme // Pass theme to generator\r\n        };\r\n\r\n        let data = {};\r\n        let sheetNames = [];\r\n\r\n        await Excel.run(async (context) => {\r\n            const workbook = context.workbook;\r\n            workbook.load(\"name\");\r\n            await context.sync();\r\n            options.workbookName = workbook.name || \"Report\";\r\n\r\n            if (source === \"selection\") {\r\n                const range = context.workbook.getSelectedRange();\r\n                range.load(\"values\");\r\n                await context.sync();\r\n\r\n                // Trim empty\r\n                const trimmed = trimEmptyGrid(range.values);\r\n                if (!trimmed) throw new Error(\"Selection is empty\");\r\n\r\n                data[\"Selection\"] = trimmed;\r\n                sheetNames.push(\"Selection\");\r\n            } else {\r\n                const sheets = context.workbook.worksheets;\r\n                sheets.load(\"items/name\");\r\n                await context.sync();\r\n\r\n                const sheetRanges = sheets.items.map(sheet => {\r\n                    const rng = sheet.getUsedRangeOrNullObject();\r\n                    rng.load(\"values, rowCount\");\r\n                    return { name: sheet.name, rng: rng };\r\n                });\r\n                await context.sync();\r\n\r\n                for (let item of sheetRanges) {\r\n                    if (!item.rng.isNullObject && item.rng.rowCount > 0) {\r\n                        const trimmed = trimEmptyGrid(item.rng.values);\r\n                        if (trimmed) {\r\n                            data[item.name] = trimmed;\r\n                            sheetNames.push(item.name);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        if (sheetNames.length === 0) throw new Error(\"No data found.\");\r\n\r\n        // Fetch Libs\r\n        const libs = await fetchOfflineLibs();\r\n\r\n        let blob;\r\n        if (source === \"workbook\") {\r\n            blob = generateWorkbookHTML(data, sheetNames, options, libs); // From workbook_generators.js\r\n        } else {\r\n            blob = generateHTML(data, sheetNames, options, libs); // From generators.js\r\n        }\r\n\r\n        // Trigger Download\r\n        const url = URL.createObjectURL(blob);\r\n\r\n        const a = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = `DataVista_${options.workbookName}_${new Date().getTime()}.html`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n\r\n    } catch (error) {\r\n        console.error(error);\r\n    } finally {\r\n        event.completed();\r\n    }\r\n}\r\n\r\nasync function fetchOfflineLibs() {\r\n    const urls = LIB_URLS;\r\n    const load = async (url) => {\r\n        try {\r\n            const r = await fetch(url);\r\n            if (!r.ok) throw new Error(url);\r\n            return await r.text();\r\n        } catch (e) {\r\n            return `/* Failed: ${url} */`;\r\n        }\r\n    };\r\n\r\n    const cssKeys = ['bootstrap_css', 'datatables_css', 'buttons_css', 'searchbuilder_css', 'dateTime_css'];\r\n    const jsKeys = [\r\n        'jquery', 'bootstrap_js', 'datatables_js', 'datatables_bs5_js',\r\n        'jszip', 'pdfmake', 'vfs_fonts',\r\n        'buttons_js', 'buttons_bs5_js', 'buttons_colvis_js', 'buttons_html5_js', 'buttons_print_js',\r\n        'dateTime_js', 'searchbuilder_js', 'searchbuilder_bs5_js'\r\n    ];\r\n\r\n    const [cssArr, jsArr] = await Promise.all([\r\n        Promise.all(cssKeys.map(k => load(urls[k]))),\r\n        Promise.all(jsKeys.map(k => load(urls[k])))\r\n    ]);\r\n\r\n    return {\r\n        css: cssArr.join(\"\\n\"),\r\n        js: jsArr.join(\"\\n\")\r\n    };\r\n}\r\n\r\nconst g = getGlobal();\r\ng.exportSelection = exportSelection;\r\ng.exportWorkbook = exportWorkbook;\r\ng.toggleStats = toggleStats;\r\ng.toggleInfo = toggleInfo;\r\ng.toggleDesc = toggleDesc;\r\ng.toggleRich = toggleRich;\r\ng.toggleDark = toggleDark;\r\n\r\nfunction getGlobal() {\r\n    return typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : typeof global !== \"undefined\" ? global : undefined;\r\n}\r\n"],"names":["__webpack_require__","trimEmptyGrid","data","length","minRow","maxRow","minCol","maxCol","r","c","val","trimmed","push","slice","g","globalThis","this","Function","e","window","STORAGE_KEY","DEFAULTS","stats","info","desc","rich","theme","getSettings","stored","localStorage","getItem","_objectSpread","JSON","parse","console","warn","updateSetting","key","value","current","setItem","stringify","toggleSetting","newValue","t","Symbol","n","iterator","o","toStringTag","i","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","l","TypeError","call","done","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","LIB_URLS","jquery","bootstrap_css","bootstrap_js","datatables_css","datatables_js","datatables_bs5_js","buttons_css","buttons_js","buttons_bs5_js","jszip","pdfmake","vfs_fonts","buttons_html5_js","buttons_print_js","buttons_colvis_js","searchbuilder_css","searchbuilder_js","searchbuilder_bs5_js","dateTime_css","dateTime_js","_exportSelection","_callee","event","_context","runHeadlessExport","_exportWorkbook","_callee2","_context2","_x3","_x4","_runHeadlessExport","_callee4","source","settings","options","sheetNames","libs","blob","url","_t","_context4","workbookName","Excel","run","_ref","_callee3","context","workbook","range","sheets","sheetRanges","_iterator","_step","item","_trimmed","_context3","load","sync","name","getSelectedRange","values","Error","worksheets","items","map","sheet","rng","getUsedRangeOrNullObject","_createForOfIteratorHelper","s","isNullObject","rowCount","err","_x5","fetchOfflineLibs","generateWorkbookHTML","generateHTML","URL","createObjectURL","document","createElement","href","download","concat","Date","getTime","body","appendChild","click","removeChild","error","completed","_fetchOfflineLibs","_callee6","urls","cssKeys","jsKeys","_yield$Promise$all","_yield$Promise$all2","cssArr","jsArr","_context6","_ref2","_callee5","_context5","fetch","ok","text","_x6","all","k","_slicedToArray","css","join","js","Office","onReady","self","global","undefined","exportSelection","_x","exportWorkbook","_x2","toggleStats","toggleInfo","toggleDesc","toggleRich","toggleDark"],"ignoreList":[],"sourceRoot":""}