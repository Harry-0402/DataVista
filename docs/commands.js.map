{"version":3,"file":"commands.js","mappings":";mBACA,IAAIA,EAAsB,CAAC,ECKpB,SAASC,EAAcC,GAC1B,IAAKA,GAAwB,IAAhBA,EAAKC,OAAc,OAAO,KAQvC,IANA,IAAIC,EAASF,EAAKC,OACdE,GAAU,EACVC,EAASJ,EAAK,GAAGC,OACjBI,GAAU,EAGLC,EAAI,EAAGA,EAAIN,EAAKC,OAAQK,IAC7B,IAAK,IAAIC,EAAI,EAAGA,EAAIP,EAAKM,GAAGL,OAAQM,IAAK,CACrC,IAAMC,EAAMR,EAAKM,GAAGC,GACR,KAARC,SAAcA,IACVF,EAAIJ,IAAQA,EAASI,GACrBA,EAAIH,IAAQA,EAASG,GACrBC,EAAIH,IAAQA,EAASG,GACrBA,EAAIF,IAAQA,EAASE,GAEjC,CAIJ,IAAgB,IAAZJ,EAAe,OAAO,KAI1B,IADA,IAAMM,EAAU,GACPH,EAAIJ,EAAQI,GAAKH,EAAQG,IAC9BG,EAAQC,KAAKV,EAAKM,GAAGK,MAAMP,EAAQC,EAAS,IAGhD,OAAOI,CACX,CCOO,SAASG,EAAaZ,EAAMa,EAAYC,EAASC,GACpD,IAAMC,EAAQ,GACdA,EAAMN,KAAK,yDACXM,EAAMN,KAAK,+DAGXM,EAAMN,KAAK,UAADO,OAAWF,EAAKG,KAAO,GAAE,aAGnCF,EAAMN,KAAK,m6JA+FXM,EAAMN,KAAK,iBAGX,IAAMS,GAAY,IAAIC,MAAOC,iBACvBC,EAAYT,EAAWZ,OAAS,EAAIY,EAAW,GAAK,SAmP1D,OAlPAG,EAAMN,KAAK,uaAADO,OAKkEK,EAAS,sEAAAL,OAE3CE,EAAS,2NAAAF,OAIzCH,EAAQS,KAAO,wGAA0G,GAAE,kBAAAN,OAC3HH,EAAQU,MAAQ,+GAAiH,GAAE,mbAS7IR,EAAMN,KAAK,wDAGXM,EAAMN,KAAK,4CAGXM,EAAMN,KAAK,0DAEXG,EAAWY,QAAQ,SAACC,EAAMC,GAUtB,IATA,IAAMC,EAAO5B,EAAK0B,GACZG,EAAYD,EAAK3B,OAAS,EAC1B6B,EAASD,EAAYD,EAAK,GAAK,GAC/BG,EAAOF,EAAYD,EAAKjB,MAAM,GAAK,GAGnCqB,EAAW,GACXC,EAAS,GAEN1B,EAAI,EAAGA,EAAIuB,EAAO7B,OAAQM,IAAK,CAIpC,IAHA,IAAI2B,EAAM,EACNC,GAAQ,EAEH7B,EAAI,EAAGA,EAAIyB,EAAK9B,OAAQK,IAAK,CAClC,IAAM8B,EAAIC,OAAON,EAAKzB,GAAGC,IAIzB,GAAI+B,MAAMF,GAAI,CAAED,GAAQ,EAAO,KAAO,CAClCI,KAAKC,IAAIJ,GAAKF,IAAKA,EAAMK,KAAKC,IAAIJ,GAC1C,CACAJ,EAASzB,GAAK4B,EAAQ,MAAQ,MAE9BF,EAAO1B,GAAM4B,GAASD,EAAM,EAAKA,EAAM,CAC3C,CAEAlB,EAAMN,KAAK,oDACXM,EAAMN,KAAK,yBAEXM,EAAMN,KAAK,uEACXM,EAAMN,KAAK,eACXoB,EAAOL,QAAQ,SAACgB,EAAGC,GACf,IAAMC,EAAgC,QAAnBX,EAASU,GAAkB,WAAa,aAC3D1B,EAAMN,KAAK,cAADO,OAAe0B,EAAU,MAAA1B,OAAKwB,EAAC,SAC7C,GACAzB,EAAMN,KAAK,iBAEXM,EAAMN,KAAK,WACXqB,EAAKN,QAAQ,SAAAmB,GACT5B,EAAMN,KAAK,QACXkC,EAAInB,QAAQ,SAACoB,EAAMH,GACf,IAAII,EAAUD,EAEVE,EAA6B,QAAnBf,EAASU,GAAkB,WAAa,aAClDM,EAAS,GAGb,GAAIlC,EAAQmC,KAAM,CACd,IAAMC,EAAMb,OAAOQ,GACnB,IAAKP,MAAMY,KAEHA,EAAM,IAAGH,GAAW,WAGpBd,EAAOS,GAAQ,GAAG,CAClBK,GAAW,eACX,IAAMI,EAAMZ,KAAKa,IAAI,IAAMb,KAAKC,IAAIU,GAAOjB,EAAOS,GAAS,KAC3DM,EAAS,oCAAH/B,OAAuCkC,EAAG,YACpD,CAER,CAEAnC,EAAMN,KAAK,cAADO,OAAe8B,EAAO,MAAA9B,OAAK6B,GAAO7B,OAAG+B,EAAM,SACzD,GACAhC,EAAMN,KAAK,QACf,GACAM,EAAMN,KAAK,YAEXM,EAAMN,KAAK,kBAEXM,EAAMN,KAAK,SACf,GAEAM,EAAMN,KAAK,UAGPI,EAAQS,OACRP,EAAMN,KAAK,8CACXG,EAAWY,QAAQ,SAACC,EAAMC,GACtB,IAAMC,EAAO5B,EAAK0B,GACZI,EAASF,EAAK3B,OAAS,EAAI2B,EAAK,GAAK,GACrCG,EAAOH,EAAK3B,OAAS,EAAI2B,EAAKjB,MAAM,GAAK,GAC/CK,EAAMN,KAAK,0CAADO,OAA2CS,EAAI,SAAAT,OAyKrE,SAAsBa,EAAQF,GAC1B,IAAIyB,EAAO,0GAUX,OATAvB,EAAOL,QAAQ,SAACgB,EAAGd,GACf,IAAI2B,EAAK,EAAGC,EAAU,EACtB3B,EAAKH,QAAQ,SAAAnB,GACI,KAATA,EAAEqB,IAAsB,OAATrB,EAAEqB,IAAa2B,IAC7BhB,MAAMD,OAAO/B,EAAEqB,MAAM4B,GAC9B,GACA,IAAMC,EAAQD,IAAYD,GAAMA,EAAK,EAAK,UAAY,SACtDD,GAAQ,WAAJpC,OAAewB,EAAC,aAAAxB,OAAYuC,EAAI,aAAAvC,OAAYqC,EAAE,aACtD,GACOD,EAAO,kBAClB,CArL6EI,CAAa3B,EAAQC,GAAK,UAC/F,GACAf,EAAMN,KAAK,WAIXI,EAAQU,QACRR,EAAMN,KAAK,+CACXG,EAAWY,QAAQ,SAACC,EAAMC,GACtB,IAAMC,EAAO5B,EAAK0B,GACZI,EAASF,EAAK3B,OAAS,EAAI2B,EAAK,GAAK,GACrCG,EAAOH,EAAK3B,OAAS,EAAI2B,EAAKjB,MAAM,GAAK,GAC/CK,EAAMN,KAAK,wCAADO,OAAyCS,EAAI,SAAAT,OA2KnE,SAAsBa,EAAQF,GAC1B,GAAoB,IAAhBA,EAAK3B,OAAc,MAAO,qDAG9B,IAAMuB,EAAQ,GAGdM,EAAOL,QAAQ,SAACiC,EAASC,GAErB,IAAIC,EAAa,EACXC,EAAgB,GAiBtB,GAfAjC,EAAKH,QAAQ,SAAAmB,GACT,IAAMkB,EAAYlB,EAAIe,GAEJ,KAAdG,SAAoBA,GACpBF,IAIJ,IAAMpD,EAAM6B,OAAOyB,GACdxB,MAAM9B,IAAsB,KAAdsD,GACfD,EAAcnD,KAAKF,EAE3B,GAG6B,IAAzBqD,EAAc5D,OAAlB,CAKA4D,EAAcE,KAAK,SAACC,EAAGC,GAAC,OAAKD,EAAIC,CAAC,GAClC,IAAMC,EAAQL,EAAc5D,OAEtBkE,EADMN,EAAcO,OAAO,SAACJ,EAAGC,GAAC,OAAKD,EAAIC,CAAC,EAAE,GAC/BC,EAGbG,EAAWR,EAAcO,OAAO,SAACE,EAAK9D,GAAG,OAAK8D,EAAM/B,KAAKgC,IAAI/D,EAAM2D,EAAM,EAAE,EAAE,GAAKD,EAClFM,EAAMjC,KAAKkC,KAAKJ,GAGhBK,EAAa,SAACC,GAChB,IAAMC,EAAOD,EAAI,KAAQT,EAAQ,GAC3BW,EAAQtC,KAAKuC,MAAMF,GACnBG,EAAQxC,KAAKyC,KAAKJ,GAClBK,EAASL,EAAM,EACrB,OAAOf,EAAcgB,IAAU,EAAII,GAAUpB,EAAckB,GAASE,CACxE,EAEMC,EAAM,SAACC,GAAC,OAAKA,EAAE9D,oBAAe+D,EAAW,CAAEC,sBAAuB,EAAGC,sBAAuB,GAAI,EAEtG9D,EAAMd,KAAK,CACP6E,IAAK7B,EACLQ,MAAON,EACPO,KAAMe,EAAIf,GACVK,IAAKU,EAAIV,GACTpB,IAAK8B,EAAIrB,EAAc,IACvB2B,IAAKN,EAAIR,EAAW,KACpBe,IAAKP,EAAIR,EAAW,KACpBgB,IAAKR,EAAIR,EAAW,KACpBxC,IAAKgD,EAAIrB,EAAcK,EAAQ,KA/BnC,MAFI1C,EAAMd,KAAK,CAAE6E,IAAK7B,EAASQ,MAAON,EAAYO,KAAM,IAAKK,IAAK,IAAKpB,IAAK,IAAKoC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKxD,IAAK,KAmCxH,GAGA,IAAImB,EAAO,6EAcX,OAbA7B,EAAMC,QAAQ,SAAAkE,GAAC,OAAItC,GAAQ,OAAJpC,OAAW0E,EAAEJ,IAAG,QAAO,GAC9ClC,GAAQ,uBA/DU,CAAC,QAAS,OAAQ,MAAO,MAAO,MAAO,MAAO,MAAO,OAiE7D5B,QAAQ,SAAAmE,GACdvC,GAAQ,WAAJpC,OAAe2E,EAAQ,SAC3BpE,EAAMC,QAAQ,SAAAkE,GACV,IAAMnF,EAAMmF,EAAe,QAAbC,EAAqB,MAAqB,QAAbA,EAAqB,MAAqB,QAAbA,EAAqB,MAAQA,GACrGvC,GAAQ,OAAJpC,OAAWT,EAAG,QACtB,GACA6C,GAAQ,OACZ,GAEAA,GAAQ,kBAEZ,CA5P2EwC,CAAa/D,EAAQC,GAAK,UAC7F,GACAf,EAAMN,KAAK,WAGfM,EAAMN,KAAK,UAEXM,EAAMN,KAAK,u3BAmBXM,EAAMN,KAAK,UAGXM,EAAMN,KAAK,WAADO,OAAYF,EAAK+E,IAAM,GAAE,eAEnC9E,EAAMN,KAAK,kkIAsFXM,EAAMN,KAAK,kBACJ,IAAIqF,KAAK/E,EAAO,CAAEwC,KAAM,aACnC,CCzYO,SAASwC,EAAqBhG,EAAMa,EAAYC,EAASC,GAC5D,IAAMI,GAAY,IAAIC,MAAOC,iBACvB4E,EAAenF,EAAQmF,cAAgB,WAGvCC,EAAS,qkHAAHjF,OA0EHF,EAAKG,KAAO,GAAE,kBAGjBF,EAAQ,GAsMd,OArMAA,EAAMN,KAAK,2FAADO,OAA4FgF,EAAY,YAAAhF,OAAWiF,EAAM,kBAGnIlF,EAAMN,KAAK,kkBAADO,OAQgCgF,EAAY,kEAAAhF,OACDE,EAAS,YAAAF,OAAWJ,EAAWZ,OAAM,8FAO1FY,EAAWY,QAAQ,SAACC,EAAMyE,GACtBnF,EAAMN,KAAK,0DAADO,OACoCkF,EAAK,2XAAAlF,OAErBS,EAAI,oCAGtC,GAEAV,EAAMN,KAAK,0BAIXG,EAAWY,QAAQ,SAACC,EAAMyE,GACtB,IAAMvE,EAAO5B,EAAK0B,GACZI,EAASF,EAAK3B,OAAS,EAAI2B,EAAK,GAAK,GACrCG,EAAOH,EAAK3B,OAAS,EAAI2B,EAAKjB,MAAM,GAAK,GAE/CK,EAAMN,KAAK,iCAADO,OACYkF,EAAK,odAAAlF,OAOkCS,EAAI,kXAYjEV,EAAMN,KAAK,qFAGXM,EAAMN,KAAK,eACXoB,EAAOL,QAAQ,SAAAgB,GAAC,OAAIzB,EAAMN,KAAK,OAADO,OAAQwB,GAAK,GAAE,SAAQ,GACrDzB,EAAMN,KAAK,iBAGXM,EAAMN,KAAK,WACXqB,EAAKN,QAAQ,SAAAnB,GACTU,EAAMN,KAAK,QACXJ,EAAEmB,QAAQ,SAAAlB,GACN,IAAMC,EAAOD,QAAiC,GAAKA,EACnDS,EAAMN,KAAK,OAADO,OAAQT,EAAG,SACzB,GACAQ,EAAMN,KAAK,QACf,GACAM,EAAMN,KAAK,YAEXM,EAAMN,KAAK,YAEXM,EAAMN,KAAK,eACf,GAGAM,EAAMN,KAAK,qvBAgBXM,EAAMN,KAAK,WAADO,OAAYF,EAAK+E,IAAM,GAAE,eACnC9E,EAAMN,KAAK,sMAADO,OAKcgF,EAAY,i6IA6F7B,IAAIF,KAAK,CAAC/E,EAAMoF,KAAK,KAAM,CAAE5C,KAAM,aAC9C,C,kpDC3RA,IAAA6C,EAAAC,EAAAhG,EAAA,mBAAAiG,OAAAA,OAAA,GAAApB,EAAA7E,EAAAkG,UAAA,aAAAC,EAAAnG,EAAAoG,aAAA,yBAAA/E,EAAArB,EAAA6E,EAAAsB,EAAA9E,GAAA,IAAApB,EAAA4E,GAAAA,EAAAwB,qBAAAC,EAAAzB,EAAAyB,EAAAC,EAAAC,OAAAC,OAAAxG,EAAAoG,WAAA,OAAAK,EAAAH,EAAA,mBAAAvG,EAAA6E,EAAAsB,GAAA,IAAA9E,EAAApB,EAAAsG,EAAAI,EAAA,EAAAtC,EAAA8B,GAAA,GAAAS,GAAA,EAAAC,EAAA,CAAAxC,EAAA,EAAAQ,EAAA,EAAA/C,EAAAiE,EAAArC,EAAAoD,EAAAH,EAAAG,EAAAC,KAAAhB,EAAA,GAAAe,EAAA,SAAAd,EAAAhG,GAAA,OAAAqB,EAAA2E,EAAA/F,EAAA,EAAAsG,EAAAR,EAAAc,EAAAhC,EAAA7E,EAAA0D,CAAA,YAAAoD,EAAA9G,EAAA6E,GAAA,IAAA5E,EAAAD,EAAAuG,EAAA1B,EAAAmB,EAAA,GAAAY,GAAAD,IAAAR,GAAAH,EAAA3B,EAAA1E,OAAAqG,IAAA,KAAAG,EAAA9E,EAAAgD,EAAA2B,GAAAc,EAAAD,EAAAxC,EAAA2C,EAAA3F,EAAA,GAAArB,EAAA,GAAAmG,EAAAa,IAAAnC,KAAA0B,EAAAlF,GAAApB,EAAAoB,EAAA,OAAApB,EAAA,MAAAoB,EAAA,GAAAA,EAAA,GAAA0E,GAAA1E,EAAA,IAAAyF,KAAAX,EAAAnG,EAAA,GAAA8G,EAAAzF,EAAA,KAAApB,EAAA,EAAA4G,EAAA/E,EAAA+C,EAAAgC,EAAAhC,EAAAxD,EAAA,IAAAyF,EAAAE,IAAAb,EAAAnG,EAAA,GAAAqB,EAAA,GAAAwD,GAAAA,EAAAmC,KAAA3F,EAAA,GAAArB,EAAAqB,EAAA,GAAAwD,EAAAgC,EAAAhC,EAAAmC,EAAA/G,EAAA,OAAAkG,GAAAnG,EAAA,SAAA0D,EAAA,MAAAkD,GAAA,EAAA/B,CAAA,iBAAAsB,EAAA9B,EAAA2C,GAAA,GAAAL,EAAA,QAAAM,UAAA,oCAAAL,GAAA,IAAAvC,GAAAyC,EAAAzC,EAAA2C,GAAA/G,EAAAoE,EAAAkC,EAAAS,GAAAhB,EAAA/F,EAAA,EAAA8F,EAAAQ,KAAAK,GAAA,CAAAvF,IAAApB,EAAAA,EAAA,GAAAA,EAAA,IAAA4G,EAAAhC,GAAA,GAAAiC,EAAA7G,EAAAsG,IAAAM,EAAAhC,EAAA0B,EAAAM,EAAA/E,EAAAyE,GAAA,OAAAI,EAAA,EAAAtF,EAAA,IAAApB,IAAAkG,EAAA,QAAAH,EAAA3E,EAAA8E,GAAA,MAAAH,EAAAA,EAAAkB,KAAA7F,EAAAkF,IAAA,MAAAU,UAAA,wCAAAjB,EAAAmB,KAAA,OAAAnB,EAAAO,EAAAP,EAAAoB,MAAAnH,EAAA,IAAAA,EAAA,YAAAA,IAAA+F,EAAA3E,EAAA,SAAA2E,EAAAkB,KAAA7F,GAAApB,EAAA,IAAAsG,EAAAU,UAAA,oCAAAd,EAAA,YAAAlG,EAAA,GAAAoB,EAAA0E,CAAA,UAAAC,GAAAY,EAAAC,EAAAhC,EAAA,GAAA0B,EAAAvG,EAAAkH,KAAArC,EAAAgC,MAAAnD,EAAA,YAAAsC,GAAA3E,EAAA0E,EAAA9F,EAAA,EAAAsG,EAAAP,CAAA,SAAAW,EAAA,UAAAS,MAAApB,EAAAmB,KAAAP,EAAA,GAAA5G,EAAAmG,EAAA9E,IAAA,GAAAkF,CAAA,KAAA7C,EAAA,YAAA4C,IAAA,UAAAe,IAAA,UAAAC,IAAA,CAAAtB,EAAAQ,OAAAe,eAAA,IAAAtH,EAAA,GAAA4E,GAAAmB,EAAAA,EAAA,GAAAnB,QAAA6B,EAAAV,EAAA,GAAAnB,EAAA,yBAAAmB,GAAAO,EAAAe,EAAAjB,UAAAC,EAAAD,UAAAG,OAAAC,OAAAxG,GAAA,SAAA0G,EAAAZ,GAAA,OAAAS,OAAAgB,eAAAhB,OAAAgB,eAAAzB,EAAAuB,IAAAvB,EAAA0B,UAAAH,EAAAZ,EAAAX,EAAAI,EAAA,sBAAAJ,EAAAM,UAAAG,OAAAC,OAAAF,GAAAR,CAAA,QAAAsB,EAAAhB,UAAAiB,EAAAZ,EAAAH,EAAA,cAAAe,GAAAZ,EAAAY,EAAA,cAAAD,GAAAA,EAAAK,YAAA,oBAAAhB,EAAAY,EAAAnB,EAAA,qBAAAO,EAAAH,GAAAG,EAAAH,EAAAJ,EAAA,aAAAO,EAAAH,EAAA1B,EAAA,yBAAA6B,EAAAH,EAAA,oDAAAoB,EAAA,kBAAAC,EAAAvG,EAAAwG,EAAAlB,EAAA,cAAAD,EAAAX,EAAA/F,EAAA6E,EAAAmB,GAAA,IAAA3E,EAAAmF,OAAAsB,eAAA,IAAAzG,EAAA,gBAAA0E,GAAA1E,EAAA,EAAAqF,EAAA,SAAAX,EAAA/F,EAAA6E,EAAAmB,GAAA,SAAAG,EAAAnG,EAAA6E,GAAA6B,EAAAX,EAAA/F,EAAA,SAAA+F,GAAA,YAAAgC,QAAA/H,EAAA6E,EAAAkB,EAAA,GAAA/F,EAAAqB,EAAAA,EAAA0E,EAAA/F,EAAA,CAAAoH,MAAAvC,EAAAmD,YAAAhC,EAAAiC,cAAAjC,EAAAkC,UAAAlC,IAAAD,EAAA/F,GAAA6E,GAAAsB,EAAA,UAAAA,EAAA,WAAAA,EAAA,cAAAO,EAAAX,EAAA/F,EAAA6E,EAAAmB,EAAA,UAAAmC,EAAAtD,EAAAmB,EAAAD,EAAA/F,EAAAmG,EAAAzC,EAAAzD,GAAA,QAAAoB,EAAAwD,EAAAnB,GAAAzD,GAAAsG,EAAAlF,EAAA+F,KAAA,OAAAvC,GAAA,YAAAkB,EAAAlB,EAAA,CAAAxD,EAAA8F,KAAAnB,EAAAO,GAAA6B,QAAAC,QAAA9B,GAAA+B,KAAAtI,EAAAmG,EAAA,UAAAoC,EAAA1D,GAAA,sBAAAmB,EAAA,KAAAD,EAAAyC,UAAA,WAAAJ,QAAA,SAAApI,EAAAmG,GAAA,IAAAzC,EAAAmB,EAAA4D,MAAAzC,EAAAD,GAAA,SAAA2C,EAAA7D,GAAAsD,EAAAzE,EAAA1D,EAAAmG,EAAAuC,EAAAC,EAAA,OAAA9D,EAAA,UAAA8D,EAAA9D,GAAAsD,EAAAzE,EAAA1D,EAAAmG,EAAAuC,EAAAC,EAAA,QAAA9D,EAAA,CAAA6D,OAAA,MCDAlJ,EAAoBoJ,EAAI,WACvB,GAA0B,iBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAOC,MAAQ,IAAIC,SAAS,cAAb,EAChB,CAAE,MAAOhD,GACR,GAAsB,iBAAXiD,OAAqB,OAAOA,MACxC,CACA,CAPuB,GHGxBA,OAAOC,SAAW,CACdC,cAAe,uFACfC,eAAgB,sEAChBC,YAAa,0EAGbC,kBAAmB,sFACnBC,aAAc,4EAGdC,OAAQ,8CACRC,aAAc,4FAGdC,cAAe,gEACfC,kBAAmB,oEAGnBC,MAAO,mEACPC,QAAS,uEACTC,UAAW,qEAGXC,WAAY,wEACZC,eAAgB,wEAChBC,kBAAmB,oEACnBC,iBAAkB,mEAClBC,iBAAkB,mEAElBC,YAAa,0EACbC,iBAAkB,oFAClBC,qBAAsB,qFExB1B,IAAMpB,EAAW,CACbM,OAAQ,8CACRL,cAAe,uFACfM,aAAc,4FACdL,eAAgB,sEAChBM,cAAe,gEACfC,kBAAmB,oEACnBN,YAAa,0EACbU,WAAY,wEACZC,eAAgB,wEAChBJ,MAAO,mEACPC,QAAS,uEACTC,UAAW,qEACXI,iBAAkB,mEAClBC,iBAAkB,mEAClBF,kBAAmB,oEACnBX,kBAAmB,sFACnBe,iBAAkB,oFAClBC,qBAAsB,oFACtBf,aAAc,4EACda,YAAa,2EAejB,SAAAG,IAFC,OAEDA,EAAA/B,EAAAZ,IAAAE,EAJA,SAAA0C,EAA+BC,GAAK,OAAA7C,IAAAC,EAAA,SAAA6C,GAAA,cAAAA,EAAA5F,GAAA,cAAA4F,EAAA5F,EAAA,EAC1B6F,EAAkB,YAAaF,GAAM,cAAAC,EAAA/G,EAAA,KAAA6G,EAAA,KAC9C9B,MAAA,KAAAD,UAAA,CAM4B,SAAAmC,IAE5B,OAF4BA,EAAApC,EAAAZ,IAAAE,EAA7B,SAAA+C,EAA8BJ,GAAK,OAAA7C,IAAAC,EAAA,SAAAiD,GAAA,cAAAA,EAAAhG,GAAA,cAAAgG,EAAAhG,EAAA,EACzB6F,EAAkB,WAAYF,GAAM,cAAAK,EAAAnH,EAAA,KAAAkH,EAAA,KAC7CnC,MAAA,KAAAD,UAAA,UAEckC,EAAiBI,EAAAC,GAAA,OAAAC,EAAAvC,MAAC,KAADD,UAAA,UAAAwC,IA0F/B,OA1F+BA,EAAAzC,EAAAZ,IAAAE,EAAhC,SAAAoD,EAAiCC,EAAQV,GAAK,IAAAhK,EAAAd,EAAAa,EAAAE,EAAA0K,EAAAC,EAAA1H,EAAA2H,EAAA,OAAA1D,IAAAC,EAAA,SAAA0D,GAAA,cAAAA,EAAAjH,EAAAiH,EAAAzG,GAAA,OAanB,OAbmByG,EAAAjH,EAAA,EAIhC7D,EAAU,CACZU,OAAO,EACPD,MAAM,EACNsK,MAAM,EACN5I,MAAM,EACNgD,aAAc,UAGdjG,EAAO,CAAC,EACRa,EAAa,GAAE+K,EAAAzG,EAAA,EAEb2G,MAAMC,IAAG,eAAAC,EAAAnD,EAAAZ,IAAAE,EAAC,SAAA8D,EAAOC,GAAO,IAAAC,EAAAC,EAAA3L,EAAA4L,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAzE,IAAAC,EAAA,SAAAyE,GAAA,cAAAA,EAAAxH,GAAA,OAEJ,OADhBgH,EAAWD,EAAQC,UAChBS,KAAK,QAAQD,EAAAxH,EAAA,EAChB+G,EAAQW,OAAM,OAC6B,GAAjD/L,EAAQmF,aAAekG,EAASzK,MAAQ,SAEzB,cAAX8J,EAAsB,CAAAmB,EAAAxH,EAAA,QAED,OADfiH,EAAQF,EAAQC,SAASW,oBACzBF,KAAK,UAAUD,EAAAxH,EAAA,EACf+G,EAAQW,OAAM,OAGuB,GAArCpM,EAAUV,EAAcqM,EAAMW,QACtB,CAAFJ,EAAAxH,EAAA,cAAQ,IAAI6H,MAAM,sBAAqB,OAEnDhN,EAAgB,UAAIS,EACpBI,EAAWH,KAAK,aAAaiM,EAAAxH,EAAA,eAGH,OADpBkH,EAASH,EAAQC,SAASc,YACzBL,KAAK,cAAcD,EAAAxH,EAAA,EACpB+G,EAAQW,OAAM,OAMlB,OAJIP,EAAcD,EAAOa,MAAMC,IAAI,SAAAC,GACjC,IAAMC,EAAMD,EAAME,2BAElB,OADAD,EAAIT,KAAK,oBACF,CAAElL,KAAM0L,EAAM1L,KAAM2L,IAAKA,EACpC,GAAEV,EAAAxH,EAAA,EACI+G,EAAQW,OAAM,OAAAN,EAAAgB,EAEHjB,GAAW,IAA5B,IAAAC,EAAA5G,MAAA6G,EAAAD,EAAApH,KAAAsC,QAASgF,EAAID,EAAA9E,OACC2F,IAAIG,cAAgBf,EAAKY,IAAII,SAAW,IACxChN,EAAUV,EAAc0M,EAAKY,IAAIN,WAEnC/M,EAAKyM,EAAK/K,MAAQjB,EAClBI,EAAWH,KAAK+L,EAAK/K,MAGhC,OAAAgM,GAAAnB,EAAAlG,EAAAqH,EAAA,SAAAnB,EAAAtF,GAAA,eAAA0F,EAAA3I,EAAA,KAAAiI,EAAA,IAER,gBAAA0B,GAAA,OAAA3B,EAAAjD,MAAA,KAAAD,UAAA,EAvCc,IAuCb,UAEwB,IAAtBjI,EAAWZ,OAAY,CAAA2L,EAAAzG,EAAA,cAAQ,IAAI6H,MAAM,kBAAiB,cAAApB,EAAAzG,EAAA,EAG3CyI,IAAkB,OAA/B7M,EAAI6K,EAAAxJ,EAINqJ,EADW,aAAXD,EACOxF,EAAqBhG,EAAMa,EAAYC,EAASC,GAEhDH,EAAaZ,EAAMa,EAAYC,EAASC,GAI7C2K,EAAMmC,IAAIC,gBAAgBrC,IAG1BzH,EAAI+J,SAASC,cAAc,MAC/BC,KAAOvC,EACT1H,EAAEkK,SAAW,aAAHjN,OAAgBH,EAAQmF,aAAY,KAAAhF,QAAI,IAAIG,MAAO+M,UAAS,SACtEJ,SAAShM,KAAKqM,YAAYpK,GAC1BA,EAAEqK,QACFN,SAAShM,KAAKuM,YAAYtK,GAI1B4H,EAAAzG,EAAA,eAAAyG,EAAAjH,EAAA,EAAAgH,EAAAC,EAAAxJ,EAGAmM,QAAQC,MAAK7C,GAEb,OAEkB,OAFlBC,EAAAjH,EAAA,EAEAmG,EAAM2D,YAAY7C,EAAA3E,EAAA,iBAAA2E,EAAA5H,EAAA,KAAAuH,EAAA,qBAEzBD,EAAAvC,MAAA,KAAAD,UAAA,UAEc8E,IAAgB,OAAAc,EAAA3F,MAAC,KAADD,UAAA,UAAA4F,IA6B9B,OA7B8BA,EAAA7F,EAAAZ,IAAAE,EAA/B,SAAAwG,IAAA,IAAAC,EAAAhC,EAAAiC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAjH,IAAAC,EAAA,SAAAiH,GAAA,cAAAA,EAAAhK,GAAA,OAkBK,OAjBKyJ,EAAOrF,EACPqD,EAAI,eAAAwC,EAAAvG,EAAAZ,IAAAE,EAAG,SAAAkH,EAAO3D,GAAG,IAAApL,EAAA,OAAA2H,IAAAC,EAAA,SAAAoH,GAAA,cAAAA,EAAA3K,EAAA2K,EAAAnK,GAAA,cAAAmK,EAAA3K,EAAA,EAAA2K,EAAAnK,EAAA,EAECoK,MAAM7D,GAAI,OAAnB,IAADpL,EAACgP,EAAAlN,GACAoN,GAAI,CAAFF,EAAAnK,EAAA,cAAQ,IAAI6H,MAAMtB,GAAI,cAAA4D,EAAAnK,EAAA,EAClB7E,EAAEmP,OAAM,cAAAH,EAAAtL,EAAA,EAAAsL,EAAAlN,GAAA,cAAAkN,EAAA3K,EAAA,EAAA2K,EAAAlN,EAAAkN,EAAAtL,EAAA,gBAAA/C,OAEAyK,EAAG,UAAA2D,EAAA,iBAE/B,gBARSK,GAAA,OAAAN,EAAArG,MAAA,KAAAD,UAAA,KAUJ+F,EAAU,CAAC,gBAAiB,iBAAkB,cAAe,oBAAqB,gBAClFC,EAAS,CACX,SAAU,eAAgB,gBAAiB,oBAC3C,QAAS,UAAW,YACpB,aAAc,iBAAkB,oBAAqB,mBAAoB,mBACzE,cAAe,mBAAoB,wBACtCK,EAAAhK,EAAA,EAE6BuD,QAAQiH,IAAI,CACtCjH,QAAQiH,IAAId,EAAQ1B,IAAI,SAAAyC,GAAC,OAAIhD,EAAKgC,EAAKgB,GAAG,IAC1ClH,QAAQiH,IAAIb,EAAO3B,IAAI,SAAAyC,GAAC,OAAIhD,EAAKgC,EAAKgB,GAAG,MAC3C,OAHkB,OAGlBb,EAAAI,EAAA/M,EAAA4M,EAAAa,EAAAd,EAAA,GAHKE,EAAMD,EAAA,GAAEE,EAAKF,EAAA,GAAAG,EAAAnL,EAAA,EAKb,CACH9C,IAAK+N,EAAO7I,KAAK,MACjBN,GAAIoJ,EAAM9I,KAAK,QAClB,EAAAuI,EAAA,IACJD,EAAA3F,MAAA,KAAAD,UAAA,CA7IDgH,OAAOC,QAAQ,WACX,GA8IJ,IAAM7G,EAKqB,oBAAT8G,KAAuBA,KAAyB,oBAAX1G,OAAyBA,YAA2B,IAAX2G,EAAAA,EAAyBA,EAAAA,OAAS7K,EAJlI8D,EAAEgH,gBA5IF,SAI8BC,GAAA,OAAAvF,EAAA7B,MAAC,KAADD,UAAA,EAyI9BI,EAAEkH,eAvID,SAM4BC,GAAA,OAAApF,EAAAlC,MAAC,KAADD,UAAA,C","sources":["webpack://datavista-excel-addin/webpack/bootstrap","webpack://datavista-excel-addin/./src/utils/data-utils.js","webpack://datavista-excel-addin/./src/taskpane/generators.js","webpack://datavista-excel-addin/./src/taskpane/workbook_generators.js","webpack://datavista-excel-addin/./src/commands/commands.js","webpack://datavista-excel-addin/webpack/runtime/global"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","\r\n/**\r\n * Trims empty rows and columns from a 2D array.\r\n * @param {any[][]} data \r\n * @returns {any[][] | null} Trimmed data or null if empty\r\n */\r\nexport function trimEmptyGrid(data) {\r\n    if (!data || data.length === 0) return null;\r\n\r\n    let minRow = data.length;\r\n    let maxRow = -1;\r\n    let minCol = data[0].length;\r\n    let maxCol = -1;\r\n\r\n    // 1. Find Bounds\r\n    for (let r = 0; r < data.length; r++) {\r\n        for (let c = 0; c < data[r].length; c++) {\r\n            const val = data[r][c];\r\n            if (val !== \"\" && val !== null && val !== undefined) {\r\n                if (r < minRow) minRow = r;\r\n                if (r > maxRow) maxRow = r;\r\n                if (c < minCol) minCol = c;\r\n                if (c > maxCol) maxCol = c;\r\n            }\r\n        }\r\n    }\r\n\r\n    // 2. Check if empty\r\n    if (maxRow === -1) return null;\r\n\r\n    // 3. Slice\r\n    const trimmed = [];\r\n    for (let r = minRow; r <= maxRow; r++) {\r\n        trimmed.push(data[r].slice(minCol, maxCol + 1));\r\n    }\r\n\r\n    return trimmed;\r\n}\r\n","/* global Blob, window */\r\n// generators.js\r\n\r\nwindow.LIB_URLS = {\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n\r\n    // SearchBuilder & DateTime\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n\r\n    // JS Dependencies\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n\r\n    // DataTables Core & BS5\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n\r\n    // Export Dependencies\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n\r\n    // Extensions\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\"\r\n};\r\n\r\n/**\r\n * Main Generator Function\r\n * @param {Object} data - { \"Sheet1\": [[header, val], [val, val]] }\r\n * @param {string[]} sheetNames\r\n * @param {Object} options - { stats: bool, info: bool, desc: bool, rich: bool, workbookName: string }\r\n * @param {Object} libs - { css: string, js: string }\r\n */\r\nexport function generateHTML(data, sheetNames, options, libs) {\r\n    const parts = [];\r\n    parts.push(`<!DOCTYPE html><html lang='en' data-bs-theme='light'>`);\r\n    parts.push(\"<head><meta charset='UTF-8'><title>DataVista Report</title>\");\r\n\r\n    // 1. CSS\r\n    parts.push(`<style>${libs.css || \"\"}</style>`);\r\n\r\n    // 2. Custom CSS\r\n    parts.push(`<style>\r\n        :root { --header-bg: #3c6ea9; --header-text: white; }\r\n        [data-bs-theme=\"dark\"] { --header-bg: #1f2937; }\r\n\r\n        html { scroll-behavior: smooth; }\r\n        body { background-color: var(--bs-body-bg); color: var(--bs-body-color); font-family: 'Segoe UI', sans-serif; zoom: 0.9; }\r\n        \r\n        .dv-header {\r\n            background-color: var(--header-bg); color: var(--header-text);\r\n            padding: 12px 2rem; display: flex; justify-content: space-between; align-items: center;\r\n            box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 1.5rem; gap: 2rem;\r\n        }\r\n        [data-bs-theme=\"dark\"] .dv-header { background-color: var(--header-bg-dark); }\r\n\r\n        .header-content { display: flex; flex-direction: column; }\r\n        .dv-brand { font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; gap: 8px; }\r\n        .dv-meta { font-size: 0.75rem; opacity: 0.7; margin-top: 2px; }\r\n        \r\n        /* Header Tabs */\r\n        .dv-header-tabs { \r\n            border: none; margin: 0; display: flex; gap: 4px; flex: 1; justify-content: center;\r\n        }\r\n        .dv-header-tabs .nav-link { \r\n            border: none; color: rgba(255,255,255,0.7); background: transparent;\r\n            padding: 8px 16px; font-weight: 500; border-radius: 20px;\r\n            transition: all 0.2s; font-size: 0.85rem;\r\n        }\r\n        .dv-header-tabs .nav-link:hover { \r\n            color: white; background: rgba(255,255,255,0.1);\r\n        }\r\n        .dv-header-tabs .nav-link.active { \r\n            color: white; background: rgba(255,255,255,0.2);\r\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n        }\r\n        \r\n        .theme-toggler { cursor: pointer; display: flex; align-items: center; gap: 6px; font-size: 0.8rem; border: 1px solid rgba(255,255,255,0.3); padding: 4px 10px; border-radius: 16px; transition: all 0.2s; }\r\n        .theme-toggler:hover { background-color: rgba(255,255,255,0.1); }\r\n\r\n        .dv-container { padding: 0 2rem 3rem 2rem; }\r\n        .dv-tab-content { padding-top: 0; }\r\n        .nav-link { \r\n            border: none; color: var(--bs-body-color); opacity: 0.6; padding: 10px 20px; font-weight: 500; border-radius: 30px !important; transition: all 0.2s; \r\n        }\r\n        .nav-link:hover { background: rgba(0,0,0,0.05); opacity: 1; }\r\n        .nav-link.active { background-color: var(--header-bg) !important; color: white !important; opacity: 1; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }\r\n\r\n        /* Card */\r\n        .dv-card { background: var(--bs-card-bg); border: 1px solid var(--bs-border-color); border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.02); margin-bottom: 2rem; }\r\n\r\n        /* Sheet Sections */\r\n        .dv-sheet-section { margin-bottom: 3rem; }\r\n\r\n        /* DataTable Overrides */\r\n        table.dataTable { border-collapse: collapse !important; border: 1px solid var(--bs-border-color) !important; font-size: 0.8rem; }\r\n        table.dataTable thead th { \r\n            border: 1px solid var(--bs-border-color) !important; \r\n            border-bottom: 2px solid var(--bs-border-color) !important; \r\n            font-weight: 600; \r\n            vertical-align: middle; \r\n            padding: 6px 8px !important;\r\n        table.dataTable tbody td { \r\n            vertical-align: middle; \r\n            padding: 4px 8px !important; \r\n            border: 1px solid var(--bs-border-color) !important;\r\n        table.dataTable tfoot th {\r\n            border: 1px solid var(--bs-border-color) !important;\r\n            padding: 6px 8px !important;\r\n            font-size: 0.8rem;\r\n        }\r\n        \r\n        /* Filter Inputs */\r\n        .filter-input { width: 100%; border: 1px solid var(--bs-border-color); background: var(--bs-body-bg); color: var(--bs-body-color); padding: 4px 8px; border-radius: 4px; font-size: 0.85rem; margin-top: 5px; }\r\n        \r\n        /* Pagination & Info Alignment */\r\n        .dataTables_info { padding-top: 0.85em !important; }\r\n        .dataTables_paginate { display: flex; justify-content: flex-end; }\r\n        \r\n        /* Stats Footer */\r\n        tfoot th { font-size: 0.9rem; background: var(--bs-tertiary-bg); }\r\n\r\n        /* RICH FORMATTING */\r\n        .dv-neg { color: #dc3545 !important; font-weight: 500; }\r\n        .dv-bar-cell { position: relative; z-index: 1; }\r\n        .dv-bar {\r\n            position: absolute; top: 2px; bottom: 2px; left: 0; \r\n            background: linear-gradient(90deg, rgba(60, 110, 169, 0.15), rgba(60, 110, 169, 0.05));\r\n            z-index: -1; border-radius: 0 4px 4px 0; transition: width 0.3s;\r\n        }\r\n        [data-bs-theme=\"dark\"] .dv-bar { background: linear-gradient(90deg, rgba(60, 110, 169, 0.4), rgba(60, 110, 169, 0.1)); }\r\n        \r\n        /* Modal Tweaks */\r\n        .modal-backdrop.show { opacity: 0; position: fixed; width: 100vw; height: 100vh; top: 0; left: 0; } /* Transparent backdrop */\r\n        .modal-content { box-shadow: none; border: 1px solid var(--bs-border-color); }\r\n    </style>`);\r\n\r\n    parts.push(\"</head><body>\");\r\n\r\n    // 3. Header with integrated tabs\r\n    const timestamp = new Date().toLocaleString();\r\n    const sheetName = sheetNames.length > 0 ? sheetNames[0] : \"Report\";\r\n    parts.push(`\r\n    <div class=\"dv-header\">\r\n        <div>\r\n            <div class=\"dv-brand\">\r\n                <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" viewBox=\"0 0 24 24\"><path d=\"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"/></svg>\r\n                DataVista <span style=\"opacity: 0.6; margin: 0 8px;\">|</span> ${sheetName}\r\n            </div>\r\n            <div class=\"dv-meta\">Generated: ${timestamp}</div>\r\n        </div>\r\n        <ul class=\"nav nav-tabs dv-header-tabs\" role=\"tablist\">\r\n            <li class=\"nav-item\"><a class=\"nav-link active\" data-bs-toggle=\"tab\" href=\"#page-data\">Data</a></li>\r\n            ${options.info ? '<li class=\"nav-item\"><a class=\"nav-link\" data-bs-toggle=\"tab\" href=\"#page-info\">Dataset Info</a></li>' : ''}\r\n            ${options.stats ? '<li class=\"nav-item\"><a class=\"nav-link\" data-bs-toggle=\"tab\" href=\"#page-stats\">Summary Statistics</a></li>' : ''}\r\n        </ul>\r\n        <div class=\"theme-toggler\" onclick=\"document.documentElement.setAttribute('data-bs-theme', document.documentElement.getAttribute('data-bs-theme')==='dark'?'light':'dark')\">\r\n            <svg width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\"><path d=\"M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z\"/></svg>\r\n            <span>Theme</span>\r\n        </div>\r\n    </div>\r\n    `);\r\n\r\n    parts.push(`<div class=\"container-fluid dv-container mt-3 mb-5\">`);\r\n\r\n    // Tab Content Container (tabs are now in header)\r\n    parts.push(`<div class=\"tab-content dv-tab-content\">`);\r\n\r\n    // DATA PAGE\r\n    parts.push(`<div id=\"page-data\" class=\"tab-pane fade show active\">`);\r\n\r\n    sheetNames.forEach((name, i) => {\r\n        const rows = data[name];\r\n        const hasHeader = rows.length > 0;\r\n        const header = hasHeader ? rows[0] : [];\r\n        const body = hasHeader ? rows.slice(1) : [];\r\n\r\n        // Analyze Columns (Type & Stats)\r\n        const colTypes = []; // 'num' or 'str'\r\n        const colMax = [];   // For data bars\r\n\r\n        for (let c = 0; c < header.length; c++) {\r\n            let max = 0;\r\n            let isNum = true;\r\n\r\n            for (let r = 0; r < body.length; r++) {\r\n                const v = Number(body[r][c]);\r\n                // If any cell is NOT a number (and not empty), mark as string\r\n                // Note: Number(\"\") === 0, so empty cells count as valid \"numeric\" placeholders.\r\n                // Depending on desired behavior for mostly-empty text columns, strict check is safer.\r\n                if (isNaN(v)) { isNum = false; break; }\r\n                if (Math.abs(v) > max) max = Math.abs(v);\r\n            }\r\n            colTypes[c] = isNum ? 'num' : 'str';\r\n            // Only store colMax if rich is on, or just store it generally (unused if !rich)\r\n            colMax[c] = (isNum && max > 0) ? max : 0;\r\n        }\r\n\r\n        parts.push(`<div class=\"dv-sheet-section\" id=\"data-section\">`);\r\n        parts.push(`<div class=\"dv-card\">`);\r\n\r\n        parts.push(`<table class=\"table table-hover display nowrap\" style=\"width:100%\">`);\r\n        parts.push(`<thead><tr>`);\r\n        header.forEach((h, cIdx) => {\r\n            const alignClass = colTypes[cIdx] === 'num' ? 'text-end' : 'text-start';\r\n            parts.push(`<th class=\"${alignClass}\">${h}</th>`);\r\n        });\r\n        parts.push(`</tr></thead>`);\r\n\r\n        parts.push(`<tbody>`);\r\n        body.forEach(row => {\r\n            parts.push(`<tr>`);\r\n            row.forEach((cell, cIdx) => {\r\n                let content = cell;\r\n                // Auto-align based on column type\r\n                let classes = colTypes[cIdx] === 'num' ? \"text-end\" : \"text-start\";\r\n                let addons = \"\";\r\n\r\n                // Rich Formatting Logic\r\n                if (options.rich) {\r\n                    const num = Number(cell);\r\n                    if (!isNaN(num)) {\r\n                        // Negative Red\r\n                        if (num < 0) classes += \" dv-neg\";\r\n\r\n                        // Data Bar\r\n                        if (colMax[cIdx] > 0) {\r\n                            classes += \" dv-bar-cell\";\r\n                            const pct = Math.min(100, (Math.abs(num) / colMax[cIdx]) * 100);\r\n                            addons = `<div class=\"dv-bar\" style=\"width:${pct}%\"></div>`;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                parts.push(`<td class=\"${classes}\">${content}${addons}</td>`);\r\n            });\r\n            parts.push(`</tr>`);\r\n        });\r\n        parts.push(`</tbody>`);\r\n\r\n        parts.push(`</table></div>`); // End Card\r\n\r\n        parts.push(`</div>`); // End Sheet Section\r\n    });\r\n\r\n    parts.push(`</div>`); // End Data Page\r\n\r\n    // INFO PAGE\r\n    if (options.info) {\r\n        parts.push(`<div id=\"page-info\" class=\"tab-pane fade\">`);\r\n        sheetNames.forEach((name, i) => {\r\n            const rows = data[name];\r\n            const header = rows.length > 0 ? rows[0] : [];\r\n            const body = rows.length > 0 ? rows.slice(1) : [];\r\n            parts.push(`<div class=\"dv-card\"><h5>Dataset Info: ${name}</h5>${generateInfo(header, body)}</div>`);\r\n        });\r\n        parts.push(`</div>`); // End Info Page\r\n    }\r\n\r\n    // STATS PAGE\r\n    if (options.stats) {\r\n        parts.push(`<div id=\"page-stats\" class=\"tab-pane fade\">`);\r\n        sheetNames.forEach((name, i) => {\r\n            const rows = data[name];\r\n            const header = rows.length > 0 ? rows[0] : [];\r\n            const body = rows.length > 0 ? rows.slice(1) : [];\r\n            parts.push(`<div class=\"dv-card\"><h5>Statistics: ${name}</h5>${generateDesc(header, body)}</div>`);\r\n        });\r\n        parts.push(`</div>`); // End Stats Page\r\n    }\r\n\r\n    parts.push(`</div>`); // End Tab Content\r\n    // Modals\r\n    parts.push(`\r\n    <div class=\"modal fade\" id=\"searchBuilderModal\" tabindex=\"-1\" aria-hidden=\"true\">\r\n        <div class=\"modal-dialog modal-xl\">\r\n            <div class=\"modal-content\" style=\"background-color: var(--bs-body-bg); color: var(--bs-body-color);\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">Advanced Filters</h5>\r\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                </div>\r\n                <div class=\"modal-body\" id=\"sb-modal-body\">\r\n                    <!-- SearchBuilder will be appended here -->\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    `);\r\n\r\n    parts.push(`</div>`); // End Main Container\r\n\r\n    // 5. Scripts: Injected Libs + Init Code\r\n    parts.push(`<script>${libs.js || \"\"}</script>`);\r\n\r\n    parts.push(`<script>\r\n    $(document).ready(function() {\r\n        $('table.display').each(function() {\r\n            var table = $(this);\r\n            \r\n            var dt = table.DataTable({\r\n                dom: '<\"row mb-3\"<\"col-md-6\"B><\"col-md-6\"f>>rt<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\r\n                initComplete: function () {\r\n                    var api = this.api();\r\n                    \r\n                    // 1. Move SearchBuilder to Modal\r\n                    // We manually create the SearchBuilder instance and append to modal\r\n                    var sb = new $.fn.dataTable.SearchBuilder(api, {});\r\n                    $('#sb-modal-body').append(sb.getNode());\r\n\r\n                    // 2. Add Filter Inputs to Header\r\n                    api.columns().eq(0).each(function (colIdx) {\r\n                        var header = $(api.column(colIdx).header());\r\n                        var title = header.text();\r\n                        var input = $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" />')\r\n                            .appendTo(header.empty())\r\n                            .on('keyup change', function () {\r\n                                api.column(colIdx).search(this.value).draw();\r\n                            });\r\n                        header.prepend('<div style=\"margin-bottom: 5px; font-weight: 600;\">' + title + '</div>');\r\n                    });\r\n                },\r\n                buttons: [\r\n                    {\r\n                        text: 'Advanced Filters',\r\n                        className: 'btn-info me-3', // Added margin-end for spacing\r\n                        action: function (e, dt, node, config) {\r\n                            $('#searchBuilderModal').modal('show');\r\n                        }\r\n                    },\r\n                    'copy', \r\n                    'csv', \r\n                    'excel', \r\n                    {\r\n                        extend: 'pdfHtml5',\r\n                        orientation: 'landscape',\r\n                        pageSize: 'A4',\r\n                        customize: function(doc) {\r\n                            // 1. Optimize Margins\r\n                            doc.pageMargins = [10, 10, 10, 10];\r\n                            \r\n                            // 2. robust column count\r\n                            var table = doc.content[1].table;\r\n                            var colCount = table.body[0].length;\r\n                            \r\n                            // 3. Dynamic Font Scaling (More granular)\r\n                            // Base 9, reduced by 0.2 for every column over 5, min 4\r\n                            var fontSize = 9;\r\n                            if(colCount > 5) {\r\n                                fontSize = Math.max(4, 9 - ((colCount - 5) * 0.3)); \r\n                            }\r\n                            \r\n                            doc.defaultStyle.fontSize = fontSize;\r\n                            doc.styles.tableHeader.fontSize = fontSize + 1;\r\n                            doc.styles.title.fontSize = 12;\r\n\r\n                            // 4. Force Fit Page Width (Star Widths)\r\n                            // Using Array.fill is cleaner/safer than join/split\r\n                            table.widths = new Array(colCount).fill('*');\r\n\r\n                            // 5. Right-align numbers & condensed margins\r\n                            var rowCount = table.body.length;\r\n                            for (var i = 1; i < rowCount; i++) {\r\n                                table.body[i].forEach(function(cell) {\r\n                                    if(!isNaN(Number(cell.text)) && cell.text !== \"\") {\r\n                                        cell.alignment = 'right';\r\n                                    }\r\n                                    cell.margin = [1, 2, 1, 2]; // Tighter cell padding\r\n                                });\r\n                            }\r\n                        }\r\n                    },\r\n                    'print', \r\n                    'colvis'\r\n                ],\r\n                pageLength: 15\r\n            });\r\n        });\r\n    });\r\n    </script>`);\r\n\r\n    parts.push(\"</body></html>\");\r\n    return new Blob(parts, { type: \"text/html\" });\r\n}\r\n\r\n// Helpers\r\nfunction calculateBasicStats(rows, colCount) {\r\n    // Calculates Count (all non-null), Sum, Mean (numeric only)\r\n    const sums = new Array(colCount).fill(0);\r\n    const numericCounts = new Array(colCount).fill(0);\r\n    const totalCounts = new Array(colCount).fill(0);\r\n    const isNum = new Array(colCount).fill(true);\r\n\r\n    rows.forEach(r => {\r\n        r.forEach((v, i) => {\r\n            // Count all non-null entries\r\n            if (v !== \"\" && v !== null && v !== undefined) {\r\n                totalCounts[i]++;\r\n            }\r\n\r\n            // Track numeric values for sum/average\r\n            const n = Number(v);\r\n            if (isNaN(n) || v === \"\") {\r\n                isNum[i] = false;\r\n            } else {\r\n                sums[i] += n;\r\n                numericCounts[i]++;\r\n            }\r\n        });\r\n    });\r\n\r\n    const format = (n) => n.toLocaleString(undefined, { maximumFractionDigits: 2 });\r\n\r\n    const res = [\r\n        { name: \"Count\", values: totalCounts.map(c => c) },  // All non-null entries\r\n        { name: \"Sum\", values: sums.map((s, i) => isNum[i] && numericCounts[i] > 0 ? format(s) : \"-\") },\r\n        { name: \"Average\", values: sums.map((s, i) => isNum[i] && numericCounts[i] > 0 ? format(s / numericCounts[i]) : \"-\") }\r\n    ];\r\n    return res;\r\n}\r\n\r\nfunction generateInfo(header, rows) {\r\n    let html = \"<table class='table table-sm'><thead><tr><th>Col</th><th>Type</th><th>Non-Null</th></tr></thead><tbody>\";\r\n    header.forEach((h, i) => {\r\n        let nn = 0, numeric = 0;\r\n        rows.forEach(r => {\r\n            if (r[i] !== \"\" && r[i] !== null) nn++;\r\n            if (!isNaN(Number(r[i]))) numeric++;\r\n        });\r\n        const type = (numeric === nn && nn > 0) ? \"Numeric\" : \"Object\";\r\n        html += `<tr><td>${h}</td><td>${type}</td><td>${nn}</td></tr>`;\r\n    });\r\n    return html + \"</tbody></table>\";\r\n}\r\n\r\nfunction generateDesc(header, rows) {\r\n    if (rows.length === 0) return \"<p class='small text-muted'>No data available.</p>\";\r\n\r\n    // Calculate statistics for numeric columns\r\n    const stats = [];\r\n    const statNames = ['count', 'mean', 'std', 'min', '25%', '50%', '75%', 'max'];\r\n\r\n    header.forEach((colName, colIdx) => {\r\n        // Count ALL non-null entries (text or numeric)\r\n        let totalCount = 0;\r\n        const numericValues = [];\r\n\r\n        rows.forEach(row => {\r\n            const cellValue = row[colIdx];\r\n            // Count non-null, non-empty entries\r\n            if (cellValue !== \"\" && cellValue !== null && cellValue !== undefined) {\r\n                totalCount++;\r\n            }\r\n\r\n            // Collect numeric values for other stats\r\n            const val = Number(cellValue);\r\n            if (!isNaN(val) && cellValue !== \"\") {\r\n                numericValues.push(val);\r\n            }\r\n        });\r\n\r\n        // If no numeric values, show count only\r\n        if (numericValues.length === 0) {\r\n            stats.push({ col: colName, count: totalCount, mean: '-', std: '-', min: '-', q25: '-', q50: '-', q75: '-', max: '-' });\r\n            return;\r\n        }\r\n\r\n        numericValues.sort((a, b) => a - b);\r\n        const count = numericValues.length;\r\n        const sum = numericValues.reduce((a, b) => a + b, 0);\r\n        const mean = sum / count;\r\n\r\n        // Standard deviation\r\n        const variance = numericValues.reduce((acc, val) => acc + Math.pow(val - mean, 2), 0) / count;\r\n        const std = Math.sqrt(variance);\r\n\r\n        // Percentiles\r\n        const percentile = (p) => {\r\n            const idx = (p / 100) * (count - 1);\r\n            const lower = Math.floor(idx);\r\n            const upper = Math.ceil(idx);\r\n            const weight = idx % 1;\r\n            return numericValues[lower] * (1 - weight) + numericValues[upper] * weight;\r\n        };\r\n\r\n        const fmt = (n) => n.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });\r\n\r\n        stats.push({\r\n            col: colName,\r\n            count: totalCount,  // Total non-null count (includes text)\r\n            mean: fmt(mean),\r\n            std: fmt(std),\r\n            min: fmt(numericValues[0]),\r\n            q25: fmt(percentile(25)),\r\n            q50: fmt(percentile(50)),\r\n            q75: fmt(percentile(75)),\r\n            max: fmt(numericValues[count - 1])\r\n        });\r\n    });\r\n\r\n    // Build HTML table\r\n    let html = \"<table class='table table-sm table-bordered'><thead><tr><th>Statistic</th>\";\r\n    stats.forEach(s => html += `<th>${s.col}</th>`);\r\n    html += \"</tr></thead><tbody>\";\r\n\r\n    statNames.forEach(statName => {\r\n        html += `<tr><th>${statName}</th>`;\r\n        stats.forEach(s => {\r\n            const val = s[statName === '25%' ? 'q25' : statName === '50%' ? 'q50' : statName === '75%' ? 'q75' : statName];\r\n            html += `<td>${val}</td>`;\r\n        });\r\n        html += \"</tr>\";\r\n    });\r\n\r\n    html += \"</tbody></table>\";\r\n    return html;\r\n}\r\n\r\n/**\r\n * Trims empty rows and columns from a 2D array.\r\n * @param {any[][]} data \r\n * @returns {any[][] | null} Trimmed data or null if empty\r\n */\r\nfunction trimEmptyGrid(data) {\r\n    if (!data || data.length === 0) return null;\r\n\r\n    let minRow = data.length;\r\n    let maxRow = -1;\r\n    let minCol = data[0].length;\r\n    let maxCol = -1;\r\n\r\n    // 1. Find Bounds\r\n    for (let r = 0; r < data.length; r++) {\r\n        for (let c = 0; c < data[r].length; c++) {\r\n            const val = data[r][c];\r\n            if (val !== \"\" && val !== null && val !== undefined) {\r\n                if (r < minRow) minRow = r;\r\n                if (r > maxRow) maxRow = r;\r\n                if (c < minCol) minCol = c;\r\n                if (c > maxCol) maxCol = c;\r\n            }\r\n        }\r\n    }\r\n\r\n    // 2. Check if empty\r\n    if (maxRow === -1) return null;\r\n\r\n    // 3. Slice\r\n    const trimmed = [];\r\n    for (let r = minRow; r <= maxRow; r++) {\r\n        trimmed.push(data[r].slice(minCol, maxCol + 1));\r\n    }\r\n\r\n    return trimmed;\r\n}\r\n\r\n// End of Module\r\n","/* global console */\r\n\r\n// Function to generate the HTML content for the Entire Workbook (Dashboard/Index Style)\r\nexport function generateWorkbookHTML(data, sheetNames, options, libs) {\r\n    const timestamp = new Date().toLocaleString();\r\n    const workbookName = options.workbookName || \"Workbook\";\r\n\r\n    // 1. CSS & Styles (Reusing core styles + New Dashboard Styles)\r\n    const styles = `\r\n    <style>\r\n        :root {\r\n            --bs-body-bg: #ffffff;\r\n            --bs-body-color: #212529;\r\n            --bs-primary: #0d6efd;\r\n            --bs-secondary: #6c757d;\r\n            --bs-light: #f8f9fa;\r\n            --bs-dark: #212529;\r\n            --bs-border-color: #dee2e6;\r\n            --dv-header-bg: #f8f9fa;\r\n            --dv-header-color: #333;\r\n        }\r\n        [data-bs-theme=\"dark\"] {\r\n            --bs-body-bg: #212529;\r\n            --bs-body-color: #f8f9fa;\r\n            --bs-border-color: #495057;\r\n            --dv-header-bg: #2c3034;\r\n            --dv-header-color: #fff;\r\n        }\r\n        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; font-size: 0.9rem; margin: 0; padding: 0; background-color: var(--bs-body-bg); color: var(--bs-body-color); zoom: 0.9; }\r\n        \r\n        /* Dashboard / Index Styles */\r\n        .dashboard-container { max-width: 1200px; margin: 50px auto; text-align: center; }\r\n        .dashboard-header { margin-bottom: 50px; }\r\n        .dashboard-title { font-size: 2.5rem; font-weight: 300; margin-bottom: 10px; }\r\n        .dashboard-meta { color: var(--bs-secondary); }\r\n        \r\n        .sheet-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px; }\r\n        .sheet-card {\r\n            background: var(--bs-body-bg);\r\n            border: 1px solid var(--bs-border-color);\r\n            border-radius: 8px;\r\n            padding: 30px;\r\n            cursor: pointer;\r\n            transition: transform 0.2s, box-shadow 0.2s;\r\n            text-decoration: none;\r\n            color: inherit;\r\n            display: flex;\r\n            flex-direction: column;\r\n            align-items: center;\r\n            justify-content: center;\r\n            height: 150px;\r\n            width: 280px;\r\n        }\r\n        .sheet-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); border-color: var(--bs-primary); }\r\n        .sheet-icon { width: 40px; height: 40px; margin-bottom: 15px; color: var(--bs-primary); }\r\n        .sheet-name { font-size: 1.2rem; font-weight: 500; }\r\n\r\n        /* Sheet View Styles (Initially Hidden) */\r\n        .view-section { display: none; padding-top: 20px; }\r\n        .view-section.active { display: block; }\r\n\r\n        /* Back Button Header */\r\n        .sheet-header {\r\n            display: flex; align-items: center; justify-content: space-between;\r\n            background: var(--dv-header-bg); color: var(--dv-header-color);\r\n            padding: 10px 20px;\r\n            border-bottom: 1px solid var(--bs-border-color);\r\n            margin-bottom: 20px;\r\n        }\r\n        .btn-back { display: flex; align-items: center; gap: 5px; cursor: pointer; font-weight: 600; text-decoration: none; color: inherit; }\r\n        .btn-back:hover { text-decoration: underline; }\r\n\r\n        /* Table Styles (Compact) */\r\n        table.dataTable { border-collapse: collapse !important; border: 1px solid var(--bs-border-color) !important; font-size: 0.8rem; width: 100% !important; }\r\n        table.dataTable thead th { border: 1px solid var(--bs-border-color); padding: 6px 8px; background: var(--bs-light); color: var(--bs-dark); }\r\n        [data-bs-theme=\"dark\"] table.dataTable thead th { background: #343a40; color: #fff; }\r\n        table.dataTable tbody td { border: 1px solid var(--bs-border-color); padding: 4px 8px; }\r\n\r\n        /* Modal Tweaks */\r\n        .modal-backdrop.show { opacity: 0 !important; position: fixed; width: 100vw; height: 100vh; top: 0; left: 0; }\r\n        .modal-content { box-shadow: none !important; border: 1px solid var(--bs-border-color); }\r\n    </style>\r\n    <style>${libs.css || \"\"}</style>\r\n    `;\r\n\r\n    const parts = [];\r\n    parts.push(`<!DOCTYPE html><html lang=\"en\" data-bs-theme=\"light\"><head><meta charset=\"UTF-8\"><title>${workbookName}</title>${styles}</head><body>`);\r\n\r\n    // --- 1. DASHBOARD OVERVIEW (HOME) ---\r\n    parts.push(`\r\n    <div id=\"dashboard-view\" class=\"view-section active\">\r\n        <div class=\"dashboard-container\">\r\n            <div class=\"dashboard-header\">\r\n                <div class=\"dv-brand\" style=\"display: flex; align-items: center; justify-content: center; margin-bottom: 20px; font-size: 1.5rem; font-weight: bold;\">\r\n                    <img src=\"https://Harry-0402.github.io/DataVista/assets/icon-32.png\" width=\"32\" height=\"32\" style=\"margin-right: 10px;\" alt=\"Logo\">\r\n                    DataVista Report\r\n                </div>\r\n                <h1 class=\"dashboard-title\">${workbookName}</h1>\r\n                <p class=\"dashboard-meta\">Generated on ${timestamp} &bull; ${sheetNames.length} Sheets</p>\r\n            </div>\r\n            \r\n            <div class=\"sheet-grid\">\r\n    `);\r\n\r\n    // Render Buttons for each Sheet\r\n    sheetNames.forEach((name, index) => {\r\n        parts.push(`\r\n        <div class=\"sheet-card\" onclick=\"showSheet('${index}')\">\r\n            <svg class=\"sheet-icon\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"></path></svg>\r\n            <div class=\"sheet-name\">${name}</div>\r\n        </div>\r\n        `);\r\n    });\r\n\r\n    parts.push(`    </div></div></div>`);\r\n    // End Dashboard View\r\n\r\n    // --- 2. INDIVIDUAL SHEET VIEWS ---\r\n    sheetNames.forEach((name, index) => {\r\n        const rows = data[name];\r\n        const header = rows.length > 0 ? rows[0] : [];\r\n        const body = rows.length > 0 ? rows.slice(1) : [];\r\n\r\n        parts.push(`\r\n        <div id=\"sheet-view-${index}\" class=\"view-section\">\r\n            <!-- Sheet Header -->\r\n            <div class=\"sheet-header\">\r\n                <a class=\"btn-back\" onclick=\"showDashboard()\">\r\n                    <svg width=\"20\" height=\"20\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" viewBox=\"0 0 24 24\"><path d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/></svg>\r\n                    Back to Dashboard\r\n                </a>\r\n                <div style=\"font-size: 1.2rem; font-weight: bold;\">${name}</div>\r\n                <div class=\"theme-toggler\" style=\"cursor: pointer;\" onclick=\"toggleTheme()\">\r\n                     <svg width=\"20\" height=\"20\" fill=\"currentColor\" viewBox=\"0 0 16 16\"><path d=\"M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z\"/></svg>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"container-fluid\">\r\n        `);\r\n\r\n        // TABLE\r\n        // We reuse the basic table generation but wrap it ensuring it has a unique ID if needed, \r\n        // though strictly they are in separate divs.\r\n        parts.push(`<table class=\"table table-striped table-hover display nowrap\" style=\"width:100%\">`);\r\n\r\n        // Thead\r\n        parts.push(`<thead><tr>`);\r\n        header.forEach(h => parts.push(`<th>${h || \"\"}</th>`));\r\n        parts.push(`</tr></thead>`);\r\n\r\n        // Tbody\r\n        parts.push(`<tbody>`);\r\n        body.forEach(r => {\r\n            parts.push(`<tr>`);\r\n            r.forEach(c => {\r\n                const val = (c === null || c === undefined) ? \"\" : c;\r\n                parts.push(`<td>${val}</td>`);\r\n            });\r\n            parts.push(`</tr>`);\r\n        });\r\n        parts.push(`</tbody>`);\r\n\r\n        parts.push(`</table>`);\r\n\r\n        parts.push(`</div></div>`); // End Container, End Sheet View\r\n    });\r\n\r\n    // --- 3. MODAL FOR ADVANCED FILTERS (Reusable) ---\r\n    parts.push(`\r\n    <div class=\"modal fade\" id=\"searchBuilderModal\" tabindex=\"-1\" aria-hidden=\"true\">\r\n        <div class=\"modal-dialog modal-xl\">\r\n            <div class=\"modal-content\" style=\"background-color: var(--bs-body-bg); color: var(--bs-body-color);\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\">Advanced Filters</h5>\r\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                </div>\r\n                <div class=\"modal-body\" id=\"sb-modal-body\"></div>\r\n                <div class=\"modal-footer\"><button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    `);\r\n\r\n    // --- 4. SCRIPTS ---\r\n    parts.push(`<script>${libs.js || \"\"}</script>`);\r\n    parts.push(`<script>\r\n    // Navigation Logic\r\n    function showDashboard() {\r\n        $('.view-section').removeClass('active');\r\n        $('#dashboard-view').addClass('active');\r\n        document.title = \"${workbookName}\";\r\n    }\r\n\r\n    function showSheet(index) {\r\n        $('.view-section').removeClass('active');\r\n        $('#sheet-view-' + index).addClass('active');\r\n        // We might want to trigger a redraw of DataTable if it was hidden\r\n        $.fn.dataTable.tables({ visible: true, api: true }).columns.adjust();\r\n    }\r\n\r\n    function toggleTheme() {\r\n        const html = document.documentElement;\r\n        const current = html.getAttribute('data-bs-theme');\r\n        html.setAttribute('data-bs-theme', current === 'dark' ? 'light' : 'dark');\r\n    }\r\n\r\n    $(document).ready(function() {\r\n        // Initialize ALL tables\r\n        $('table.display').each(function() {\r\n            var table = $(this);\r\n            var dt = table.DataTable({\r\n                dom: '<\"row mb-3\"<\"col-md-6\"B><\"col-md-6\"f>>rt<\"row mt-3\"<\"col-md-6\"i><\"col-md-6\"p>>',\r\n                pageLength: 15,\r\n                scrollX: true,\r\n                buttons: [\r\n                    {\r\n                         text: 'Advanced Filters',\r\n                         className: 'btn-info me-3',\r\n                         action: function (e, dt, node, config) {\r\n                             // Clear previous SB\r\n                             $('#sb-modal-body').empty();\r\n                             var sb = new $.fn.dataTable.SearchBuilder(dt, {}); // Create for current table\r\n                             $('#sb-modal-body').append(sb.getNode());\r\n                             $('#searchBuilderModal').modal('show');\r\n                         }\r\n                    },\r\n                    'copy', 'csv', 'excel',\r\n                    {\r\n                        extend: 'pdfHtml5',\r\n                        orientation: 'landscape',\r\n                        pageSize: 'A4',\r\n                        customize: function(doc) {\r\n                            // 1. Optimize Margins\r\n                            doc.pageMargins = [10, 10, 10, 10];\r\n                            \r\n                            // 2. robust column count\r\n                            var table = doc.content[1].table;\r\n                            var colCount = table.body[0].length;\r\n                            \r\n                            // 3. Dynamic Font Scaling (More granular)\r\n                            // Base 9, reduced by 0.2 for every column over 5, min 4\r\n                            var fontSize = 9;\r\n                            if(colCount > 5) {\r\n                                fontSize = Math.max(4, 9 - ((colCount - 5) * 0.3)); \r\n                            }\r\n                            \r\n                            doc.defaultStyle.fontSize = fontSize;\r\n                            doc.styles.tableHeader.fontSize = fontSize + 1;\r\n                            doc.styles.title.fontSize = 12;\r\n\r\n                            // 4. Force Fit Page Width\r\n                            table.widths = new Array(colCount).fill('*');\r\n\r\n                            // 5. Condensed margins & alignment\r\n                            var rowCount = table.body.length;\r\n                            for (var i = 1; i < rowCount; i++) {\r\n                                table.body[i].forEach(function(cell) {\r\n                                    if(!isNaN(Number(cell.text)) && cell.text !== \"\") {\r\n                                        cell.alignment = 'right';\r\n                                    }\r\n                                    cell.margin = [1, 2, 1, 2];\r\n                                });\r\n                            }\r\n                        }\r\n                    },\r\n                    'print', 'colvis'\r\n                ],\r\n                initComplete: function() {\r\n                    var api = this.api();\r\n                    api.columns().eq(0).each(function (colIdx) {\r\n                        var header = $(api.column(colIdx).header());\r\n                        var title = header.text();\r\n                        var input = $('<input type=\"text\" class=\"filter-input\" placeholder=\"Filter...\" style=\"width:100%; border:1px solid #ddd; border-radius:4px; padding:2px 4px; font-weight:normal;\" />')\r\n                            .appendTo(header.empty())\r\n                            .on('keyup change', function () { api.column(colIdx).search(this.value).draw(); });\r\n                        header.prepend('<div style=\"margin-bottom: 5px; font-weight: 600;\">' + title + '</div>');\r\n                    });\r\n                }\r\n            });\r\n        });\r\n    });\r\n    </script></body></html>`);\r\n\r\n    return new Blob([parts.join(\"\")], { type: \"text/html\" });\r\n}\r\n\r\n\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\nimport { trimEmptyGrid } from \"../utils/data-utils\";\r\nimport { generateHTML } from \"../taskpane/generators\";\r\nimport { generateWorkbookHTML } from \"../taskpane/workbook_generators\";\r\n\r\n// Define library URLs for offline bundling (Same as taskpane.js)\r\nconst LIB_URLS = {\r\n    jquery: \"https://code.jquery.com/jquery-3.7.0.min.js\",\r\n    bootstrap_css: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css\",\r\n    bootstrap_js: \"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js\",\r\n    datatables_css: \"https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css\",\r\n    datatables_js: \"https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js\",\r\n    datatables_bs5_js: \"https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js\",\r\n    buttons_css: \"https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css\",\r\n    buttons_js: \"https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js\",\r\n    buttons_bs5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js\",\r\n    jszip: \"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\",\r\n    pdfmake: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js\",\r\n    vfs_fonts: \"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js\",\r\n    buttons_html5_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js\",\r\n    buttons_print_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js\",\r\n    buttons_colvis_js: \"https://cdn.datatables.net/buttons/2.4.1/js/buttons.colVis.min.js\",\r\n    searchbuilder_css: \"https://cdn.datatables.net/searchbuilder/1.5.0/css/searchBuilder.bootstrap5.min.css\",\r\n    searchbuilder_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/dataTables.searchBuilder.min.js\",\r\n    searchbuilder_bs5_js: \"https://cdn.datatables.net/searchbuilder/1.5.0/js/searchBuilder.bootstrap5.min.js\",\r\n    dateTime_css: \"https://cdn.datatables.net/datetime/1.5.1/css/dataTables.dateTime.min.css\",\r\n    dateTime_js: \"https://cdn.datatables.net/datetime/1.5.1/js/dataTables.dateTime.min.js\"\r\n};\r\n\r\nOffice.onReady(() => {\r\n    // If needed, Office.js is ready to be called\r\n});\r\n\r\n/**\r\n * Exports the currently selected range.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportSelection(event) {\r\n    await runHeadlessExport(\"selection\", event);\r\n}\r\n\r\n/**\r\n * Exports the entire workbook.\r\n * @param event {Office.AddinCommands.Event}\r\n */\r\nasync function exportWorkbook(event) {\r\n    await runHeadlessExport(\"workbook\", event);\r\n}\r\n\r\nasync function runHeadlessExport(source, event) {\r\n    try {\r\n        // Show a \"working\" indicator (not really possible without UI, but we can prevent timeout)\r\n        // Default Options\r\n        const options = {\r\n            stats: true,\r\n            info: true,\r\n            desc: true,\r\n            rich: true,\r\n            workbookName: \"Report\"\r\n        };\r\n\r\n        let data = {};\r\n        let sheetNames = [];\r\n\r\n        await Excel.run(async (context) => {\r\n            const workbook = context.workbook;\r\n            workbook.load(\"name\");\r\n            await context.sync();\r\n            options.workbookName = workbook.name || \"Report\";\r\n\r\n            if (source === \"selection\") {\r\n                const range = context.workbook.getSelectedRange();\r\n                range.load(\"values\");\r\n                await context.sync();\r\n\r\n                // Trim empty\r\n                const trimmed = trimEmptyGrid(range.values);\r\n                if (!trimmed) throw new Error(\"Selection is empty\");\r\n\r\n                data[\"Selection\"] = trimmed;\r\n                sheetNames.push(\"Selection\");\r\n            } else {\r\n                const sheets = context.workbook.worksheets;\r\n                sheets.load(\"items/name\");\r\n                await context.sync();\r\n\r\n                const sheetRanges = sheets.items.map(sheet => {\r\n                    const rng = sheet.getUsedRangeOrNullObject();\r\n                    rng.load(\"values, rowCount\");\r\n                    return { name: sheet.name, rng: rng };\r\n                });\r\n                await context.sync();\r\n\r\n                for (let item of sheetRanges) {\r\n                    if (!item.rng.isNullObject && item.rng.rowCount > 0) {\r\n                        const trimmed = trimEmptyGrid(item.rng.values);\r\n                        if (trimmed) {\r\n                            data[item.name] = trimmed;\r\n                            sheetNames.push(item.name);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        if (sheetNames.length === 0) throw new Error(\"No data found.\");\r\n\r\n        // Fetch Libs\r\n        const libs = await fetchOfflineLibs();\r\n\r\n        let blob;\r\n        if (source === \"workbook\") {\r\n            blob = generateWorkbookHTML(data, sheetNames, options, libs); // From workbook_generators.js\r\n        } else {\r\n            blob = generateHTML(data, sheetNames, options, libs); // From generators.js\r\n        }\r\n\r\n        // Trigger Download\r\n        const url = URL.createObjectURL(blob);\r\n\r\n        // In FunctionFile, we have a hidden DOM. Creating an anchor usually works.\r\n        const a = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = `DataVista_${options.workbookName}_${new Date().getTime()}.html`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n\r\n        // Success Notification?\r\n        // Office.context.ui.displayDialogAsync is only for opening windows.\r\n        // We assume download started.\r\n\r\n    } catch (error) {\r\n        console.error(error);\r\n        // If error, show a dialog? Or just silent fail?\r\n        // Since we are headless, we can't show alerts easily unless we use displayDialogAsync\r\n    } finally {\r\n        event.completed();\r\n    }\r\n}\r\n\r\nasync function fetchOfflineLibs() {\r\n    const urls = LIB_URLS;\r\n    const load = async (url) => {\r\n        try {\r\n            const r = await fetch(url);\r\n            if (!r.ok) throw new Error(url);\r\n            return await r.text();\r\n        } catch (e) {\r\n            return `/* Failed: ${url} */`;\r\n        }\r\n    };\r\n\r\n    const cssKeys = ['bootstrap_css', 'datatables_css', 'buttons_css', 'searchbuilder_css', 'dateTime_css'];\r\n    const jsKeys = [\r\n        'jquery', 'bootstrap_js', 'datatables_js', 'datatables_bs5_js',\r\n        'jszip', 'pdfmake', 'vfs_fonts',\r\n        'buttons_js', 'buttons_bs5_js', 'buttons_colvis_js', 'buttons_html5_js', 'buttons_print_js',\r\n        'dateTime_js', 'searchbuilder_js', 'searchbuilder_bs5_js'\r\n    ];\r\n\r\n    const [cssArr, jsArr] = await Promise.all([\r\n        Promise.all(cssKeys.map(k => load(urls[k]))),\r\n        Promise.all(jsKeys.map(k => load(urls[k])))\r\n    ]);\r\n\r\n    return {\r\n        css: cssArr.join(\"\\n\"),\r\n        js: jsArr.join(\"\\n\")\r\n    };\r\n}\r\n\r\nconst g = getGlobal();\r\ng.exportSelection = exportSelection;\r\ng.exportWorkbook = exportWorkbook;\r\n\r\nfunction getGlobal() {\r\n    return typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : typeof global !== \"undefined\" ? global : undefined;\r\n}\r\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();"],"names":["__webpack_require__","trimEmptyGrid","data","length","minRow","maxRow","minCol","maxCol","r","c","val","trimmed","push","slice","generateHTML","sheetNames","options","libs","parts","concat","css","timestamp","Date","toLocaleString","sheetName","info","stats","forEach","name","i","rows","hasHeader","header","body","colTypes","colMax","max","isNum","v","Number","isNaN","Math","abs","h","cIdx","alignClass","row","cell","content","classes","addons","rich","num","pct","min","html","nn","numeric","type","generateInfo","colName","colIdx","totalCount","numericValues","cellValue","sort","a","b","count","mean","reduce","variance","acc","pow","std","sqrt","percentile","p","idx","lower","floor","upper","ceil","weight","fmt","n","undefined","minimumFractionDigits","maximumFractionDigits","col","q25","q50","q75","s","statName","generateDesc","js","Blob","generateWorkbookHTML","workbookName","styles","index","join","e","t","Symbol","iterator","o","toStringTag","prototype","Generator","u","Object","create","_regeneratorDefine2","f","y","G","d","bind","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","g","globalThis","this","Function","window","LIB_URLS","bootstrap_css","datatables_css","buttons_css","searchbuilder_css","dateTime_css","jquery","bootstrap_js","datatables_js","datatables_bs5_js","jszip","pdfmake","vfs_fonts","buttons_js","buttons_bs5_js","buttons_colvis_js","buttons_html5_js","buttons_print_js","dateTime_js","searchbuilder_js","searchbuilder_bs5_js","_exportSelection","_callee","event","_context","runHeadlessExport","_exportWorkbook","_callee2","_context2","_x3","_x4","_runHeadlessExport","_callee4","source","blob","url","_t","_context4","desc","Excel","run","_ref","_callee3","context","workbook","range","sheets","sheetRanges","_iterator","_step","item","_trimmed","_context3","load","sync","getSelectedRange","values","Error","worksheets","items","map","sheet","rng","getUsedRangeOrNullObject","_createForOfIteratorHelper","isNullObject","rowCount","err","_x5","fetchOfflineLibs","URL","createObjectURL","document","createElement","href","download","getTime","appendChild","click","removeChild","console","error","completed","_fetchOfflineLibs","_callee6","urls","cssKeys","jsKeys","_yield$Promise$all","_yield$Promise$all2","cssArr","jsArr","_context6","_ref2","_callee5","_context5","fetch","ok","text","_x6","all","k","_slicedToArray","Office","onReady","self","global","exportSelection","_x","exportWorkbook","_x2"],"ignoreList":[],"sourceRoot":""}